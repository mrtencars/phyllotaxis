(function(){
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(k,m,e){return k==a&&"q"==m&&e==c}}));return!0===c.q}catch(k){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,k){a!=Array.prototype&&a!=Object.prototype&&(a[c]=k.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};
$jscomp.polyfill=function(a,c,k,m){if(c){k=$jscomp.global;a=a.split(".");for(m=0;m<a.length-1;m++){var e=a[m];e in k||(k[e]={});k=k[e]}a=a[a.length-1];m=k[a];c=c(m);c!=m&&null!=c&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var c=Object.seal({}),e=Object.seal({}),n=new a([[c,2],[e,3]]);if(2!=n.get(c)||3!=n.get(e))return!1;n.delete(c);n.set(e,4);return!n.has(c)&&4==n.get(e)}catch(w){return!1}}function k(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function m(a){var c=Object[a];c&&(Object[a]=function(a){k(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;
var e="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var l=0,n=function(a){this.id_=(l+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};n.prototype.set=function(a,c){k(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=c;return this};n.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};n.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};n.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return n},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new a($jscomp.makeIterator([[c,"s"]]));if("s"!=e.get(c)||1!=e.size||e.get({x:4})||e.set({x:4},"t")!=e||2!=e.size)return!1;var n=e.entries(),l=n.next();if(l.done||l.value[0]!=c||"s"!=l.value[1])return!1;l=n.next();return l.done||4!=l.value[0].x||"t"!=l.value[1]||!n.next().done?!1:!0}catch(q){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=new WeakMap,m=function(a){this.data_={};this.head_=n();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};m.prototype.set=function(a,c){a=0===a?0:a;var n=e(this,a);n.list||(n.list=this.data_[n.id]=[]);n.entry?n.entry.value=c:(n.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:c},n.list.push(n.entry),this.head_.previous.next=n.entry,this.head_.previous=n.entry,this.size++);return this};m.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};m.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=n();this.size=0};m.prototype.has=function(a){return!!e(this,a).entry};
m.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};m.prototype.entries=function(){return l(this,function(a){return[a.key,a.value]})};m.prototype.keys=function(){return l(this,function(a){return a.key})};m.prototype.values=function(){return l(this,function(a){return a.value})};m.prototype.forEach=function(a,c){for(var e=this.entries(),n;!(n=e.next()).done;)n=n.value,a.call(c,n[1],n[0],this)};m.prototype[Symbol.iterator]=m.prototype.entries;var e=function(a,c){var e=c&&typeof c;"object"==
e||"function"==e?k.has(c)?e=k.get(c):(e=""+ ++v,k.set(c,e)):e="p_"+c;var n=a.data_[e];if(n&&$jscomp.owns(a.data_,e))for(a=0;a<n.length;a++){var l=n[a];if(c!==c&&l.key!==l.key||c===l.key)return{id:e,list:n,index:a,entry:l}}return{id:e,list:n,index:-1,entry:void 0}},l=function(a,c){var e=a.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=a.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:c(e)};e=null}return{done:!0,value:void 0}})},n=function(){var a={};return a.previous=
a.next=a.head=a},v=0;return m},"es6","es3");$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var k=0,m={next:function(){if(k<a.length){var e=k++;return{value:c(e,a[e]),done:!1}}m.next=function(){return{done:!0,value:void 0}};return m.next()}};m[Symbol.iterator]=function(){return m};return m};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Object.getOwnPropertySymbols",function(a){return a?a:function(){return[]}},"es6","es5");$jscomp.polyfill("Reflect.ownKeys",function(a){return a?a:function(a){var c=[],m=Object.getOwnPropertyNames(a);a=Object.getOwnPropertySymbols(a);for(var e=0;e<m.length;e++)("jscomp_symbol_"==m[e].substring(0,14)?a:c).push(m[e]);return c.concat(a)}},"es6","es5");
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,k){return k})}},"es8","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new a($jscomp.makeIterator([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var l=e.entries(),n=l.next();if(n.done||n.value[0]!=c||n.value[1]!=c)return!1;n=l.next();return n.done||n.value[0]==c||4!=n.value[0].x||n.value[1]!=n.value[0]?!1:l.next().done}catch(v){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)this.add(c.value)}this.size=this.map_.size};k.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};k.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};k.prototype.clear=
function(){this.map_.clear();this.size=0};k.prototype.has=function(a){return this.map_.has(a)};k.prototype.entries=function(){return this.map_.entries()};k.prototype.values=function(){return this.map_.values()};k.prototype.keys=k.prototype.values;k.prototype[Symbol.iterator]=k.prototype.values;k.prototype.forEach=function(a,c){var e=this;this.map_.forEach(function(n){return a.call(c,n,n,e)})};return k},"es6","es3");
var coerce={toList:function(a,c){c=void 0===c?null:c;return"list"!==a.ctype?(console.log("argument is not a list"),c):a.value},toHomog:function(a,c,k){c=void 0===c?[0,0,0,0]:c;k=void 0===k?3:k;a=coerce.toList(a);if(null===a)return c;c=a.map(coerce.toReal);c.length>k+1&&(console.log("Coordinate vector too long."),c=c.slice(0,k+1));for(;c.length<k;)c.push(0);c.length===k&&c.push(1);return c},toDirection:function(a,c){c=void 0===c?[0,0,0]:c;a=coerce.toList(a);if(null===a)return c;c=a.map(coerce.toReal);
3<c.length&&(console.log("Coordinate vector too long."),c=c.slice(0,3));for(;3>c.length;)c.push(0);return c},toDirectionPoint:function(a,c){c=void 0===c?[0,0,0,0]:c;a=coerce.toDirection(a,c);a!==c&&(a[3]=0);return a},toColor:function(a,c){c=void 0===c?[.5,.5,.5]:c;if("number"===a.ctype){var k=coerce.toInterval(0,1,a);if(!isNaN(k))return[k,k,k]}a=coerce.toList(a);return null===a?c:3!=a.length?(console.log("Not an RGB color vector"),c):a.map(function(a){return coerce.toInterval(0,1,a)})},toReal:function(a,
c){c=void 0===c?Number.NaN:c;if("number"!==a.ctype)return console.log("argument is not a number"),c;a=a.value;c=a.real;0!==a.imag&&console.log("complex number is not real");return c},toInt:function(a,c){c=void 0===c?Number.NaN:c;if("number"!==a.ctype)return console.log("argument is not a number"),c;c=a.value;a=c.real;c=c.imag;0!==c&&console.log("complex number is not real");c=Math.round(a);c!==a&&console.log("number is not an integer");return c},clamp:function(a,c,k){return k<a?a:k>c?c:k},toInterval:function(a,
c,k,m){m=void 0===m?Number.NaN:m;return coerce.clamp(a,c,coerce.toReal(k,m))},toString:function(a,c){c=void 0===c?null:c;if("string"===a.ctype)return a.value;console.log("argument is not a string");return c},toEnum:function(a,c,k){k=void 0===k?null:k;c=coerce.toString(c,k);if(c!==k&&-1!==a.indexOf(c))return c;console.log("argument is not one of "+a.join(", "));return k},toBool:function(a,c){if("boolean"===a.ctype)return a.value;console.log("argument is not boolean");return c}};function norm3(a){var c=a[0],k=a[1];a=a[2];return Math.sqrt(c*c+k*k+a*a)}function normalized3(a){var c=a[0],k=a[1];a=a[2];var m=1/Math.sqrt(c*c+k*k+a*a);return[m*c,m*k,m*a]}function dehom3(a){var c=1/a[3];return[c*a[0],c*a[1],c*a[2]]}function scale3(a,c){return[a*c[0],a*c[1],a*c[2]]}function transpose3(a){return[a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]]}function transpose4(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]}
function adj3(a){return[a[4]*a[8]-a[5]*a[7],a[2]*a[7]-a[1]*a[8],a[1]*a[5]-a[2]*a[4],a[5]*a[6]-a[3]*a[8],a[0]*a[8]-a[2]*a[6],a[2]*a[3]-a[0]*a[5],a[3]*a[7]-a[4]*a[6],a[1]*a[6]-a[0]*a[7],a[0]*a[4]-a[1]*a[3]]}function sub3(a,c){return[a[0]-c[0],a[1]-c[1],a[2]-c[2]]}function add3(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[2]]}function add4(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[2],a[3]+c[3]]}function cross3(a,c){return[a[1]*c[2]-a[2]*c[1],a[2]*c[0]-a[0]*c[2],a[0]*c[1]-a[1]*c[0]]}
function mul4mm(a,c){return[a[0]*c[0]+a[1]*c[4]+a[2]*c[8]+a[3]*c[12],a[0]*c[1]+a[1]*c[5]+a[2]*c[9]+a[3]*c[13],a[0]*c[2]+a[1]*c[6]+a[2]*c[10]+a[3]*c[14],a[0]*c[3]+a[1]*c[7]+a[2]*c[11]+a[3]*c[15],a[4]*c[0]+a[5]*c[4]+a[6]*c[8]+a[7]*c[12],a[4]*c[1]+a[5]*c[5]+a[6]*c[9]+a[7]*c[13],a[4]*c[2]+a[5]*c[6]+a[6]*c[10]+a[7]*c[14],a[4]*c[3]+a[5]*c[7]+a[6]*c[11]+a[7]*c[15],a[8]*c[0]+a[9]*c[4]+a[10]*c[8]+a[11]*c[12],a[8]*c[1]+a[9]*c[5]+a[10]*c[9]+a[11]*c[13],a[8]*c[2]+a[9]*c[6]+a[10]*c[10]+a[11]*c[14],a[8]*c[3]+a[9]*
c[7]+a[10]*c[11]+a[11]*c[15],a[12]*c[0]+a[13]*c[4]+a[14]*c[8]+a[15]*c[12],a[12]*c[1]+a[13]*c[5]+a[14]*c[9]+a[15]*c[13],a[12]*c[2]+a[13]*c[6]+a[14]*c[10]+a[15]*c[14],a[12]*c[3]+a[13]*c[7]+a[14]*c[11]+a[15]*c[15]]}function mul3mv(a,c){return[a[0]*c[0]+a[1]*c[1]+a[2]*c[2],a[3]*c[0]+a[4]*c[1]+a[5]*c[2],a[6]*c[0]+a[7]*c[1]+a[8]*c[2]]}
function mul4mv(a,c){return[a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3],a[4]*c[0]+a[5]*c[1]+a[6]*c[2]+a[7]*c[3],a[8]*c[0]+a[9]*c[1]+a[10]*c[2]+a[11]*c[3],a[12]*c[0]+a[13]*c[1]+a[14]*c[2]+a[15]*c[3]]}function transform4to3(a,c){var k=1/(a[12]*c[0]+a[13]*c[1]+a[14]*c[2]+a[15]*c[3]);return[(a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3])*k,(a[4]*c[0]+a[5]*c[1]+a[6]*c[2]+a[7]*c[3])*k,(a[8]*c[0]+a[9]*c[1]+a[10]*c[2]+a[11]*c[3])*k]}
function triangleNormal(a,c,k){a=dehom3(a);c=sub3(dehom3(c),a);k=sub3(dehom3(k),a);return normalized3(cross3(c,k))};function nestedArrayToCSList(a){return Array.isArray(a)?{ctype:"list",value:a.map(function(a){return nestedArrayToCSList(a)})}:{ctype:"number",value:{real:a,imag:0}}}
function convertObjectToCindyDict(a,c,k){if(a instanceof Object&&k.has(a))return k.get(a);if(Array.isArray(a)){var m=[];a.forEach(function(a){a=convertObjectToCindyDict(a,c,k);null!=a&&m.push(a)});return{ctype:"list",value:m}}if("string"===typeof a||a instanceof String)return{ctype:"string",value:a};if("number"===typeof a&&isFinite(a))return{ctype:"number",value:{real:a,imag:0}};if("boolean"===typeof a)return{ctype:"boolean",value:a};if(null===a||"undefined"===typeof a||"function"===typeof a)return null;
var e={},l=new Map(k);l.set(a,e);for(var n in a)if(!c.has(n)&&a.hasOwnProperty(n)){var v=convertObjectToCindyDict(a[n],c,l);e[n]=v}return{ctype:"JSON",value:e}};(function(a){"object"===typeof exports&&"undefined"!==typeof module?module.exports=a():"function"===typeof define&&define.amd?define([],a):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Leap=a()})(function(){return function(){function a(c,k,m){function e(n,u){if(!k[n]){if(!c[n]){var v="function"==typeof require&&require;if(!u&&v)return v(n,!0);if(l)return l(n,!0);u=Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u;}u=
k[n]={exports:{}};c[n][0].call(u.exports,function(a){return e(c[n][1][a]||a)},u,u.exports,a,c,k,m)}return k[n].exports}for(var l="function"==typeof require&&require,n=0;n<m.length;n++)e(m[n]);return e}return a}()({1:[function(a,c,k){function m(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0);this._maxListeners=this._maxListeners||void 0}function e(b,f,a,D){var d;if("function"!==typeof a)throw new TypeError('"listener" argument must be a function');
if(d=b._events){d.newListener&&(b.emit("newListener",f,a.listener?a.listener:a),d=b._events);var h=d[f]}else d=b._events=r(null),b._eventsCount=0;h?("function"===typeof h?h=d[f]=D?[a,h]:[h,a]:D?h.unshift(a):h.push(a),h.warned||(a=void 0===b._maxListeners?m.defaultMaxListeners:b._maxListeners)&&0<a&&h.length>a&&(h.warned=!0,a=Error("Possible EventEmitter memory leak detected. "+h.length+' "'+String(f)+'" listeners added. Use emitter.setMaxListeners() to increase limit.'),a.name="MaxListenersExceededWarning",
a.emitter=b,a.type=f,a.count=h.length,"object"===typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message))):(d[f]=a,++b._eventsCount);return b}function l(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],
arguments[1],arguments[2]);default:for(var b=Array(arguments.length),f=0;f<b.length;++f)b[f]=arguments[f];this.listener.apply(this.target,b)}}function n(b,f,a){b={fired:!1,wrapFn:void 0,target:b,type:f,listener:a};f=A.call(l,b);f.listener=a;return b.wrapFn=f}function v(b,f,a){b=b._events;if(!b)return[];f=b[f];if(!f)return[];if("function"===typeof f)return a?[f.listener||f]:[f];if(a)for(a=Array(f.length),b=0;b<a.length;++b)a[b]=f[b].listener||f[b];else a=B(f,f.length);return a}function u(b){var d=
this._events;if(d){b=d[b];if("function"===typeof b)return 1;if(b)return b.length}return 0}function B(b,f){for(var d=Array(f),h=0;h<f;++h)d[h]=b[h];return d}function w(b){var d=function(){};d.prototype=b;return new d}function p(b){var d=[],f;for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&d.push(f);return f}function q(b){var d=this;return function(){return d.apply(b,arguments)}}var r=Object.create||w,t=Object.keys||p,A=Function.prototype.bind||q;c.exports=m;m.EventEmitter=m;m.prototype._events=
void 0;m.prototype._maxListeners=void 0;var f=10;try{a={};Object.defineProperty&&Object.defineProperty(a,"x",{value:0});var b=0===a.x}catch(d){b=!1}b?Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(b){if("number"!==typeof b||0>b||b!==b)throw new TypeError('"defaultMaxListeners" must be a positive number');f=b}}):m.defaultMaxListeners=f;m.prototype.setMaxListeners=function(b){if("number"!==typeof b||0>b||isNaN(b))throw new TypeError('"n" argument must be a positive number');
this._maxListeners=b;return this};m.prototype.getMaxListeners=function(){return void 0===this._maxListeners?m.defaultMaxListeners:this._maxListeners};m.prototype.emit=function(b){var d,f,a;var c="error"===b;if(a=this._events)c=c&&null==a.error;else if(!c)return!1;if(c){1<arguments.length&&(d=arguments[1]);if(d instanceof Error)throw d;a=Error('Unhandled "error" event. ('+d+")");a.context=d;throw a;}d=a[b];if(!d)return!1;a="function"===typeof d;var e=arguments.length;switch(e){case 1:if(a)d.call(this);
else for(a=d.length,d=B(d,a),c=0;c<a;++c)d[c].call(this);break;case 2:c=arguments[1];if(a)d.call(this,c);else for(a=d.length,d=B(d,a),e=0;e<a;++e)d[e].call(this,c);break;case 3:c=arguments[1];e=arguments[2];if(a)d.call(this,c,e);else for(a=d.length,d=B(d,a),f=0;f<a;++f)d[f].call(this,c,e);break;case 4:c=arguments[1];e=arguments[2];f=arguments[3];if(a)d.call(this,c,e,f);else{a=d.length;d=B(d,a);for(var g=0;g<a;++g)d[g].call(this,c,e,f)}break;default:c=Array(e-1);for(f=1;f<e;f++)c[f-1]=arguments[f];
if(a)d.apply(this,c);else for(a=d.length,d=B(d,a),e=0;e<a;++e)d[e].apply(this,c)}return!0};m.prototype.addListener=function(b,f){return e(this,b,f,!1)};m.prototype.on=m.prototype.addListener;m.prototype.prependListener=function(b,f){return e(this,b,f,!0)};m.prototype.once=function(b,f){if("function"!==typeof f)throw new TypeError('"listener" argument must be a function');this.on(b,n(this,b,f));return this};m.prototype.prependOnceListener=function(b,f){if("function"!==typeof f)throw new TypeError('"listener" argument must be a function');
this.prependListener(b,n(this,b,f));return this};m.prototype.removeListener=function(b,f){var d;if("function"!==typeof f)throw new TypeError('"listener" argument must be a function');var h=this._events;if(!h)return this;var a=h[b];if(!a)return this;if(a===f||a.listener===f)0===--this._eventsCount?this._events=r(null):(delete h[b],h.removeListener&&this.emit("removeListener",b,a.listener||f));else if("function"!==typeof a){var c=-1;for(d=a.length-1;0<=d;d--)if(a[d]===f||a[d].listener===f){var g=a[d].listener;
c=d;break}if(0>c)return this;if(0===c)a.shift();else{d=c+1;for(var e=a.length;d<e;c+=1,d+=1)a[c]=a[d];a.pop()}1===a.length&&(h[b]=a[0]);h.removeListener&&this.emit("removeListener",b,g||f)}return this};m.prototype.removeAllListeners=function(b){var d=this._events;if(!d)return this;if(!d.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):d[b]&&(0===--this._eventsCount?this._events=r(null):delete d[b]),this;if(0===arguments.length){var f=t(d);for(d=0;d<f.length;++d){var a=
f[d];"removeListener"!==a&&this.removeAllListeners(a)}this.removeAllListeners("removeListener");this._events=r(null);this._eventsCount=0;return this}f=d[b];if("function"===typeof f)this.removeListener(b,f);else if(f)for(d=f.length-1;0<=d;d--)this.removeListener(b,f[d]);return this};m.prototype.listeners=function(b){return v(this,b,!0)};m.prototype.rawListeners=function(b){return v(this,b,!1)};m.listenerCount=function(b,f){return"function"===typeof b.listenerCount?b.listenerCount(f):u.call(b,f)};m.prototype.listenerCount=
u;m.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],2:[function(a,c,k){a("./pointable");k=a("gl-matrix");var m=k.vec3,e=k.mat3,l=k.mat4;a("underscore");a=c.exports=function(a,c){this.finger=a;this._matrix=this._center=null;this.type=c.type;this.prevJoint=c.prevJoint;this.nextJoint=c.nextJoint;this.width=c.width;a=Array(3);m.sub(a,c.nextJoint,c.prevJoint);this.length=m.length(a);this.basis=c.basis};a.prototype.left=function(){return this._left?this._left:
this._left=0>e.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))};a.prototype.matrix=function(){if(this._matrix)return this._matrix;var a=this.basis,c=this._matrix=l.create();c[0]=a[0][0];c[1]=a[0][1];c[2]=a[0][2];c[4]=a[1][0];c[5]=a[1][1];c[6]=a[1][2];c[8]=a[2][0];c[9]=a[2][1];c[10]=a[2][2];c[3]=this.center()[0];c[7]=this.center()[1];c[11]=this.center()[2];this.left()&&(c[0]*=-1,c[1]*=-1,c[2]*=-1);return this._matrix};a.prototype.lerp=function(a,c){m.lerp(a,this.prevJoint,this.nextJoint,
c)};a.prototype.center=function(){if(this._center)return this._center;var a=m.create();this.lerp(a,.5);return this._center=a};a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{"./pointable":16,"gl-matrix":22,underscore:25}],3:[function(a,c,k){a=c.exports=function(a){this.pos=0;this._buf=[];this.size=a};a.prototype.get=function(a){void 0==a&&(a=0);if(!(a>=this.size||a>=this._buf.length))return this._buf[(this.pos-a-1)%this.size]};a.prototype.push=
function(a){this._buf[this.pos%this.size]=a;return this.pos++}},{}],4:[function(a,c,k){var m=a("../protocol").chooseProtocol;k=a("events").EventEmitter;var e=a("underscore"),l=c.exports=function(a){this.opts=e.defaults(a||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:l.defaultProtocolVersion});this.host=this.opts.host;this.port=this.opts.port;this.scheme=this.opts.scheme;this.protocolVersionVerified=!1;this.optimizeHMD=
this.background=null;this.on("ready",function(){this.enableGestures(this.opts.enableGestures);this.setBackground(this.opts.background);this.setOptimizeHMD(this.opts.optimizeHMD);this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};l.defaultProtocolVersion=6;l.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"};l.prototype.getScheme=function(){return"ws:"};
l.prototype.getPort=function(){return 6437};l.prototype.setBackground=function(a){this.opts.background=a;this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))};l.prototype.setOptimizeHMD=function(a){this.opts.optimizeHMD=a;this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,
this.opts.optimizeHMD))};l.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))};l.prototype.enableGestures=function(a){this.gesturesEnabled=a?!0:!1;this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))};l.prototype.handleClose=function(a,c){this.connected&&(this.disconnect(),1001===a&&1<this.opts.requestProtocolVersion&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())};
l.prototype.startReconnection=function(){var a=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){a.reconnect()},500))};l.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)};l.prototype.disconnect=function(a){a||this.stopReconnection();if(this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),
!0};l.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())};l.prototype.handleData=function(a){a=JSON.parse(a);void 0===this.protocol?(a=this.protocol=m(a),this.protocolVersionVerified=!0,this.emit("ready")):a=this.protocol(a);this.emit(a.type,a)};l.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0};l.prototype.send=function(a){this.socket.send(a)};l.prototype.reportFocus=function(a){this.connected&&this.focusedState!==
a&&(this.focusedState=a,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))};e.extend(l.prototype,k.prototype)},{"../protocol":17,events:1,underscore:25}],5:[function(a,c,k){var m=c.exports=a("./base");a=a("underscore");c=c.exports=function(a){m.call(this,a);var c=this;this.on("ready",function(){c.startFocusLoop()});this.on("disconnect",function(){c.stopFocusLoop()})};a.extend(c.prototype,m.prototype);c.__proto__=
m;c.prototype.useSecure=function(){return"https:"===location.protocol};c.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"};c.prototype.getPort=function(){return this.useSecure()?6436:6437};c.prototype.setupSocket=function(){var a=this,c=new WebSocket(this.getUrl());c.onopen=function(){a.handleOpen()};c.onclose=function(c){a.handleClose(c.code,c.reason)};c.onmessage=function(c){a.handleData(c.data)};c.onerror=function(c){a.useSecure()&&"wss:"===a.scheme&&(a.scheme="ws:",a.port=6437,
a.disconnect(),a.connect())};return c};c.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var a=this,c=null;c="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0;void 0===a.windowVisible&&(a.windowVisible=void 0===c?!0:!1===document[c]);var n=window.addEventListener("focus",function(c){a.windowVisible=!0;u()}),m=window.addEventListener("blur",
function(c){a.windowVisible=!1;u()});this.on("disconnect",function(){window.removeEventListener("focus",n);window.removeEventListener("blur",m)});var u=function(){a.reportFocus((void 0===c?!0:!1===document[c])&&a.windowVisible)};u();this.focusDetectorTimer=setInterval(u,100)}};c.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":4,underscore:25}],6:[function(a,c,k){var m=a("ws"),e=a("./base");a=a("underscore");
c=c.exports=function(a){e.call(this,a);var c=this;this.on("ready",function(){c.reportFocus(!0)})};a.extend(c.prototype,e.prototype);c.__proto__=e;c.prototype.setupSocket=function(){var a=this,c=new m(this.getUrl());c.on("open",function(){a.handleOpen()});c.on("message",function(c){a.handleData(c)});c.on("close",function(c,e){a.handleClose(c,e)});c.on("error",function(){a.startReconnection()});return c}},{"./base":4,underscore:25,ws:23}],7:[function(a,c,k){(function(m){(function(){var e=a("./frame"),
l=a("./hand"),n=a("./pointable"),k=a("./finger"),u=a("./circular_buffer"),B=a("./pipeline"),w=a("events").EventEmitter,p=a("./gesture").gestureListener,q=a("./dialog"),r=a("underscore"),t=c.exports=function(c){var f=this;c=r.defaults(c||{},{inNode:"undefined"!==typeof m&&m.versions&&m.versions.node});this.inNode=c.inNode;c=r.defaults(c||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,
checkVersion:!0});this.animationFrameRequested=!1;this.onAnimationFrame=function(b){f.lastConnectionFrame.valid&&f.emit("animationFrame",f.lastConnectionFrame);f.emit("frameEnd",b);f.loopWhileDisconnected&&(!1!==f.connection.focusedState||f.connection.opts.background)?window.requestAnimationFrame(f.onAnimationFrame):f.animationFrameRequested=!1};this.suppressAnimationLoop=c.suppressAnimationLoop;this.loopWhileDisconnected=c.loopWhileDisconnected;this.frameEventName=c.frameEventName;this.useAllPlugins=
c.useAllPlugins;this.history=new u(200);this.lastConnectionFrame=this.lastValidFrame=this.lastFrame=e.Invalid;this.accumulatedGestures=[];this.checkVersion=c.checkVersion;this.connectionType=void 0===c.connectionType?this.inBrowser()?a("./connection/browser"):a("./connection/node"):c.connectionType;this.connection=new this.connectionType(c);this.streamingCount=0;this.devices={};this.plugins={};this._pluginPipelineSteps={};this._pluginExtendedMethods={};c.useAllPlugins&&this.useRegisteredPlugins();
this.setupFrameEvents(c);this.setupConnectionEvents();this.startAnimationLoop()};t.prototype.gesture=function(a,f){a=p(this,a);void 0!==f&&a.stop(f);return a};t.prototype.setBackground=function(a){this.connection.setBackground(a);return this};t.prototype.setOptimizeHMD=function(a){this.connection.setOptimizeHMD(a);return this};t.prototype.inBrowser=function(){return!this.inNode};t.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()};t.prototype.inBackgroundPage=
function(){return"undefined"!==typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window};t.prototype.connect=function(){this.connection.connect();return this};t.prototype.streaming=function(){return 0<this.streamingCount};t.prototype.connected=function(){return!!this.connection.connected};t.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))};
t.prototype.disconnect=function(){this.connection.disconnect();return this};t.prototype.frame=function(a){return this.history.get(a)||e.Invalid};t.prototype.loop=function(a){if(a)if("function"===typeof a)this.on(this.frameEventName,a);else this.setupFrameEvents(a);return this.connect()};t.prototype.addStep=function(a){this.pipeline||(this.pipeline=new B(this));this.pipeline.addStep(a)};t.prototype.processFrame=function(a){a.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(a.gestures));
this.lastConnectionFrame=a;this.startAnimationLoop();this.emit("deviceFrame",a)};t.prototype.processFinishedFrame=function(a){this.lastFrame=a;a.valid&&(this.lastValidFrame=a);a.controller=this;a.historyIdx=this.history.push(a);if(a.gestures){a.gestures=this.accumulatedGestures;this.accumulatedGestures=[];for(var f=0;f!=a.gestures.length;f++)this.emit("gesture",a.gestures[f],a)}this.pipeline&&(a=this.pipeline.run(a),a||(a=e.Invalid));this.emit("frame",a);this.emitHandEvents(a)};t.prototype.emitHandEvents=
function(a){for(var f=0;f<a.hands.length;f++)this.emit("hand",a.hands[f])};t.prototype.setupFrameEvents=function(a){if(a.frame)this.on("frame",a.frame);if(a.hand)this.on("hand",a.hand)};t.prototype.setupConnectionEvents=function(){var a=this;this.connection.on("frame",function(b){a.processFrame(b)});this.on(this.frameEventName,function(b){a.processFinishedFrame(b)});var f=function(){if(5>a.connection.opts.requestProtocolVersion&&0==a.streamingCount){a.streamingCount=1;var b={attached:!0,streaming:!0,
type:"unknown",id:"Lx00000000000"};a.devices[b.id]=b;a.emit("deviceAttached",b);a.emit("deviceStreaming",b);a.emit("streamingStarted",b);a.connection.removeListener("frame",f)}},b=function(){if(0<a.streamingCount){for(var b in a.devices)a.emit("deviceStopped",a.devices[b]),a.emit("deviceRemoved",a.devices[b]);a.emit("streamingStopped",a.devices[b]);a.streamingCount=0;for(b in a.devices)delete a.devices[b]}};this.connection.on("focus",function(){a.loopWhileDisconnected&&a.startAnimationLoop();a.emit("focus")});
this.connection.on("blur",function(){a.emit("blur")});this.connection.on("protocol",function(b){b.on("beforeFrameCreated",function(b){a.emit("beforeFrameCreated",b)});b.on("afterFrameCreated",function(b,d){a.emit("afterFrameCreated",b,d)});a.emit("protocol",b)});this.connection.on("ready",function(){a.checkVersion&&!a.inNode&&a.checkOutOfDate();a.emit("ready")});this.connection.on("connect",function(){a.emit("connect");a.connection.removeListener("frame",f);a.connection.on("frame",f)});this.connection.on("disconnect",
function(){a.emit("disconnect");b()});this.connection.on("deviceConnect",function(d){d.state?(a.emit("deviceConnected"),a.connection.removeListener("frame",f),a.connection.on("frame",f)):(a.emit("deviceDisconnected"),b())});this.connection.on("deviceEvent",function(b){b=b.state;var d=a.devices[b.id],f={},c;for(c in b)d&&d.hasOwnProperty(c)&&d[c]==b[c]||(f[c]=!0);a.devices[b.id]=b;f.attached&&a.emit(b.attached?"deviceAttached":"deviceRemoved",b);f.streaming&&(b.streaming?(a.streamingCount++,a.emit("deviceStreaming",
b),1==a.streamingCount&&a.emit("streamingStarted",b),f.attached||a.emit("deviceConnected")):f.attached&&b.attached||(a.streamingCount--,a.emit("deviceStopped",b),0==a.streamingCount&&a.emit("streamingStopped",b),a.emit("deviceDisconnected")))});this.on("newListener",function(b,f){"deviceConnected"!=b&&"deviceDisconnected"!=b||console.warn(b+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})};t.prototype.checkOutOfDate=function(){console.assert(this.connection&&
this.connection.protocol);var a=this.connection.protocol.serviceVersion,f=this.connection.protocol.version,b=this.connectionType.defaultProtocolVersion;return b>f?(console.warn("Your Protocol Version is v"+f+", this app was designed for v"+b),q.warnOutOfDate({sV:a,pV:f}),!0):!1};t._pluginFactories={};t.plugin=function(a,f){this._pluginFactories[a]&&console.warn('Plugin "'+a+'" already registered');return this._pluginFactories[a]=f};t.plugins=function(){return r.keys(this._pluginFactories)};t.prototype.use=
function(a,f){var b;var d="function"==typeof a?a:t._pluginFactories[a];if(!d)throw"Leap Plugin "+a+" not found.";f||(f={});if(this.plugins[a])return r.extend(this.plugins[a],f),this;this.plugins[a]=f;f=d.call(this,f);for(b in f)if(d=f[b],"function"===typeof d){var h=a,E=b;if(-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(E))this.on(E,d);else this.pipeline||(this.pipeline=new B(this)),this._pluginPipelineSteps[h]||(this._pluginPipelineSteps[h]=[]),this._pluginPipelineSteps[h].push(this.pipeline.addWrappedStep(E,
d))}else{h=a;E=b;this._pluginExtendedMethods[h]||(this._pluginExtendedMethods[h]=[]);switch(E){case "frame":E=e;break;case "hand":E=l;break;case "pointable":E=n;r.extend(k.prototype,d);r.extend(k.Invalid,d);break;case "finger":E=k;break;default:throw h+' specifies invalid object type "'+E+'" for prototypical extension';}r.extend(E.prototype,d);r.extend(E.Invalid,d);this._pluginExtendedMethods[h].push([E,d])}return this};t.prototype.stopUsing=function(a){var f=this._pluginPipelineSteps[a],b=this._pluginExtendedMethods[a],
d;if(this.plugins[a]){if(f)for(d=0;d<f.length;d++)this.pipeline.removeStep(f[d]);if(b)for(d=0;d<b.length;d++){f=b[d][0];var h=b[d][1];for(var E in h)delete f.prototype[E],delete f.Invalid[E]}delete this.plugins[a];return this}};t.prototype.useRegisteredPlugins=function(){for(var a in t._pluginFactories)this.use(a)};r.extend(t.prototype,w.prototype)}).call(this)}).call(this,a("_process"))},{"./circular_buffer":3,"./connection/browser":5,"./connection/node":6,"./dialog":8,"./finger":9,"./frame":10,
"./gesture":11,"./hand":12,"./pipeline":15,"./pointable":16,_process:24,events:1,underscore:25}],8:[function(a,c,k){(function(a){(function(){var e=c.exports=function(a,c){this.options=c||{};this.message=a;this.createElement()};e.prototype.createElement=function(){this.element=document.createElement("div");this.element.className="leapjs-dialog";this.element.style.position="fixed";this.element.style.top="8px";this.element.style.left=0;this.element.style.right=0;this.element.style.textAlign="center";
this.element.style.zIndex=1E3;var a=document.createElement("div");this.element.appendChild(a);a.style.className="leapjs-dialog";a.style.display="inline-block";a.style.margin="auto";a.style.padding="8px";a.style.color="#222";a.style.background="#eee";a.style.borderRadius="4px";a.style.border="1px solid #999";a.style.textAlign="left";a.style.cursor="pointer";a.style.whiteSpace="nowrap";a.style.transition="box-shadow 1s linear";a.innerHTML=this.message;this.options.onclick&&a.addEventListener("click",
this.options.onclick);this.options.onmouseover&&a.addEventListener("mouseover",this.options.onmouseover);this.options.onmouseout&&a.addEventListener("mouseout",this.options.onmouseout);this.options.onmousemove&&a.addEventListener("mousemove",this.options.onmousemove)};e.prototype.show=function(){document.body.appendChild(this.element);return this};e.prototype.hide=function(){document.body.removeChild(this.element);return this};e.warnOutOfDate=function(a){a||(a={});var c="http://developer.leapmotion.com?";
a.returnTo=window.location.href;for(var l in a)c+=l+"="+encodeURIComponent(a[l])+"&";var m=new e("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(a){"leapjs-decline-upgrade"!=
a.target.id&&(a=window.open(c,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1"),window.focus&&a.focus());m.hide();return!0},onmousemove:function(a){a.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow=
"none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444";document.getElementById("leapjs-decline-upgrade").style.boxShadow="none";document.getElementById("leapjs-accept-upgrade").style.color=
"#444";document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}});return m.show()};e.hasWarnedBones=!1;e.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof a&&a.versions&&a.versions.node||this.warnOutOfDate({reason:"bones"}))}}).call(this)}).call(this,a("_process"))},{_process:24}],9:[function(a,c,k){var m=a("./pointable"),e=a("./bone"),l=a("./dialog");a=a("underscore");c=c.exports=function(a){m.call(this,
a);this.dipPosition=a.dipPosition;this.pipPosition=a.pipPosition;this.mcpPosition=a.mcpPosition;this.carpPosition=a.carpPosition;this.extended=a.extended;this.type=a.type;this.finger=!0;this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition];a.bases?this.addBones(a):l.warnBones()};a.extend(c.prototype,m.prototype);c.prototype.addBones=function(a){this.metacarpal=new e(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,
basis:a.bases[0]});this.proximal=new e(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:a.bases[1]});this.medial=new e(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:a.bases[2]});this.distal=new e(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:a.btipPosition,basis:a.bases[3]});this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]};c.prototype.toString=function(){return"Finger [ id:"+
this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};c.Invalid={valid:!1}},{"./bone":2,"./dialog":8,"./pointable":16,underscore:25}],10:[function(a,c,k){var m=a("./hand"),e=a("./pointable"),l=a("./gesture").createGesture;k=a("gl-matrix");var n=k.mat3,v=k.vec3,u=a("./interaction_box"),B=a("./finger"),w=a("underscore");a=c.exports=function(a){this.valid=!0;this.id=a.id;this.timestamp=a.timestamp;this.hands=[];this.handsMap={};this.pointables=[];this.tools=[];this.fingers=
[];a.interactionBox&&(this.interactionBox=new u(a.interactionBox));this.gestures=[];this.pointablesMap={};this._translation=a.t;this._rotation=w.flatten(a.r);this._scaleFactor=a.s;this.data=a;this.type="frame";this.currentFrameRate=a.currentFrameRate;if(a.gestures)for(var c=0,e=a.gestures.length;c!=e;c++)this.gestures.push(l(a.gestures[c]));this.postprocessData(a)};a.prototype.postprocessData=function(a){a||(a=this.data);for(var c=0,n=a.hands.length;c!=n;c++){var l=new m(a.hands[c]);l.frame=this;
this.hands.push(l);this.handsMap[l.id]=l}a.pointables=w.sortBy(a.pointables,function(a){return a.id});c=0;for(n=a.pointables.length;c!=n;c++)l=a.pointables[c],l=l.dipPosition?new B(l):new e(l),l.frame=this,this.addPointable(l)};a.prototype.addPointable=function(a){this.pointables.push(a);this.pointablesMap[a.id]=a;(a.tool?this.tools:this.fingers).push(a);if(void 0!==a.handId&&this.handsMap.hasOwnProperty(a.handId)){var c=this.handsMap[a.handId];c.pointables.push(a);(a.tool?c.tools:c.fingers).push(a);
switch(a.type){case 0:c.thumb=a;break;case 1:c.indexFinger=a;break;case 2:c.middleFinger=a;break;case 3:c.ringFinger=a;break;case 4:c.pinky=a}}};a.prototype.tool=function(a){a=this.pointable(a);return a.tool?a:e.Invalid};a.prototype.pointable=function(a){return this.pointablesMap[a]||e.Invalid};a.prototype.finger=function(a){a=this.pointable(a);return a.tool?e.Invalid:a};a.prototype.hand=function(a){return this.handsMap[a]||m.Invalid};a.prototype.rotationAngle=function(a,c){if(!this.valid||!a.valid)return 0;
var e=this.rotationMatrix(a);e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==c&&(a=this.rotationAxis(a),e*=v.dot(a,v.normalize(v.create(),c)));return e};a.prototype.rotationAxis=function(a){return this.valid&&a.valid?v.normalize(v.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):v.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return n.create();var c=n.transpose(n.create(),this._rotation);return n.multiply(n.create(),
a._rotation,c)};a.prototype.scaleFactor=function(a){return this.valid&&a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){return this.valid&&a.valid?v.subtract(v.create(),this._translation,a._translation):v.create()};a.prototype.toString=function(){var a="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";this.gestures&&(a+=" | Gesture count:("+this.gestures.length+")");return a+
" ]"};a.prototype.dump=function(){var a="Frame Info:<br/>"+this.toString();a+="<br/><br/>Hands:<br/>";for(var c=0,e=this.hands.length;c!=e;c++)a+="  "+this.hands[c].toString()+"<br/>";a+="<br/><br/>Pointables:<br/>";c=0;for(e=this.pointables.length;c!=e;c++)a+="  "+this.pointables[c].toString()+"<br/>";if(this.gestures)for(a+="<br/><br/>Gestures:<br/>",c=0,e=this.gestures.length;c!=e;c++)a+="  "+this.gestures[c].toString()+"<br/>";return a=a+"<br/><br/>Raw JSON:<br/>"+JSON.stringify(this.data)};a.Invalid=
{valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return e.Invalid},finger:function(){return e.Invalid},hand:function(){return m.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return n.create()},rotationAxis:function(){return v.create()},scaleFactor:function(){return 1},translation:function(){return v.create()}}},{"./finger":9,"./gesture":11,"./hand":12,"./interaction_box":14,
"./pointable":16,"gl-matrix":22,underscore:25}],11:[function(a,c,k){var m=a("gl-matrix").vec3;c=a("events").EventEmitter;var e=a("underscore");k.createGesture=function(a){switch(a.type){case "circle":var c=new n(a);break;case "swipe":c=new v(a);break;case "screenTap":c=new u(a);break;case "keyTap":c=new B(a);break;default:throw"unknown gesture type";}c.id=a.id;c.handIds=a.handIds.slice();c.pointableIds=a.pointableIds.slice();c.duration=a.duration;c.state=a.state;c.type=a.type;return c};k.gestureListener=
function(a,c){var n={},m={};a.on("gesture",function(a,f){if(a.type==c){if(("start"==a.state||"stop"==a.state)&&void 0===m[a.id]){var b=new l(a,f);m[a.id]=b;e.each(n,function(d,f){b.on(f,d)})}m[a.id].update(a,f);"stop"==a.state&&delete m[a.id]}});var u={start:function(a){n.start=a;return u},stop:function(a){n.stop=a;return u},complete:function(a){n.stop=a;return u},update:function(a){n.update=a;return u}};return u};var l=k.Gesture=function(a,c){this.gestures=[a];this.frames=[c]};l.prototype.update=
function(a,c){this.lastGesture=a;this.lastFrame=c;this.gestures.push(a);this.frames.push(c);this.emit(a.state,this)};l.prototype.translation=function(){return m.subtract(m.create(),this.lastGesture.startPosition,this.lastGesture.position)};e.extend(l.prototype,c.prototype);var n=function(a){this.center=a.center;this.normal=a.normal;this.progress=a.progress;this.radius=a.radius};n.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var v=function(a){this.startPosition=a.startPosition;
this.position=a.position;this.direction=a.direction;this.speed=a.speed};v.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var u=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};u.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var B=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};B.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+
"]"}},{events:1,"gl-matrix":22,underscore:25}],12:[function(a,c,k){var m=a("./pointable"),e=a("./bone");k=a("gl-matrix");var l=k.mat3,n=k.vec3,v=a("underscore");a=c.exports=function(a){this.id=a.id;this.palmPosition=a.palmPosition;this.direction=a.direction;this.palmVelocity=a.palmVelocity;this.palmNormal=a.palmNormal;this.sphereCenter=a.sphereCenter;this.sphereRadius=a.sphereRadius;this.valid=!0;this.pointables=[];this.fingers=[];this.arm=a.armBasis?new e(this,{type:4,width:a.armWidth,prevJoint:a.elbow,
nextJoint:a.wrist,basis:a.armBasis}):null;this.tools=[];this._translation=a.t;this._rotation=v.flatten(a.r);this._scaleFactor=a.s;this.timeVisible=a.timeVisible;this.stabilizedPalmPosition=a.stabilizedPalmPosition;this.type=a.type;this.grabStrength=a.grabStrength;this.pinchStrength=a.pinchStrength;this.confidence=a.confidence};a.prototype.finger=function(a){return(a=this.frame.finger(a))&&a.handId==this.id?a:m.Invalid};a.prototype.rotationAngle=function(a,c){if(!this.valid||!a.valid||!a.hand(this.id).valid)return 0;
var e=this.rotationMatrix(a);e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==c&&(a=this.rotationAxis(a),e*=n.dot(a,n.normalize(n.create(),c)));return e};a.prototype.rotationAxis=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?n.normalize(n.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):n.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return l.create();a=a.hand(this.id);
if(!a.valid)return l.create();var c=l.transpose(l.create(),this._rotation);return l.multiply(l.create(),a._rotation,c)};a.prototype.scaleFactor=function(a){if(!this.valid||!a.valid)return 1;a=a.hand(this.id);return a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?[this._translation[0]-a._translation[0],this._translation[1]-a._translation[1],this._translation[2]-a._translation[2]]:n.create()};
a.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "};a.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])};a.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])};a.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])};a.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return m.Invalid},
finger:function(){return m.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return l.create()},rotationAxis:function(){return n.create()},scaleFactor:function(){return 1},translation:function(){return n.create()}}},{"./bone":2,"./pointable":16,"gl-matrix":22,underscore:25}],13:[function(a,c,k){c.exports={Controller:a("./controller"),Frame:a("./frame"),Gesture:a("./gesture"),Hand:a("./hand"),Pointable:a("./pointable"),
Finger:a("./finger"),InteractionBox:a("./interaction_box"),CircularBuffer:a("./circular_buffer"),UI:a("./ui"),JSONProtocol:a("./protocol").JSONProtocol,glMatrix:a("gl-matrix"),mat3:a("gl-matrix").mat3,vec3:a("gl-matrix").vec3,loopController:void 0,version:a("./version.js"),_:a("underscore"),EventEmitter:a("events").EventEmitter,loop:function(a,c){a&&void 0===c&&"[object Function]"==={}.toString.call(a)&&(c=a,a={});this.loopController?a&&this.loopController.setupFrameEvents(a):this.loopController=
new this.Controller(a);this.loopController.loop(c);return this.loopController},plugin:function(a,c){this.Controller.plugin(a,c)}}},{"./circular_buffer":3,"./controller":7,"./finger":9,"./frame":10,"./gesture":11,"./hand":12,"./interaction_box":14,"./pointable":16,"./protocol":17,"./ui":18,"./version.js":21,events:1,"gl-matrix":22,underscore:25}],14:[function(a,c,k){var m=a("gl-matrix").vec3;a=c.exports=function(a){this.valid=!0;this.center=a.center;this.size=a.size;this.width=a.size[0];this.height=
a.size[1];this.depth=a.size[2]};a.prototype.denormalizePoint=function(a){return m.fromValues((a[0]-.5)*this.size[0]+this.center[0],(a[1]-.5)*this.size[1]+this.center[1],(a[2]-.5)*this.size[2]+this.center[2])};a.prototype.normalizePoint=function(a,c){a=m.fromValues((a[0]-this.center[0])/this.size[0]+.5,(a[1]-this.center[1])/this.size[1]+.5,(a[2]-this.center[2])/this.size[2]+.5);c&&(a[0]=Math.min(Math.max(a[0],0),1),a[1]=Math.min(Math.max(a[1],0),1),a[2]=Math.min(Math.max(a[2],0),1));return a};a.prototype.toString=
function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"};a.Invalid={valid:!1}},{"gl-matrix":22}],15:[function(a,c,k){a=c.exports=function(a){this.steps=[];this.controller=a};a.prototype.addStep=function(a){this.steps.push(a)};a.prototype.run=function(a){for(var c=this.steps.length,l=0;l!=c&&a;l++)a=this.steps[l](a);return a};a.prototype.removeStep=function(a){a=this.steps.indexOf(a);if(-1===a)throw"Step not found in pipeline";this.steps.splice(a,
1)};a.prototype.addWrappedStep=function(a,c){var e=this.controller,n=function(n){var l;var m="frame"==a?[n]:n[a+"s"]||[];var k=0;for(l=m.length;k<l;k++)c.call(e,m[k]);return n};this.addStep(n);return n}},{}],16:[function(a,c,k){a("gl-matrix");a=c.exports=function(a){this.valid=!0;this.id=a.id;this.handId=a.handId;this.length=a.length;this.tool=a.tool;this.width=a.width;this.direction=a.direction;this.stabilizedTipPosition=a.stabilizedTipPosition;this.tipPosition=a.tipPosition;this.tipVelocity=a.tipVelocity;
this.touchZone=a.touchZone;this.touchDistance=a.touchDistance;this.timeVisible=a.timeVisible};a.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};a.prototype.hand=function(){return this.frame.hand(this.handId)};a.Invalid={valid:!1}},{"gl-matrix":22}],17:[function(a,c,k){var m=a("./frame");a("./hand");a("./pointable");a("./finger");var e=a("underscore"),l=a("events").EventEmitter,n=function(a){this.type=a.type;
this.state=a.state};k.chooseProtocol=function(a){switch(a.version){case 1:case 2:case 3:case 4:case 5:case 6:var c=v(a);c.sendBackground=function(a,e){a.send(c.encode({background:e}))};c.sendFocused=function(a,e){a.send(c.encode({focused:e}))};c.sendOptimizeHMD=function(a,e){a.send(c.encode({optimizeHMD:e}))};break;default:throw"unrecognized version";}return c};var v=k.JSONProtocol=function(a){var c=function(a){if(a.event)return new n(a.event);c.emit("beforeFrameCreated",a);var e=new m(a);c.emit("afterFrameCreated",
e,a);return e};c.encode=function(a){return JSON.stringify(a)};c.version=a.version;c.serviceVersion=a.serviceVersion;c.versionLong="Version "+a.version;c.type="protocol";e.extend(c,l.prototype);return c}},{"./finger":9,"./frame":10,"./hand":12,"./pointable":16,events:1,underscore:25}],18:[function(a,c,k){k.UI={Region:a("./ui/region"),Cursor:a("./ui/cursor")}},{"./ui/cursor":19,"./ui/region":20}],19:[function(a,c,k){c.exports=function(){return function(a){var c=a.pointables.sort(function(a,c){return a.z-
c.z})[0];c&&c.valid&&(a.cursorPosition=c.tipPosition);return a}}},{}],20:[function(a,c,k){k=a("events").EventEmitter;a=a("underscore");var m=c.exports=function(a,c){this.start=new Vector(a);this.end=new Vector(c);this.enteredFrame=null};m.prototype.hasPointables=function(a){for(var c=0;c!=a.pointables.length;c++){var e=a.pointables[c].tipPosition;if(e.x>=this.start.x&&e.x<=this.end.x&&e.y>=this.start.y&&e.y<=this.end.y&&e.z>=this.start.z&&e.z<=this.end.z)return!0}return!1};m.prototype.listener=function(a){var c=
this;a&&a.nearThreshold&&this.setupNearRegion(a.nearThreshold);return function(a){return c.updatePosition(a)}};m.prototype.clipper=function(){var a=this;return function(c){a.updatePosition(c);return a.enteredFrame?c:null}};m.prototype.setupNearRegion=function(a){a=this.nearRegion=new m([this.start.x-a,this.start.y-a,this.start.z-a],[this.end.x+a,this.end.y+a,this.end.z+a]);var c=this;a.on("enter",function(a){c.emit("near",a)});a.on("exit",function(a){c.emit("far",a)});c.on("exit",function(a){c.emit("near",
a)})};m.prototype.updatePosition=function(a){this.nearRegion&&this.nearRegion.updatePosition(a);this.hasPointables(a)&&null==this.enteredFrame?(this.enteredFrame=a,this.emit("enter",this.enteredFrame)):this.hasPointables(a)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame));return a};m.prototype.normalize=function(a){return new Vector([(a.x-this.start.x)/(this.end.x-this.start.x),(a.y-this.start.y)/(this.end.y-this.start.y),(a.z-this.start.z)/(this.end.z-this.start.z)])};
m.prototype.mapToXY=function(a,c,n){a=this.normalize(a);var e=a.x,l=a.y;1<e?e=1:-1>e&&(e=-1);1<l?l=1:-1>l&&(l=-1);return[(e+1)/2*c,(1-l)/2*n,a.z]};a.extend(m.prototype,k.prototype)},{events:1,underscore:25}],21:[function(a,c,k){c.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],22:[function(a,c,k){(function(a){(function(a){if(!c)var c=1E-6;if(!e)var e="undefined"!==typeof Float32Array?Float32Array:Array;if(!m)var m=Math.random;var k={setMatrixArrayType:function(a){e=a}};"undefined"!==typeof a&&(a.glMatrix=
k);var B=Math.PI/180;k.toRadian=function(a){return a*B};var w={create:function(){var a=new e(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new e(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var d=new e(2);d[0]=a;d[1]=b;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,d){a[0]=b;a[1]=d;return a},add:function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];return a},subtract:function(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];return a}};w.sub=w.subtract;w.multiply=function(a,
b,d){a[0]=b[0]*d[0];a[1]=b[1]*d[1];return a};w.mul=w.multiply;w.divide=function(a,b,d){a[0]=b[0]/d[0];a[1]=b[1]/d[1];return a};w.div=w.divide;w.min=function(a,b,d){a[0]=Math.min(b[0],d[0]);a[1]=Math.min(b[1],d[1]);return a};w.max=function(a,b,d){a[0]=Math.max(b[0],d[0]);a[1]=Math.max(b[1],d[1]);return a};w.scale=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;return a};w.scaleAndAdd=function(a,b,d,h){a[0]=b[0]+d[0]*h;a[1]=b[1]+d[1]*h;return a};w.distance=function(a,b){var d=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(d*
d+a*a)};w.dist=w.distance;w.squaredDistance=function(a,b){var d=b[0]-a[0];a=b[1]-a[1];return d*d+a*a};w.sqrDist=w.squaredDistance;w.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};w.len=w.length;w.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};w.sqrLen=w.squaredLength;w.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};w.normalize=function(a,b){var d=b[0],f=b[1];d=d*d+f*f;0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d);return a};w.dot=function(a,b){return a[0]*b[0]+
a[1]*b[1]};w.cross=function(a,b,d){b=b[0]*d[1]-b[1]*d[0];a[0]=a[1]=0;a[2]=b;return a};w.lerp=function(a,b,d,h){var f=b[0];b=b[1];a[0]=f+h*(d[0]-f);a[1]=b+h*(d[1]-b);return a};w.random=function(a,b){b=b||1;var d=2*m()*Math.PI;a[0]=Math.cos(d)*b;a[1]=Math.sin(d)*b;return a};w.transformMat2=function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[2]*b;a[1]=d[1]*f+d[3]*b;return a};w.transformMat2d=function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[2]*b+d[4];a[1]=d[1]*f+d[3]*b+d[5];return a};w.transformMat3=function(a,
b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[3]*b+d[6];a[1]=d[1]*f+d[4]*b+d[7];return a};w.transformMat4=function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[4]*b+d[12];a[1]=d[1]*f+d[5]*b+d[13];return a};w.forEach=function(){var a=w.create();return function(b,d,f,E,c,L){d||(d=2);f||(f=0);for(E=E?Math.min(E*d+f,b.length):b.length;f<E;f+=d)a[0]=b[f],a[1]=b[f+1],c(a,a,L),b[f]=a[0],b[f+1]=a[1];return b}}();w.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!==typeof a&&(a.vec2=w);var p={create:function(){var a=
new e(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new e(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,d){var f=new e(3);f[0]=a;f[1]=b;f[2]=d;return f},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,d,h){a[0]=b;a[1]=d;a[2]=h;return a},add:function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];return a},subtract:function(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];return a}};p.sub=p.subtract;p.multiply=function(a,b,d){a[0]=
b[0]*d[0];a[1]=b[1]*d[1];a[2]=b[2]*d[2];return a};p.mul=p.multiply;p.divide=function(a,b,d){a[0]=b[0]/d[0];a[1]=b[1]/d[1];a[2]=b[2]/d[2];return a};p.div=p.divide;p.min=function(a,b,d){a[0]=Math.min(b[0],d[0]);a[1]=Math.min(b[1],d[1]);a[2]=Math.min(b[2],d[2]);return a};p.max=function(a,b,d){a[0]=Math.max(b[0],d[0]);a[1]=Math.max(b[1],d[1]);a[2]=Math.max(b[2],d[2]);return a};p.scale=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;return a};p.scaleAndAdd=function(a,b,d,h){a[0]=b[0]+d[0]*h;a[1]=b[1]+
d[1]*h;a[2]=b[2]+d[2]*h;return a};p.distance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(d*d+f*f+a*a)};p.dist=p.distance;p.squaredDistance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return d*d+f*f+a*a};p.sqrDist=p.squaredDistance;p.length=function(a){var b=a[0],d=a[1];a=a[2];return Math.sqrt(b*b+d*d+a*a)};p.len=p.length;p.squaredLength=function(a){var b=a[0],d=a[1];a=a[2];return b*b+d*d+a*a};p.sqrLen=p.squaredLength;p.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];
a[2]=-b[2];return a};p.normalize=function(a,b){var d=b[0],f=b[1],E=b[2];d=d*d+f*f+E*E;0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d);return a};p.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};p.cross=function(a,b,d){var f=b[0],E=b[1];b=b[2];var c=d[0],L=d[1];d=d[2];a[0]=E*d-b*L;a[1]=b*c-f*d;a[2]=f*L-E*c;return a};p.lerp=function(a,b,d,h){var f=b[0],c=b[1];b=b[2];a[0]=f+h*(d[0]-f);a[1]=c+h*(d[1]-c);a[2]=b+h*(d[2]-b);return a};p.random=function(a,b){b=b||1;var d=2*m()*Math.PI,
f=2*m()-1,E=Math.sqrt(1-f*f)*b;a[0]=Math.cos(d)*E;a[1]=Math.sin(d)*E;a[2]=f*b;return a};p.transformMat4=function(a,b,d){var f=b[0],E=b[1];b=b[2];a[0]=d[0]*f+d[4]*E+d[8]*b+d[12];a[1]=d[1]*f+d[5]*E+d[9]*b+d[13];a[2]=d[2]*f+d[6]*E+d[10]*b+d[14];return a};p.transformMat3=function(a,b,d){var f=b[0],E=b[1];b=b[2];a[0]=f*d[0]+E*d[3]+b*d[6];a[1]=f*d[1]+E*d[4]+b*d[7];a[2]=f*d[2]+E*d[5]+b*d[8];return a};p.transformQuat=function(a,b,d){var f=b[0],E=b[1],c=b[2];b=d[0];var L=d[1],e=d[2];d=d[3];var g=d*f+L*c-e*
E,l=d*E+e*f-b*c,n=d*c+b*E-L*f;f=-b*f-L*E-e*c;a[0]=g*d+f*-b+l*-e-n*-L;a[1]=l*d+f*-L+n*-b-g*-e;a[2]=n*d+f*-e+g*-L-l*-b;return a};p.rotateX=function(a,b,d,h){var f=[],c=[];f[0]=b[0]-d[0];f[1]=b[1]-d[1];f[2]=b[2]-d[2];c[0]=f[0];c[1]=f[1]*Math.cos(h)-f[2]*Math.sin(h);c[2]=f[1]*Math.sin(h)+f[2]*Math.cos(h);a[0]=c[0]+d[0];a[1]=c[1]+d[1];a[2]=c[2]+d[2];return a};p.rotateY=function(a,b,d,h){var f=[],c=[];f[0]=b[0]-d[0];f[1]=b[1]-d[1];f[2]=b[2]-d[2];c[0]=f[2]*Math.sin(h)+f[0]*Math.cos(h);c[1]=f[1];c[2]=f[2]*
Math.cos(h)-f[0]*Math.sin(h);a[0]=c[0]+d[0];a[1]=c[1]+d[1];a[2]=c[2]+d[2];return a};p.rotateZ=function(a,b,d,h){var f=[],c=[];f[0]=b[0]-d[0];f[1]=b[1]-d[1];f[2]=b[2]-d[2];c[0]=f[0]*Math.cos(h)-f[1]*Math.sin(h);c[1]=f[0]*Math.sin(h)+f[1]*Math.cos(h);c[2]=f[2];a[0]=c[0]+d[0];a[1]=c[1]+d[1];a[2]=c[2]+d[2];return a};p.forEach=function(){var a=p.create();return function(b,d,f,c,D,L){d||(d=3);f||(f=0);for(c=c?Math.min(c*d+f,b.length):b.length;f<c;f+=d)a[0]=b[f],a[1]=b[f+1],a[2]=b[f+2],D(a,a,L),b[f]=a[0],
b[f+1]=a[1],b[f+2]=a[2];return b}}();p.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==typeof a&&(a.vec3=p);var q={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new e(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,d,h){var f=new e(4);f[0]=a;f[1]=b;f[2]=d;f[3]=h;return f},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,d,h,c){a[0]=b;a[1]=d;a[2]=h;a[3]=c;return a},
add:function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];a[3]=b[3]+d[3];return a},subtract:function(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];return a}};q.sub=q.subtract;q.multiply=function(a,b,d){a[0]=b[0]*d[0];a[1]=b[1]*d[1];a[2]=b[2]*d[2];a[3]=b[3]*d[3];return a};q.mul=q.multiply;q.divide=function(a,b,d){a[0]=b[0]/d[0];a[1]=b[1]/d[1];a[2]=b[2]/d[2];a[3]=b[3]/d[3];return a};q.div=q.divide;q.min=function(a,b,d){a[0]=Math.min(b[0],d[0]);a[1]=Math.min(b[1],d[1]);a[2]=
Math.min(b[2],d[2]);a[3]=Math.min(b[3],d[3]);return a};q.max=function(a,b,d){a[0]=Math.max(b[0],d[0]);a[1]=Math.max(b[1],d[1]);a[2]=Math.max(b[2],d[2]);a[3]=Math.max(b[3],d[3]);return a};q.scale=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;return a};q.scaleAndAdd=function(a,b,d,h){a[0]=b[0]+d[0]*h;a[1]=b[1]+d[1]*h;a[2]=b[2]+d[2]*h;a[3]=b[3]+d[3]*h;return a};q.distance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1],c=b[2]-a[2];a=b[3]-a[3];return Math.sqrt(d*d+f*f+c*c+a*a)};q.dist=q.distance;
q.squaredDistance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1],c=b[2]-a[2];a=b[3]-a[3];return d*d+f*f+c*c+a*a};q.sqrDist=q.squaredDistance;q.length=function(a){var b=a[0],d=a[1],f=a[2];a=a[3];return Math.sqrt(b*b+d*d+f*f+a*a)};q.len=q.length;q.squaredLength=function(a){var b=a[0],d=a[1],f=a[2];a=a[3];return b*b+d*d+f*f+a*a};q.sqrLen=q.squaredLength;q.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};q.normalize=function(a,b){var d=b[0],f=b[1],c=b[2],D=b[3];d=d*d+f*f+c*c+D*D;
0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d);return a};q.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};q.lerp=function(a,b,d,h){var f=b[0],c=b[1],L=b[2];b=b[3];a[0]=f+h*(d[0]-f);a[1]=c+h*(d[1]-c);a[2]=L+h*(d[2]-L);a[3]=b+h*(d[3]-b);return a};q.random=function(a,b){b=b||1;a[0]=m();a[1]=m();a[2]=m();a[3]=m();q.normalize(a,a);q.scale(a,a,b);return a};q.transformMat4=function(a,b,d){var f=b[0],c=b[1],D=b[2];b=b[3];a[0]=d[0]*f+d[4]*c+d[8]*D+d[12]*b;a[1]=d[1]*
f+d[5]*c+d[9]*D+d[13]*b;a[2]=d[2]*f+d[6]*c+d[10]*D+d[14]*b;a[3]=d[3]*f+d[7]*c+d[11]*D+d[15]*b;return a};q.transformQuat=function(a,b,d){var f=b[0],c=b[1],D=b[2];b=d[0];var L=d[1],e=d[2];d=d[3];var g=d*f+L*D-e*c,l=d*c+e*f-b*D,n=d*D+b*c-L*f;f=-b*f-L*c-e*D;a[0]=g*d+f*-b+l*-e-n*-L;a[1]=l*d+f*-L+n*-b-g*-e;a[2]=n*d+f*-e+g*-L-l*-b;return a};q.forEach=function(){var a=q.create();return function(b,d,f,c,D,e){d||(d=4);f||(f=0);for(c=c?Math.min(c*d+f,b.length):b.length;f<c;f+=d)a[0]=b[f],a[1]=b[f+1],a[2]=b[f+
2],a[3]=b[f+3],D(a,a,e),b[f]=a[0],b[f+1]=a[1],b[f+2]=a[2],b[f+3]=a[3];return b}}();q.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=q);k={create:function(){var a=new e(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var b=new e(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(a===
b){var d=b[1];a[1]=b[2];a[2]=d}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var d=b[0],f=b[1],c=b[2];b=b[3];var D=d*b-c*f;if(!D)return null;D=1/D;a[0]=b*D;a[1]=-f*D;a[2]=-c*D;a[3]=d*D;return a},adjoint:function(a,b){var d=b[0];a[0]=b[3];a[1]=-b[1];a[2]=-b[2];a[3]=d;return a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,b,d){var f=b[0],c=b[1],D=b[2];b=b[3];var e=d[0],l=d[1],g=d[2];d=d[3];a[0]=f*e+D*l;a[1]=c*e+b*l;a[2]=f*g+D*d;a[3]=c*g+b*d;return a}};
k.mul=k.multiply;k.rotate=function(a,b,d){var f=b[0],c=b[1],D=b[2];b=b[3];var e=Math.sin(d);d=Math.cos(d);a[0]=f*d+D*e;a[1]=c*d+b*e;a[2]=f*-e+D*d;a[3]=c*-e+b*d;return a};k.scale=function(a,b,d){var f=b[1],c=b[2],D=b[3],e=d[0];d=d[1];a[0]=b[0]*e;a[1]=f*e;a[2]=c*d;a[3]=D*d;return a};k.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};k.LDU=function(a,b,d,h){a[2]=h[2]/h[0];d[0]=
h[0];d[1]=h[1];d[3]=h[3]-a[2]*d[1];return[a,b,d]};"undefined"!==typeof a&&(a.mat2=k);k={create:function(){var a=new e(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var b=new e(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,b){var d=b[0],f=b[1],c=b[2],D=b[3],e=b[4];b=b[5];
var l=d*D-f*c;if(!l)return null;l=1/l;a[0]=D*l;a[1]=-f*l;a[2]=-c*l;a[3]=d*l;a[4]=(c*b-D*e)*l;a[5]=(f*e-d*b)*l;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,b,d){var f=b[0],c=b[1],D=b[2],e=b[3],l=b[4];b=b[5];var g=d[0],n=d[1],m=d[2],k=d[3],t=d[4];d=d[5];a[0]=f*g+D*n;a[1]=c*g+e*n;a[2]=f*m+D*k;a[3]=c*m+e*k;a[4]=f*t+D*d+l;a[5]=c*t+e*d+b;return a}};k.mul=k.multiply;k.rotate=function(a,b,d){var f=b[0],c=b[1],D=b[2],e=b[3],l=b[4];b=b[5];var g=Math.sin(d);d=Math.cos(d);
a[0]=f*d+D*g;a[1]=c*d+e*g;a[2]=f*-g+D*d;a[3]=c*-g+e*d;a[4]=l;a[5]=b;return a};k.scale=function(a,b,d){var f=b[1],c=b[2],D=b[3],e=b[4],l=b[5],g=d[0];d=d[1];a[0]=b[0]*g;a[1]=f*g;a[2]=c*d;a[3]=D*d;a[4]=e;a[5]=l;return a};k.translate=function(a,b,d){var f=b[0],c=b[1],D=b[2],e=b[3],l=b[4];b=b[5];var g=d[0];d=d[1];a[0]=f;a[1]=c;a[2]=D;a[3]=e;a[4]=f*g+D*d+l;a[5]=c*g+e*d+b;return a};k.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!==typeof a&&(a.mat2d=k);var r={create:function(){var a=new e(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new e(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,
b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var d=b[1],f=b[2],c=b[5];a[1]=b[3];a[2]=b[6];a[3]=d;a[5]=b[7];a[6]=f;a[7]=c}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var d=b[0],f=b[1],c=b[2],D=b[3],e=b[4],l=b[5],g=b[6],n=b[7];b=b[8];var m=
b*e-l*n,k=-b*D+l*g,t=n*D-e*g,p=d*m+f*k+c*t;if(!p)return null;p=1/p;a[0]=m*p;a[1]=(-b*f+c*n)*p;a[2]=(l*f-c*e)*p;a[3]=k*p;a[4]=(b*d-c*g)*p;a[5]=(-l*d+c*D)*p;a[6]=t*p;a[7]=(-n*d+f*g)*p;a[8]=(e*d-f*D)*p;return a},adjoint:function(a,b){var d=b[0],f=b[1],c=b[2],D=b[3],e=b[4],l=b[5],g=b[6],n=b[7];b=b[8];a[0]=e*b-l*n;a[1]=c*n-f*b;a[2]=f*l-c*e;a[3]=l*g-D*b;a[4]=d*b-c*g;a[5]=c*D-d*l;a[6]=D*n-e*g;a[7]=f*g-d*n;a[8]=d*e-f*D;return a},determinant:function(a){var b=a[3],d=a[4],f=a[5],c=a[6],D=a[7],e=a[8];return a[0]*
(e*d-f*D)+a[1]*(-e*b+f*c)+a[2]*(D*b-d*c)},multiply:function(a,b,d){var f=b[0],c=b[1],D=b[2],e=b[3],l=b[4],g=b[5],n=b[6],m=b[7];b=b[8];var k=d[0],p=d[1],t=d[2],q=d[3],u=d[4],v=d[5],r=d[6],w=d[7];d=d[8];a[0]=k*f+p*e+t*n;a[1]=k*c+p*l+t*m;a[2]=k*D+p*g+t*b;a[3]=q*f+u*e+v*n;a[4]=q*c+u*l+v*m;a[5]=q*D+u*g+v*b;a[6]=r*f+w*e+d*n;a[7]=r*c+w*l+d*m;a[8]=r*D+w*g+d*b;return a}};r.mul=r.multiply;r.translate=function(a,b,d){var f=b[0],c=b[1],D=b[2],e=b[3],l=b[4],g=b[5],n=b[6],m=b[7];b=b[8];var k=d[0];d=d[1];a[0]=f;
a[1]=c;a[2]=D;a[3]=e;a[4]=l;a[5]=g;a[6]=k*f+d*e+n;a[7]=k*c+d*l+m;a[8]=k*D+d*g+b;return a};r.rotate=function(a,b,d){var f=b[0],c=b[1],D=b[2],e=b[3],l=b[4],g=b[5],n=b[6],m=b[7];b=b[8];var k=Math.sin(d);d=Math.cos(d);a[0]=d*f+k*e;a[1]=d*c+k*l;a[2]=d*D+k*g;a[3]=d*e-k*f;a[4]=d*l-k*c;a[5]=d*g-k*D;a[6]=n;a[7]=m;a[8]=b;return a};r.scale=function(a,b,d){var f=d[0];d=d[1];a[0]=f*b[0];a[1]=f*b[1];a[2]=f*b[2];a[3]=d*b[3];a[4]=d*b[4];a[5]=d*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};r.fromMat2d=function(a,b){a[0]=
b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};r.fromQuat=function(a,b){var d=b[0],h=b[1],f=b[2];b=b[3];var c=d+d,e=h+h,l=f+f;d*=c;var g=h*c;h*=e;var n=f*c,m=f*e;f*=l;c*=b;e*=b;b*=l;a[0]=1-h-f;a[3]=g-b;a[6]=n+e;a[1]=g+b;a[4]=1-d-f;a[7]=m-c;a[2]=n-e;a[5]=m+c;a[8]=1-d-h;return a};r.normalFromMat4=function(a,b){var d=b[0],h=b[1],f=b[2],c=b[3],e=b[4],l=b[5],g=b[6],n=b[7],m=b[8],k=b[9],p=b[10],t=b[11],q=b[12],u=b[13],v=b[14];b=b[15];var r=d*l-h*e,w=d*g-f*e,A=d*n-
c*e,B=h*g-f*l,F=h*n-c*l,C=f*n-c*g,H=m*u-k*q,J=m*v-p*q;m=m*b-t*q;var K=k*v-p*u;k=k*b-t*u;p=p*b-t*v;t=r*p-w*k+A*K+B*m-F*J+C*H;if(!t)return null;t=1/t;a[0]=(l*p-g*k+n*K)*t;a[1]=(g*m-e*p-n*J)*t;a[2]=(e*k-l*m+n*H)*t;a[3]=(f*k-h*p-c*K)*t;a[4]=(d*p-f*m+c*J)*t;a[5]=(h*m-d*k-c*H)*t;a[6]=(u*C-v*F+b*B)*t;a[7]=(v*A-q*C-b*w)*t;a[8]=(q*F-u*A+b*r)*t;return a};r.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};r.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=r);var t={create:function(){var a=new e(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new e(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];
b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(a===b){var d=b[1],h=b[2],f=b[3],c=b[6],e=b[7],l=b[11];a[1]=b[4];a[2]=
b[8];a[3]=b[12];a[4]=d;a[6]=b[9];a[7]=b[13];a[8]=h;a[9]=c;a[11]=b[14];a[12]=f;a[13]=e;a[14]=l}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var d=b[0],h=b[1],c=b[2],f=b[3],e=b[4],l=b[5],g=b[6],n=b[7],m=b[8],k=b[9],t=b[10],p=b[11],q=b[12],u=b[13],v=b[14];b=b[15];var r=d*l-h*e,w=d*g-c*e,A=d*n-f*e,B=h*g-c*l,F=h*n-f*l,C=c*n-f*g,H=m*u-k*q,J=m*
v-t*q,K=m*b-p*q,M=k*v-t*u,O=k*b-p*u,Q=t*b-p*v,I=r*Q-w*O+A*M+B*K-F*J+C*H;if(!I)return null;I=1/I;a[0]=(l*Q-g*O+n*M)*I;a[1]=(c*O-h*Q-f*M)*I;a[2]=(u*C-v*F+b*B)*I;a[3]=(t*F-k*C-p*B)*I;a[4]=(g*K-e*Q-n*J)*I;a[5]=(d*Q-c*K+f*J)*I;a[6]=(v*A-q*C-b*w)*I;a[7]=(m*C-t*A+p*w)*I;a[8]=(e*O-l*K+n*H)*I;a[9]=(h*K-d*O-f*H)*I;a[10]=(q*F-u*A+b*r)*I;a[11]=(k*A-m*F-p*r)*I;a[12]=(l*J-e*M-g*H)*I;a[13]=(d*M-h*J+c*H)*I;a[14]=(u*w-q*B-v*r)*I;a[15]=(m*B-k*w+t*r)*I;return a},adjoint:function(a,b){var d=b[0],h=b[1],c=b[2],f=b[3],
e=b[4],l=b[5],g=b[6],n=b[7],m=b[8],k=b[9],t=b[10],p=b[11],q=b[12],u=b[13],v=b[14];b=b[15];a[0]=l*(t*b-p*v)-k*(g*b-n*v)+u*(g*p-n*t);a[1]=-(h*(t*b-p*v)-k*(c*b-f*v)+u*(c*p-f*t));a[2]=h*(g*b-n*v)-l*(c*b-f*v)+u*(c*n-f*g);a[3]=-(h*(g*p-n*t)-l*(c*p-f*t)+k*(c*n-f*g));a[4]=-(e*(t*b-p*v)-m*(g*b-n*v)+q*(g*p-n*t));a[5]=d*(t*b-p*v)-m*(c*b-f*v)+q*(c*p-f*t);a[6]=-(d*(g*b-n*v)-e*(c*b-f*v)+q*(c*n-f*g));a[7]=d*(g*p-n*t)-e*(c*p-f*t)+m*(c*n-f*g);a[8]=e*(k*b-p*u)-m*(l*b-n*u)+q*(l*p-n*k);a[9]=-(d*(k*b-p*u)-m*(h*b-f*u)+
q*(h*p-f*k));a[10]=d*(l*b-n*u)-e*(h*b-f*u)+q*(h*n-f*l);a[11]=-(d*(l*p-n*k)-e*(h*p-f*k)+m*(h*n-f*l));a[12]=-(e*(k*v-t*u)-m*(l*v-g*u)+q*(l*t-g*k));a[13]=d*(k*v-t*u)-m*(h*v-c*u)+q*(h*t-c*k);a[14]=-(d*(l*v-g*u)-e*(h*v-c*u)+q*(h*g-c*l));a[15]=d*(l*t-g*k)-e*(h*t-c*k)+m*(h*g-c*l);return a},determinant:function(a){var b=a[0],d=a[1],h=a[2],c=a[3],f=a[4],e=a[5],l=a[6],g=a[7],n=a[8],m=a[9],k=a[10],t=a[11],p=a[12],q=a[13],u=a[14];a=a[15];return(b*e-d*f)*(k*a-t*u)-(b*l-h*f)*(m*a-t*q)+(b*g-c*f)*(m*u-k*q)+(d*l-
h*e)*(n*a-t*p)-(d*g-c*e)*(n*u-k*p)+(h*g-c*l)*(n*q-m*p)},multiply:function(a,b,d){var h=b[0],c=b[1],f=b[2],e=b[3],l=b[4],g=b[5],n=b[6],m=b[7],k=b[8],t=b[9],p=b[10],q=b[11],u=b[12],v=b[13],r=b[14];b=b[15];var w=d[0],A=d[1],B=d[2],F=d[3];a[0]=w*h+A*l+B*k+F*u;a[1]=w*c+A*g+B*t+F*v;a[2]=w*f+A*n+B*p+F*r;a[3]=w*e+A*m+B*q+F*b;w=d[4];A=d[5];B=d[6];F=d[7];a[4]=w*h+A*l+B*k+F*u;a[5]=w*c+A*g+B*t+F*v;a[6]=w*f+A*n+B*p+F*r;a[7]=w*e+A*m+B*q+F*b;w=d[8];A=d[9];B=d[10];F=d[11];a[8]=w*h+A*l+B*k+F*u;a[9]=w*c+A*g+B*t+F*
v;a[10]=w*f+A*n+B*p+F*r;a[11]=w*e+A*m+B*q+F*b;w=d[12];A=d[13];B=d[14];F=d[15];a[12]=w*h+A*l+B*k+F*u;a[13]=w*c+A*g+B*t+F*v;a[14]=w*f+A*n+B*p+F*r;a[15]=w*e+A*m+B*q+F*b;return a}};t.mul=t.multiply;t.translate=function(a,b,d){var h=d[0],c=d[1];d=d[2];if(b===a)a[12]=b[0]*h+b[4]*c+b[8]*d+b[12],a[13]=b[1]*h+b[5]*c+b[9]*d+b[13],a[14]=b[2]*h+b[6]*c+b[10]*d+b[14],a[15]=b[3]*h+b[7]*c+b[11]*d+b[15];else{var f=b[0];var e=b[1];var l=b[2];var g=b[3];var n=b[4];var m=b[5];var k=b[6];var t=b[7];var p=b[8];var q=b[9];
var u=b[10];var v=b[11];a[0]=f;a[1]=e;a[2]=l;a[3]=g;a[4]=n;a[5]=m;a[6]=k;a[7]=t;a[8]=p;a[9]=q;a[10]=u;a[11]=v;a[12]=f*h+n*c+p*d+b[12];a[13]=e*h+m*c+q*d+b[13];a[14]=l*h+k*c+u*d+b[14];a[15]=g*h+t*c+v*d+b[15]}return a};t.scale=function(a,b,d){var h=d[0],c=d[1];d=d[2];a[0]=b[0]*h;a[1]=b[1]*h;a[2]=b[2]*h;a[3]=b[3]*h;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};t.rotate=function(a,b,d,h){var f=
h[0],e=h[1];h=h[2];var l=Math.sqrt(f*f+e*e+h*h);if(Math.abs(l)<c)return null;l=1/l;f*=l;e*=l;h*=l;var n=Math.sin(d);var g=Math.cos(d);var m=1-g;d=b[0];l=b[1];var k=b[2];var t=b[3];var p=b[4];var q=b[5];var u=b[6];var v=b[7];var w=b[8];var A=b[9];var r=b[10];var B=b[11];var R=f*f*m+g;var F=e*f*m+h*n;var C=h*f*m-e*n;var H=f*e*m-h*n;var J=e*e*m+g;var K=h*e*m+f*n;var M=f*h*m+e*n;f=e*h*m-f*n;e=h*h*m+g;a[0]=d*R+p*F+w*C;a[1]=l*R+q*F+A*C;a[2]=k*R+u*F+r*C;a[3]=t*R+v*F+B*C;a[4]=d*H+p*J+w*K;a[5]=l*H+q*J+A*K;
a[6]=k*H+u*J+r*K;a[7]=t*H+v*J+B*K;a[8]=d*M+p*f+w*e;a[9]=l*M+q*f+A*e;a[10]=k*M+u*f+r*e;a[11]=t*M+v*f+B*e;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};t.rotateX=function(a,b,d){var h=Math.sin(d);d=Math.cos(d);var c=b[4],f=b[5],e=b[6],l=b[7],g=b[8],n=b[9],m=b[10],k=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=c*d+g*h;a[5]=f*d+n*h;a[6]=e*d+m*h;a[7]=l*d+k*h;a[8]=g*d-c*h;a[9]=n*d-f*h;a[10]=m*d-e*h;a[11]=k*d-l*h;return a};
t.rotateY=function(a,b,d){var h=Math.sin(d);d=Math.cos(d);var c=b[0],f=b[1],e=b[2],l=b[3],g=b[8],n=b[9],m=b[10],k=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=c*d-g*h;a[1]=f*d-n*h;a[2]=e*d-m*h;a[3]=l*d-k*h;a[8]=c*h+g*d;a[9]=f*h+n*d;a[10]=e*h+m*d;a[11]=l*h+k*d;return a};t.rotateZ=function(a,b,d){var h=Math.sin(d);d=Math.cos(d);var c=b[0],f=b[1],e=b[2],l=b[3],g=b[4],n=b[5],m=b[6],k=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],
a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=c*d+g*h;a[1]=f*d+n*h;a[2]=e*d+m*h;a[3]=l*d+k*h;a[4]=g*d-c*h;a[5]=n*d-f*h;a[6]=m*d-e*h;a[7]=k*d-l*h;return a};t.fromRotationTranslation=function(a,b,d){var h=b[0],c=b[1],f=b[2],e=b[3],l=h+h,g=c+c,n=f+f;b=h*l;var m=h*g;h*=n;var k=c*g;c*=n;f*=n;l*=e;g*=e;e*=n;a[0]=1-(k+f);a[1]=m+e;a[2]=h-g;a[3]=0;a[4]=m-e;a[5]=1-(b+f);a[6]=c+l;a[7]=0;a[8]=h+g;a[9]=c-l;a[10]=1-(b+k);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};t.fromQuat=function(a,b){var d=
b[0],h=b[1],c=b[2];b=b[3];var f=d+d,e=h+h,l=c+c;d*=f;var g=h*f;h*=e;var n=c*f,m=c*e;c*=l;f*=b;e*=b;b*=l;a[0]=1-h-c;a[1]=g+b;a[2]=n-e;a[3]=0;a[4]=g-b;a[5]=1-d-c;a[6]=m+f;a[7]=0;a[8]=n+e;a[9]=m-f;a[10]=1-d-h;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};t.frustum=function(a,b,d,h,c,e,l){var f=1/(d-b),g=1/(c-h),E=1/(e-l);a[0]=2*e*f;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e*g;a[6]=0;a[7]=0;a[8]=(d+b)*f;a[9]=(c+h)*g;a[10]=(l+e)*E;a[11]=-1;a[12]=0;a[13]=0;a[14]=l*e*2*E;a[15]=0;return a};t.perspective=function(a,
b,d,h,c){b=1/Math.tan(b/2);var f=1/(h-c);a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(c+h)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*c*h*f;a[15]=0;return a};t.ortho=function(a,b,d,h,c,e,l){var f=1/(b-d),g=1/(h-c),E=1/(e-l);a[0]=-2*f;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*g;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*E;a[11]=0;a[12]=(b+d)*f;a[13]=(c+h)*g;a[14]=(l+e)*E;a[15]=1;return a};t.lookAt=function(a,b,d,h){var f=b[0],e=b[1];b=b[2];var l=h[0];var n=h[1];var g=h[2];var m=d[0];h=
d[1];var k=d[2];if(Math.abs(f-m)<c&&Math.abs(e-h)<c&&Math.abs(b-k)<c)return t.identity(a);d=f-m;h=e-h;m=b-k;var p=1/Math.sqrt(d*d+h*h+m*m);d*=p;h*=p;m*=p;k=n*m-g*h;g=g*d-l*m;l=l*h-n*d;(p=Math.sqrt(k*k+g*g+l*l))?(p=1/p,k*=p,g*=p,l*=p):l=g=k=0;n=h*l-m*g;var q=m*k-d*l;var u=d*g-h*k;(p=Math.sqrt(n*n+q*q+u*u))?(p=1/p,n*=p,q*=p,u*=p):u=q=n=0;a[0]=k;a[1]=n;a[2]=d;a[3]=0;a[4]=g;a[5]=q;a[6]=h;a[7]=0;a[8]=l;a[9]=u;a[10]=m;a[11]=0;a[12]=-(k*f+g*e+l*b);a[13]=-(n*f+q*e+u*b);a[14]=-(d*f+h*e+m*b);a[15]=1;return a};
t.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};t.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],
2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=t);var A={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};A.rotationTo=function(){var a=p.create(),b=p.fromValues(1,0,0),d=p.fromValues(0,1,0);return function(h,c,f){var e=p.dot(c,f);if(-.999999>e)return p.cross(a,b,c),1E-6>p.length(a)&&p.cross(a,d,c),p.normalize(a,a),A.setAxisAngle(h,a,Math.PI),h;if(.999999<e)return h[0]=0,h[1]=0,h[2]=0,h[3]=1,h;p.cross(a,c,f);h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=1+e;return A.normalize(h,
h)}}();A.setAxes=function(){var a=r.create();return function(b,d,h,c){a[0]=h[0];a[3]=h[1];a[6]=h[2];a[1]=c[0];a[4]=c[1];a[7]=c[2];a[2]=-d[0];a[5]=-d[1];a[8]=-d[2];return A.normalize(b,A.fromMat3(b,a))}}();A.clone=q.clone;A.fromValues=q.fromValues;A.copy=q.copy;A.set=q.set;A.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};A.setAxisAngle=function(a,b,d){d*=.5;var h=Math.sin(d);a[0]=h*b[0];a[1]=h*b[1];a[2]=h*b[2];a[3]=Math.cos(d);return a};A.add=q.add;A.multiply=function(a,b,d){var h=b[0],
c=b[1],e=b[2];b=b[3];var f=d[0],l=d[1],g=d[2];d=d[3];a[0]=h*d+b*f+c*g-e*l;a[1]=c*d+b*l+e*f-h*g;a[2]=e*d+b*g+h*l-c*f;a[3]=b*d-h*f-c*l-e*g;return a};A.mul=A.multiply;A.scale=q.scale;A.rotateX=function(a,b,d){d*=.5;var h=b[0],c=b[1],e=b[2];b=b[3];var f=Math.sin(d);d=Math.cos(d);a[0]=h*d+b*f;a[1]=c*d+e*f;a[2]=e*d-c*f;a[3]=b*d-h*f;return a};A.rotateY=function(a,b,d){d*=.5;var h=b[0],c=b[1],e=b[2];b=b[3];var f=Math.sin(d);d=Math.cos(d);a[0]=h*d-e*f;a[1]=c*d+b*f;a[2]=e*d+h*f;a[3]=b*d-c*f;return a};A.rotateZ=
function(a,b,d){d*=.5;var h=b[0],c=b[1],e=b[2];b=b[3];var f=Math.sin(d);d=Math.cos(d);a[0]=h*d+c*f;a[1]=c*d-h*f;a[2]=e*d+b*f;a[3]=b*d-e*f;return a};A.calculateW=function(a,b){var d=b[0],h=b[1];b=b[2];a[0]=d;a[1]=h;a[2]=b;a[3]=-Math.sqrt(Math.abs(1-d*d-h*h-b*b));return a};A.dot=q.dot;A.lerp=q.lerp;A.slerp=function(a,b,d,h){var c=b[0],e=b[1],f=b[2];b=b[3];var l=d[0],g=d[1],n=d[2];d=d[3];var m=c*l+e*g+f*n+b*d;0>m&&(m=-m,l=-l,g=-g,n=-n,d=-d);if(1E-6<1-m){var k=Math.acos(m);var p=Math.sin(k);m=Math.sin((1-
h)*k)/p;h=Math.sin(h*k)/p}else m=1-h;a[0]=m*c+h*l;a[1]=m*e+h*g;a[2]=m*f+h*n;a[3]=m*b+h*d;return a};A.invert=function(a,b){var d=b[0],h=b[1],c=b[2];b=b[3];var e=d*d+h*h+c*c+b*b;e=e?1/e:0;a[0]=-d*e;a[1]=-h*e;a[2]=-c*e;a[3]=b*e;return a};A.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};A.length=q.length;A.len=A.length;A.squaredLength=q.squaredLength;A.sqrLen=A.squaredLength;A.normalize=q.normalize;A.fromMat3=function(a,b){var d=b[0]+b[4]+b[8];if(0<d)d=Math.sqrt(d+1),a[3]=
.5*d,d=.5/d,a[0]=(b[7]-b[5])*d,a[1]=(b[2]-b[6])*d,a[2]=(b[3]-b[1])*d;else{var h=0;b[4]>b[0]&&(h=1);b[8]>b[3*h+h]&&(h=2);var c=(h+1)%3,e=(h+2)%3;d=Math.sqrt(b[3*h+h]-b[3*c+c]-b[3*e+e]+1);a[h]=.5*d;d=.5/d;a[3]=(b[3*e+c]-b[3*c+e])*d;a[c]=(b[3*c+h]+b[3*h+c])*d;a[e]=(b[3*e+h]+b[3*h+e])*d}return a};A.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=A)})("undefined"===typeof k?"undefined"!==typeof window?window:a:k)})(this)},{}],23:[function(a,c,k){(function(a){(function(){c.exports=
function(){return a.WebSocket||a.MozWebSocket}}).call(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],24:[function(a,c,k){function m(){throw Error("setTimeout has not been defined");}function e(){throw Error("clearTimeout has not been defined");}function l(a){if(p===setTimeout)return setTimeout(a,0);if((p===m||!p)&&setTimeout)return p=setTimeout,setTimeout(a,0);try{return p(a,0)}catch(d){try{return p.call(null,a,0)}catch(h){return p.call(this,
a,0)}}}function n(a){if(q===clearTimeout)return clearTimeout(a);if((q===e||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(d){try{return q.call(null,a)}catch(h){return q.call(this,a)}}}function v(){t&&A&&(t=!1,A.length?r=A.concat(r):f=-1,r.length&&u())}function u(){if(!t){var a=l(v);t=!0;for(var d=r.length;d;){A=r;for(r=[];++f<d;)A&&A[f].run();f=-1;d=r.length}A=null;t=!1;n(a)}}function B(a,d){this.fun=a;this.array=d}function w(){}a=c.exports={};try{var p="function"===
typeof setTimeout?setTimeout:m}catch(b){p=m}try{var q="function"===typeof clearTimeout?clearTimeout:e}catch(b){q=e}var r=[],t=!1,A,f=-1;a.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var h=1;h<arguments.length;h++)b[h-1]=arguments[h];r.push(new B(a,b));1!==r.length||t||l(u)};B.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=w;a.addListener=w;a.once=w;a.off=w;a.removeListener=
w;a.removeAllListeners=w;a.emit=w;a.prependListener=w;a.prependOnceListener=w;a.listeners=function(a){return[]};a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],25:[function(a,c,k){(function(){var a=this,e=a._,l={},n=Array.prototype,v=Object.prototype,u=n.push,B=n.slice,w=n.concat,p=v.toString,q=v.hasOwnProperty,r=n.forEach,t=n.map,A=n.reduce,f=n.reduceRight,
b=n.filter,d=n.every,h=n.some,E=n.indexOf,D=n.lastIndexOf;v=Array.isArray;var L=Object.keys,S=Function.prototype.bind,g=function(a){if(a instanceof g)return a;if(!(this instanceof g))return new g(a);this._wrapped=a};"undefined"!==typeof k?("undefined"!==typeof c&&c.exports&&(k=c.exports=g),k._=g):a._=g;g.VERSION="1.4.4";var G=g.each=g.forEach=function(a,b,d){if(null!=a)if(r&&a.forEach===r)a.forEach(b,d);else if(a.length===+a.length)for(var h=0,c=a.length;h<c&&b.call(d,a[h],h,a)!==l;h++);else for(h in a)if(g.has(a,
h)&&b.call(d,a[h],h,a)===l)break};g.map=g.collect=function(a,b,d){var h=[];if(null==a)return h;if(t&&a.map===t)return a.map(b,d);G(a,function(a,c,C){h[h.length]=b.call(d,a,c,C)});return h};g.reduce=g.foldl=g.inject=function(a,b,d,h){var c=2<arguments.length;null==a&&(a=[]);if(A&&a.reduce===A)return h&&(b=g.bind(b,h)),c?a.reduce(b,d):a.reduce(b);G(a,function(a,C,g){c?d=b.call(h,d,a,C,g):(d=a,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return d};g.reduceRight=g.foldr=
function(a,b,d,h){var c=2<arguments.length;null==a&&(a=[]);if(f&&a.reduceRight===f)return h&&(b=g.bind(b,h)),c?a.reduceRight(b,d):a.reduceRight(b);var C=a.length;if(C!==+C){var e=g.keys(a);C=e.length}G(a,function(g,f,H){f=e?e[--C]:--C;c?d=b.call(h,d,a[f],f,H):(d=a[f],c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return d};g.find=g.detect=function(a,b,d){var h;W(a,function(a,c,C){if(b.call(d,a,c,C))return h=a,!0});return h};g.filter=g.select=function(a,d,h){var c=
[];if(null==a)return c;if(b&&a.filter===b)return a.filter(d,h);G(a,function(a,b,C){d.call(h,a,b,C)&&(c[c.length]=a)});return c};g.reject=function(a,b,d){return g.filter(a,function(a,h,c){return!b.call(d,a,h,c)},d)};g.every=g.all=function(a,b,h){b||(b=g.identity);var c=!0;if(null==a)return c;if(d&&a.every===d)return a.every(b,h);G(a,function(a,d,C){if(!(c=c&&b.call(h,a,d,C)))return l});return!!c};var W=g.some=g.any=function(a,b,d){b||(b=g.identity);var c=!1;if(null==a)return c;if(h&&a.some===h)return a.some(b,
d);G(a,function(a,h,C){if(c||(c=b.call(d,a,h,C)))return l});return!!c};g.contains=g.include=function(a,b){return null==a?!1:E&&a.indexOf===E?-1!=a.indexOf(b):W(a,function(a){return a===b})};g.invoke=function(a,b){var d=B.call(arguments,2),h=g.isFunction(b);return g.map(a,function(a){return(h?b:a[b]).apply(a,d)})};g.pluck=function(a,b){return g.map(a,function(a){return a[b]})};g.where=function(a,b,d){return g.isEmpty(b)?d?null:[]:g[d?"find":"filter"](a,function(a){for(var d in b)if(b[d]!==a[d])return!1;
return!0})};g.findWhere=function(a,b){return g.where(a,b,!0)};g.max=function(a,b,d){if(!b&&g.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&g.isEmpty(a))return-Infinity;var h={computed:-Infinity,value:-Infinity};G(a,function(a,c,C){c=b?b.call(d,a,c,C):a;c>=h.computed&&(h={value:a,computed:c})});return h.value};g.min=function(a,b,d){if(!b&&g.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&g.isEmpty(a))return Infinity;var h={computed:Infinity,
value:Infinity};G(a,function(a,c,C){c=b?b.call(d,a,c,C):a;c<h.computed&&(h={value:a,computed:c})});return h.value};g.shuffle=function(a){var b,d=0,h=[];G(a,function(a){b=g.random(d++);h[d-1]=h[b];h[b]=a});return h};var T=function(a){return g.isFunction(a)?a:function(b){return b[a]}};g.sortBy=function(a,b,d){var h=T(b);return g.pluck(g.map(a,function(a,b,c){return{value:a,index:b,criteria:h.call(d,a,b,c)}}).sort(function(a,b){var d=a.criteria,h=b.criteria;if(d!==h){if(d>h||void 0===d)return 1;if(d<
h||void 0===h)return-1}return a.index<b.index?-1:1}),"value")};var X=function(a,b,d,h){var c={},C=T(b||g.identity);G(a,function(b,g){g=C.call(d,b,g,a);h(c,g,b)});return c};g.groupBy=function(a,b,d){return X(a,b,d,function(a,b,d){(g.has(a,b)?a[b]:a[b]=[]).push(d)})};g.countBy=function(a,b,d){return X(a,b,d,function(a,b){g.has(a,b)||(a[b]=0);a[b]++})};g.sortedIndex=function(a,b,d,h){d=null==d?g.identity:T(d);b=d.call(h,b);for(var c=0,C=a.length;c<C;){var e=c+C>>>1;d.call(h,a[e])<b?c=e+1:C=e}return c};
g.toArray=function(a){return a?g.isArray(a)?B.call(a):a.length===+a.length?g.map(a,g.identity):g.values(a):[]};g.size=function(a){return null==a?0:a.length===+a.length?a.length:g.keys(a).length};g.first=g.head=g.take=function(a,b,d){if(null!=a)return null==b||d?a[0]:B.call(a,0,b)};g.initial=function(a,b,d){return B.call(a,0,a.length-(null==b||d?1:b))};g.last=function(a,b,d){if(null!=a)return null==b||d?a[a.length-1]:B.call(a,Math.max(a.length-b,0))};g.rest=g.tail=g.drop=function(a,b,d){return B.call(a,
null==b||d?1:b)};g.compact=function(a){return g.filter(a,g.identity)};var Y=function(a,b,d){G(a,function(a){g.isArray(a)?b?u.apply(d,a):Y(a,b,d):d.push(a)});return d};g.flatten=function(a,b){return Y(a,b,[])};g.without=function(a){return g.difference(a,B.call(arguments,1))};g.uniq=g.unique=function(a,b,d,h){g.isFunction(b)&&(h=d,d=b,b=!1);d=d?g.map(a,d,h):a;var c=[],C=[];G(d,function(d,h){(b?h&&C[C.length-1]===d:g.contains(C,d))||(C.push(d),c.push(a[h]))});return c};g.union=function(){return g.uniq(w.apply(n,
arguments))};g.intersection=function(a){var b=B.call(arguments,1);return g.filter(g.uniq(a),function(a){return g.every(b,function(b){return 0<=g.indexOf(b,a)})})};g.difference=function(a){var b=w.apply(n,B.call(arguments,1));return g.filter(a,function(a){return!g.contains(b,a)})};g.zip=function(){for(var a=B.call(arguments),b=g.max(g.pluck(a,"length")),d=Array(b),h=0;h<b;h++)d[h]=g.pluck(a,""+h);return d};g.object=function(a,b){if(null==a)return{};for(var d={},h=0,c=a.length;h<c;h++)b?d[a[h]]=b[h]:
d[a[h][0]]=a[h][1];return d};g.indexOf=function(a,b,d){if(null==a)return-1;var h=0,c=a.length;if(d)if("number"==typeof d)h=0>d?Math.max(0,c+d):d;else return h=g.sortedIndex(a,b),a[h]===b?h:-1;if(E&&a.indexOf===E)return a.indexOf(b,d);for(;h<c;h++)if(a[h]===b)return h;return-1};g.lastIndexOf=function(a,b,d){if(null==a)return-1;var h=null!=d;if(D&&a.lastIndexOf===D)return h?a.lastIndexOf(b,d):a.lastIndexOf(b);for(d=h?d:a.length;d--;)if(a[d]===b)return d;return-1};g.range=function(a,b,d){1>=arguments.length&&
(b=a||0,a=0);d=arguments[2]||1;for(var h=Math.max(Math.ceil((b-a)/d),0),c=0,g=Array(h);c<h;)g[c++]=a,a+=d;return g};g.bind=function(a,b){if(a.bind===S&&S)return S.apply(a,B.call(arguments,1));var d=B.call(arguments,2);return function(){return a.apply(b,d.concat(B.call(arguments)))}};g.partial=function(a){var b=B.call(arguments,1);return function(){return a.apply(this,b.concat(B.call(arguments)))}};g.bindAll=function(a){var b=B.call(arguments,1);0===b.length&&(b=g.functions(a));G(b,function(b){a[b]=
g.bind(a[b],a)});return a};g.memoize=function(a,b){var d={};b||(b=g.identity);return function(){var h=b.apply(this,arguments);return g.has(d,h)?d[h]:d[h]=a.apply(this,arguments)}};g.delay=function(a,b){var d=B.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};g.defer=function(a){return g.delay.apply(g,[a,1].concat(B.call(arguments,1)))};g.throttle=function(a,b){var d,h,c,g,e=0,C=function(){e=new Date;c=null;g=a.apply(d,h)};return function(){var f=new Date,l=b-(f-e);d=this;
h=arguments;0>=l?(clearTimeout(c),c=null,e=f,g=a.apply(d,h)):c||(c=setTimeout(C,l));return g}};g.debounce=function(a,b,d){var h,c;return function(){var g=this,e=arguments,C=d&&!h;clearTimeout(h);h=setTimeout(function(){h=null;d||(c=a.apply(g,e))},b);C&&(c=a.apply(g,e));return c}};g.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;d=a.apply(this,arguments);a=null;return d}};g.wrap=function(a,b){return function(){var d=[a];u.apply(d,arguments);return b.apply(this,d)}};g.compose=function(){var a=
arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};g.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};g.keys=L||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)g.has(a,d)&&(b[b.length]=d);return b};g.values=function(a){var b=[],d;for(d in a)g.has(a,d)&&b.push(a[d]);return b};g.pairs=function(a){var b=[],d;for(d in a)g.has(a,d)&&b.push([d,a[d]]);return b};g.invert=
function(a){var b={},d;for(d in a)g.has(a,d)&&(b[a[d]]=d);return b};g.functions=g.methods=function(a){var b=[],d;for(d in a)g.isFunction(a[d])&&b.push(d);return b.sort()};g.extend=function(a){G(B.call(arguments,1),function(b){if(b)for(var d in b)a[d]=b[d]});return a};g.pick=function(a){var b={},d=w.apply(n,B.call(arguments,1));G(d,function(d){d in a&&(b[d]=a[d])});return b};g.omit=function(a){var b={},d=w.apply(n,B.call(arguments,1)),h;for(h in a)g.contains(d,h)||(b[h]=a[h]);return b};g.defaults=
function(a){G(B.call(arguments,1),function(b){if(b)for(var d in b)null==a[d]&&(a[d]=b[d])});return a};g.clone=function(a){return g.isObject(a)?g.isArray(a)?a.slice():g.extend({},a):a};g.tap=function(a,b){b(a);return a};var U=function(a,b,d,h){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof g&&(a=a._wrapped);b instanceof g&&(b=b._wrapped);var c=p.call(a);if(c!=p.call(b))return!1;switch(c){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=
+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var e=d.length;e--;)if(d[e]==a)return h[e]==b;d.push(a);h.push(b);e=0;var f=!0;if("[object Array]"==c){if(e=a.length,f=e==b.length)for(;e--&&(f=U(a[e],b[e],d,h)););}else{c=a.constructor;var C=b.constructor;if(c!==C&&!(g.isFunction(c)&&c instanceof
c&&g.isFunction(C)&&C instanceof C))return!1;for(var l in a)if(g.has(a,l)&&(e++,!(f=g.has(b,l)&&U(a[l],b[l],d,h))))break;if(f){for(l in b)if(g.has(b,l)&&!e--)break;f=!e}}d.pop();h.pop();return f};g.isEqual=function(a,b){return U(a,b,[],[])};g.isEmpty=function(a){if(null==a)return!0;if(g.isArray(a)||g.isString(a))return 0===a.length;for(var b in a)if(g.has(a,b))return!1;return!0};g.isElement=function(a){return!(!a||1!==a.nodeType)};g.isArray=v||function(a){return"[object Array]"==p.call(a)};g.isObject=
function(a){return a===Object(a)};G("Arguments Function String Number Date RegExp".split(" "),function(a){g["is"+a]=function(b){return p.call(b)=="[object "+a+"]"}});g.isArguments(arguments)||(g.isArguments=function(a){return!(!a||!g.has(a,"callee"))});"function"!==typeof/./&&(g.isFunction=function(a){return"function"===typeof a});g.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};g.isNaN=function(a){return g.isNumber(a)&&a!=+a};g.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==
p.call(a)};g.isNull=function(a){return null===a};g.isUndefined=function(a){return void 0===a};g.has=function(a,b){return q.call(a,b)};g.noConflict=function(){a._=e;return this};g.identity=function(a){return a};g.times=function(a,b,d){for(var h=Array(a),c=0;c<a;c++)h[c]=b.call(d,c);return h};g.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=g.invert(P.escape);var Z=
{escape:new RegExp("["+g.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+g.keys(P.unescape).join("|")+")","g")};g.each(["escape","unescape"],function(a){g[a]=function(b){return null==b?"":(""+b).replace(Z[a],function(b){return P[a][b]})}});g.result=function(a,b){if(null==a)return null;b=a[b];return g.isFunction(b)?b.call(a):b};g.mixin=function(a){G(g.functions(a),function(b){var d=g[b]=a[b];g.prototype[b]=function(){var a=[this._wrapped];u.apply(a,arguments);return F.call(this,d.apply(g,
a))}})};var aa=0;g.uniqueId=function(a){var b=++aa+"";return a?a+b:b};g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,ba={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;g.template=function(a,b,d){d=g.defaults({},d,g.templateSettings);var h=new RegExp([(d.escape||V).source,(d.interpolate||V).source,(d.evaluate||V).source].join("|")+"|$","g"),c=0,e="__p+='";a.replace(h,
function(b,d,h,g,f){e+=a.slice(c,f).replace(R,function(a){return"\\"+ba[a]});d&&(e+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");h&&(e+="'+\n((__t=("+h+"))==null?'':__t)+\n'");g&&(e+="';\n"+g+"\n__p+='");c=f+b.length;return b});e+="';\n";d.variable||(e="with(obj||{}){\n"+e+"}\n");e="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+e+"return __p;\n";try{var f=new Function(d.variable||"obj","_",e)}catch(I){throw I.source=e,I;}if(b)return f(b,g);b=function(a){return f.call(this,
a,g)};b.source="function("+(d.variable||"obj")+"){\n"+e+"}";return b};g.chain=function(a){return g(a).chain()};var F=function(a){return this._chain?g(a).chain():a};g.mixin(g);G("pop push reverse shift sort splice unshift".split(" "),function(a){var b=n[a];g.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);"shift"!=a&&"splice"!=a||0!==d.length||delete d[0];return F.call(this,d)}});G(["concat","join","slice"],function(a){var b=n[a];g.prototype[a]=function(){return F.call(this,b.apply(this._wrapped,
arguments))}});g.extend(g.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this)},{}]},{},[13])(13)});var CindyLeap=function(a){function c(a,c){var e,l;for(e in a)(l=c[e])?l(m(a[e])):console.log("Modifier "+e+" not supported")}var k=a.nada,m=a.evaluate,e=a.defineFunction;e("initleapmotion",0,function(e,n){var l=!1;c(n,{enablegestures:function(a){return l=coerce.toBool(a,!1)},usehandtransformcdy3d:function(a){return setManipulateSceneTransformActive(coerce.toBool(a,!1))},rotationfactor:function(a){return setLeapMotionRotationFactor(coerce.toReal(a,2))},translationfactor:function(a){return setLeapMotionTranslationFactor(coerce.toReal(a,
1))}});initLeapMotion(a,l);return k});e("leapdebugprinthands",0,function(a,c){a=getLeapHandsData();0<a.length&&console.log(a);return k});e("leapdebugprintgestures",0,function(a,c){a=getLeapGestureData();0<a.length&&console.log(a);return k});e("leapnormalizeposition",1,function(c,e){c=a.evaluate(c[0]).value;c=leapNormalizePosition([c[0].value.real,c[1].value.real,c[2].value.real]);return nestedArrayToCSList(c)});e("getleaphandsdata",0,function(a,c){a=new Set(["frame"]);c=getLeapHandsData();return convertObjectToCindyDict(c,
a,new Map)});e("getleapgesturedata",0,function(a,c){a=new Set(["frame"]);c=getLeapGestureData();return convertObjectToCindyDict(c,a,new Map)});e("getleapmotionmodelmatrix",0,function(a,c){a=getLeapMotionModelMatrix();return nestedArrayToCSList([[a[0],a[1],a[2],a[3]],[a[4],a[5],a[6],a[7]],[a[8],a[9],a[10],a[11]],[a[12],a[13],a[14],a[15]]])});e("getleapmotionrotationmatrix",0,function(a,c){a=getLeapMotionModelMatrix();return nestedArrayToCSList([[a[0],a[1],a[2]],[a[4],a[5],a[6]],[a[8],a[9],a[10]]])});
e("getleapmotiontranslationvector",0,function(a,c){a=getLeapMotionModelMatrix();return nestedArrayToCSList([a[3]+1E-6,a[7],a[11]])});e("getleapmotiontransformhaschanged",0,function(a,c){return{ctype:"boolean",value:getLeapMotionTransformHasChanged()}})};CindyLeap.leapPreRender=leapPreRender;CindyLeap.leapPostRender=leapPostRender;CindyJS.registerPlugin(1,"CindyLeap",CindyLeap);var modelMatrixTmp,mvMatrixTmp,leapMotionModelMatrixInternal=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],leapMotionRotationMatrixInternal=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],leapMotionTransformHasChanged=!1,leapMotionRotationFactor=2,leapMotionTranslationFactor=1,lastLeapFrame=null,manipulateSceneTransformActive=!1,gesturesEnabled=!1;
function leapPreRender(a){if(manipulateSceneTransformActive){modelMatrixTmp=a.modelMatrix.slice();mvMatrixTmp=a.mvMatrix.slice();var c=getLeapMotionModelMatrix();a.modelMatrix=mul4mm(c,a.modelMatrix);a.mvMatrix=mul4mm(a.viewMatrix,a.modelMatrix)}}function leapPostRender(a){manipulateSceneTransformActive&&(a.modelMatrix=modelMatrixTmp.slice(),a.mvMatrix=mvMatrixTmp.slice())}
function initLeapMotion(a,c){gesturesEnabled=c;var k=new Leap.Controller({enableGestures:c});k.on("frame",function(c){onLeapMotionControllerFrame(a,k,c)});k.connect()}
function onLeapMotionControllerFrame(a,c,k){if(0<k.hands.length){lastLeapFrame=k;var m=k.hands[0];c=c.frame(1);m.rotationMatrix(c);k=k.interactionBox.normalizePoint(m.palmPosition,!0);c=m.palmNormal;var e=m.direction;c=[c[1]*e[2]-c[2]*e[1],c[2]*e[0]-c[0]*e[2],c[0]*e[1]-c[1]*e[0]];leapMotionRotationMatrixInternal=[c[0],c[1],c[2],0,m.palmNormal[0],m.palmNormal[1],m.palmNormal[2],0,m.direction[0],m.direction[1],m.direction[2],0,0,0,0,1];leapMotionRotationMatrixInternal=transpose4(mul4mm([1,0,0,0,0,-1,
0,0,0,0,-1,0,0,0,0,1],leapMotionRotationMatrixInternal));2==leapMotionRotationFactor?leapMotionRotationMatrixInternal=mul4mm(leapMotionRotationMatrixInternal,leapMotionRotationMatrixInternal):1!=leapMotionRotationFactor&&(m=axisAngleFromRotationMatrix(leapMotionRotationMatrixInternal),leapMotionRotationMatrixInternal=rotationMatrixFromAxisAngle(m[0],leapMotionRotationFactor*m[1]));leapMotionModelMatrixInternal=leapMotionRotationMatrixInternal.slice();leapMotionModelMatrixInternal[3]=leapMotionTranslationFactor*
(2*k[0]-1);leapMotionModelMatrixInternal[7]=leapMotionTranslationFactor*(2*k[1]-1);leapMotionModelMatrixInternal[11]=leapMotionTranslationFactor*(2*k[2]-1);leapMotionTransformHasChanged=!0;a.scheduleUpdate()}}function setManipulateSceneTransformActive(a){manipulateSceneTransformActive=a}function getLeapHandsData(){return null!=lastLeapFrame?lastLeapFrame.hands:[]}function getLeapGestureData(){return null!=lastLeapFrame&&gesturesEnabled?lastLeapFrame.gestures:[]}
function leapNormalizePosition(a){return null!=lastLeapFrame?(a=lastLeapFrame.interactionBox.normalizePoint(a,!0),[leapMotionTranslationFactor*(2*a[0]-1),leapMotionTranslationFactor*(2*a[1]-1),leapMotionTranslationFactor*(2*a[2]-1)]):a}function rotationMatrixFromAxisAngle(a,c){var k=Math.sin(c);c=Math.cos(c);var m=1-c;return[c+a[0]*a[0]*m,a[0]*a[1]*m-a[2]*k,a[0]*a[2]*m+a[1]*k,0,a[1]*a[0]*m+a[2]*k,c+a[1]*a[1]*m,a[1]*a[2]*m-a[0]*k,0,a[2]*a[0]*m-a[1]*k,a[2]*a[1]*m+a[0]*k,c+a[2]*a[2]*m,0,0,0,0,1]}
function axisAngleFromRotationMatrix(a){var c=function(a){return a*a};if(.001>Math.abs(a[1]-a[4])&&.001>Math.abs(a[2]-a[8])&&.001>Math.abs(a[6]-a[9])){if(.001>Math.abs(a[1]+a[4])&&.01>Math.abs(a[2]+a[8])&&.01>Math.abs(a[6]+a[9])&&.01>Math.abs(a[0]+a[5]+a[10]-3))return[[1,0,0],0];c=(a[0]+1)/2;var k=(a[5]+1)/2,m=(a[10]+1)/2,e=(a[1]+a[4])/4,l=(a[2]+a[8])/4;a=(a[6]+a[9])/4;var n=1/Math.sqrt(2);c>k&&c>m?.001>c?(x=0,z=y=n):(x=Math.sqrt(c),y=e/x,z=l/x):k>m?.001>k?(x=n,y=0,z=n):(y=Math.sqrt(k),x=e/y,z=a/
y):.001>m?(y=x=n,z=0):(z=Math.sqrt(m),x=l/z,y=a/z);return[[0,0,0],Math.PI]}c=Math.sqrt(c(a[9]-a[6])+c(a[2]-a[8])+c(a[4]-a[1]));return[[(a[9]-a[6])/c,(a[2]-a[8])/c,(a[4]-a[1])/c],Math.acos((a[0]+a[5]+a[10]-1)/2)]}function getLeapMotionModelMatrix(){return leapMotionModelMatrixInternal}function getLeapMotionTransformHasChanged(){return leapMotionTransformHasChanged?(leapMotionTransformHasChanged=!1,!0):!1}function setLeapMotionRotationFactor(a){leapMotionRotationFactor=a}
function setLeapMotionTranslationFactor(a){leapMotionTranslationFactor=a};/*
 LeapJS v0.6.4                                                  
 http://github.com/leapmotion/leapjs/                                        

 Copyright 2013 LeapMotion, Inc. and other contributors                      
 Released under the Apache-2.0 license                                     
 http://github.com/leapmotion/leapjs/blob/master/LICENSE.txt                 
*/
(function(a,c,k){function m(l,k){if(!c[l]){if(!a[l]){var n="function"==typeof require&&require;if(!k&&n)return n(l,!0);if(e)return e(l,!0);throw Error("Cannot find module '"+l+"'");}k=c[l]={exports:{}};a[l][0].call(k.exports,function(c){var e=a[l][1][c];return m(e?e:c)},k,k.exports)}return c[l].exports}for(var e="function"==typeof require&&require,l=0;l<k.length;l++)m(k[l]);return m})({1:[function(a,c,k){a("./pointable");k=a("gl-matrix");var m=k.vec3,e=k.mat3,l=k.mat4;a("underscore");a=c.exports=
function(a,c){this.finger=a;this._matrix=this._center=null;this.type=c.type;this.prevJoint=c.prevJoint;this.nextJoint=c.nextJoint;this.width=c.width;a=Array(3);m.sub(a,c.nextJoint,c.prevJoint);this.length=m.length(a);this.basis=c.basis};a.prototype.left=function(){return this._left?this._left:this._left=0>e.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))};a.prototype.matrix=function(){if(this._matrix)return this._matrix;var a=this.basis,c=this._matrix=l.create();c[0]=a[0][0];
c[1]=a[0][1];c[2]=a[0][2];c[4]=a[1][0];c[5]=a[1][1];c[6]=a[1][2];c[8]=a[2][0];c[9]=a[2][1];c[10]=a[2][2];c[3]=this.center()[0];c[7]=this.center()[1];c[11]=this.center()[2];this.left()&&(c[0]*=-1,c[1]*=-1,c[2]*=-1);return this._matrix};a.prototype.lerp=function(a,c){m.lerp(a,this.prevJoint,this.nextJoint,c)};a.prototype.center=function(){if(this._center)return this._center;var a=m.create();this.lerp(a,.5);return this._center=a};a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],
-1*this.basis[2][2]]}},{"./pointable":14,"gl-matrix":23,underscore:24}],2:[function(a,c,k){a=c.exports=function(a){this.pos=0;this._buf=[];this.size=a};a.prototype.get=function(a){void 0==a&&(a=0);if(!(a>=this.size||a>=this._buf.length))return this._buf[(this.pos-a-1)%this.size]};a.prototype.push=function(a){this._buf[this.pos%this.size]=a;return this.pos++}},{}],3:[function(a,c,k){var m=a("../protocol").chooseProtocol;k=a("events").EventEmitter;var e=a("underscore"),l=c.exports=function(a){this.opts=
e.defaults(a||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:l.defaultProtocolVersion});this.host=this.opts.host;this.port=this.opts.port;this.scheme=this.opts.scheme;this.protocolVersionVerified=!1;this.optimizeHMD=this.background=null;this.on("ready",function(){this.enableGestures(this.opts.enableGestures);this.setBackground(this.opts.background);this.setOptimizeHMD(this.opts.optimizeHMD);this.opts.optimizeHMD?
console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};l.defaultProtocolVersion=6;l.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"};l.prototype.getScheme=function(){return"ws:"};l.prototype.getPort=function(){return 6437};l.prototype.setBackground=function(a){this.opts.background=a;this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=
this.opts.background,this.protocol.sendBackground(this,this.opts.background))};l.prototype.setOptimizeHMD=function(a){this.opts.optimizeHMD=a;this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))};l.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))};l.prototype.enableGestures=function(a){this.gesturesEnabled=a?!0:!1;this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))};
l.prototype.handleClose=function(a,c){this.connected&&(this.disconnect(),1001===a&&1<this.opts.requestProtocolVersion&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())};l.prototype.startReconnection=function(){var a=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){a.reconnect()},500))};l.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)};l.prototype.disconnect=
function(a){a||this.stopReconnection();if(this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0};l.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())};l.prototype.handleData=function(a){a=JSON.parse(a);void 0===this.protocol?(a=this.protocol=m(a),this.protocolVersionVerified=!0,this.emit("ready")):
a=this.protocol(a);this.emit(a.type,a)};l.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0};l.prototype.send=function(a){this.socket.send(a)};l.prototype.reportFocus=function(a){this.connected&&this.focusedState!==a&&(this.focusedState=a,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))};e.extend(l.prototype,k.prototype)},{"../protocol":15,events:21,underscore:24}],4:[function(a,
c,k){var m=c.exports=a("./base");a=a("underscore");c=c.exports=function(a){m.call(this,a);var c=this;this.on("ready",function(){c.startFocusLoop()});this.on("disconnect",function(){c.stopFocusLoop()})};a.extend(c.prototype,m.prototype);c.__proto__=m;c.prototype.useSecure=function(){return"https:"===location.protocol};c.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"};c.prototype.getPort=function(){return this.useSecure()?6436:6437};c.prototype.setupSocket=function(){var a=this,
c=new WebSocket(this.getUrl());c.onopen=function(){a.handleOpen()};c.onclose=function(c){a.handleClose(c.code,c.reason)};c.onmessage=function(c){a.handleData(c.data)};c.onerror=function(c){a.useSecure()&&"wss:"===a.scheme?(a.scheme="ws:",a.port=6437,a.disconnect(),a.connect()):confirm("Leap Motion controller driver (V2) not found. Please download the driver from the following website and check that the port 6437 is open.")&&(window.location.href="https://developer.leapmotion.com/sdk/v2")};return c};
c.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var a=this,c=null;c="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0;void 0===a.windowVisible&&(a.windowVisible=void 0===c?!0:!1===document[c]);var m=window.addEventListener("focus",function(c){a.windowVisible=!0;u()}),k=window.addEventListener("blur",function(c){a.windowVisible=
!1;u()});this.on("disconnect",function(){window.removeEventListener("focus",m);window.removeEventListener("blur",k)});var u=function(){a.reportFocus((void 0===c?!0:!1===document[c])&&a.windowVisible)};u();this.focusDetectorTimer=setInterval(u,100)}};c.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":3,underscore:24}],5:[function(a,c,k){var m=a("__browserify_process"),e=a("./frame"),l=a("./hand"),n=a("./pointable"),
v=a("./finger"),u=a("./circular_buffer"),B=a("./pipeline");k=a("events").EventEmitter;var w=a("./gesture").gestureListener,p=a("./dialog"),q=a("underscore"),r=c.exports=function(c){var l=this;c=q.defaults(c||{},{inNode:"undefined"!==typeof m&&m.versions&&m.versions.node});this.inNode=c.inNode;c=q.defaults(c||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0});this.animationFrameRequested=
!1;this.onAnimationFrame=function(a){l.lastConnectionFrame.valid&&l.emit("animationFrame",l.lastConnectionFrame);l.emit("frameEnd",a);l.loopWhileDisconnected&&(!1!==l.connection.focusedState||l.connection.opts.background)?window.requestAnimationFrame(l.onAnimationFrame):l.animationFrameRequested=!1};this.suppressAnimationLoop=c.suppressAnimationLoop;this.loopWhileDisconnected=c.loopWhileDisconnected;this.frameEventName=c.frameEventName;this.useAllPlugins=c.useAllPlugins;this.history=new u(200);this.lastConnectionFrame=
this.lastValidFrame=this.lastFrame=e.Invalid;this.accumulatedGestures=[];this.checkVersion=c.checkVersion;this.connectionType=void 0===c.connectionType?this.inBrowser()?a("./connection/browser"):a("./connection/node"):c.connectionType;this.connection=new this.connectionType(c);this.streamingCount=0;this.devices={};this.plugins={};this._pluginPipelineSteps={};this._pluginExtendedMethods={};c.useAllPlugins&&this.useRegisteredPlugins();this.setupFrameEvents(c);this.setupConnectionEvents();this.startAnimationLoop()};
r.prototype.gesture=function(a,c){a=w(this,a);void 0!==c&&a.stop(c);return a};r.prototype.setBackground=function(a){this.connection.setBackground(a);return this};r.prototype.setOptimizeHMD=function(a){this.connection.setOptimizeHMD(a);return this};r.prototype.inBrowser=function(){return!this.inNode};r.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()};r.prototype.inBackgroundPage=function(){return"undefined"!==typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&
chrome.extension.getBackgroundPage()===window};r.prototype.connect=function(){this.connection.connect();return this};r.prototype.streaming=function(){return 0<this.streamingCount};r.prototype.connected=function(){return!!this.connection.connected};r.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))};r.prototype.disconnect=function(){this.connection.disconnect();return this};
r.prototype.frame=function(a){return this.history.get(a)||e.Invalid};r.prototype.loop=function(a){if(a)if("function"===typeof a)this.on(this.frameEventName,a);else this.setupFrameEvents(a);return this.connect()};r.prototype.addStep=function(a){this.pipeline||(this.pipeline=new B(this));this.pipeline.addStep(a)};r.prototype.processFrame=function(a){a.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(a.gestures));this.lastConnectionFrame=a;this.startAnimationLoop();this.emit("deviceFrame",
a)};r.prototype.processFinishedFrame=function(a){this.lastFrame=a;a.valid&&(this.lastValidFrame=a);a.controller=this;a.historyIdx=this.history.push(a);if(a.gestures){a.gestures=this.accumulatedGestures;this.accumulatedGestures=[];for(var c=0;c!=a.gestures.length;c++)this.emit("gesture",a.gestures[c],a)}this.pipeline&&(a=this.pipeline.run(a),a||(a=e.Invalid));this.emit("frame",a);this.emitHandEvents(a)};r.prototype.emitHandEvents=function(a){for(var c=0;c<a.hands.length;c++)this.emit("hand",a.hands[c])};
r.prototype.setupFrameEvents=function(a){if(a.frame)this.on("frame",a.frame);if(a.hand)this.on("hand",a.hand)};r.prototype.setupConnectionEvents=function(){var a=this;this.connection.on("frame",function(b){a.processFrame(b)});this.on(this.frameEventName,function(b){a.processFinishedFrame(b)});var c=function(){if(5>a.connection.opts.requestProtocolVersion&&0==a.streamingCount){a.streamingCount=1;var b={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};a.devices[b.id]=b;a.emit("deviceAttached",
b);a.emit("deviceStreaming",b);a.emit("streamingStarted",b);a.connection.removeListener("frame",c)}},e=function(){if(0<a.streamingCount){for(var b in a.devices)a.emit("deviceStopped",a.devices[b]),a.emit("deviceRemoved",a.devices[b]);a.emit("streamingStopped",a.devices[b]);a.streamingCount=0;for(b in a.devices)delete a.devices[b]}};this.connection.on("focus",function(){a.loopWhileDisconnected&&a.startAnimationLoop();a.emit("focus")});this.connection.on("blur",function(){a.emit("blur")});this.connection.on("protocol",
function(b){b.on("beforeFrameCreated",function(b){a.emit("beforeFrameCreated",b)});b.on("afterFrameCreated",function(b,c){a.emit("afterFrameCreated",b,c)});a.emit("protocol",b)});this.connection.on("ready",function(){a.checkVersion&&!a.inNode&&a.checkOutOfDate();a.emit("ready")});this.connection.on("connect",function(){a.emit("connect");a.connection.removeListener("frame",c);a.connection.on("frame",c)});this.connection.on("disconnect",function(){a.emit("disconnect");e()});this.connection.on("deviceConnect",
function(b){b.state?(a.emit("deviceConnected"),a.connection.removeListener("frame",c),a.connection.on("frame",c)):(a.emit("deviceDisconnected"),e())});this.connection.on("deviceEvent",function(b){b=b.state;var d=a.devices[b.id],c={},e;for(e in b)d&&d.hasOwnProperty(e)&&d[e]==b[e]||(c[e]=!0);a.devices[b.id]=b;c.attached&&a.emit(b.attached?"deviceAttached":"deviceRemoved",b);c.streaming&&(b.streaming?(a.streamingCount++,a.emit("deviceStreaming",b),1==a.streamingCount&&a.emit("streamingStarted",b),c.attached||
a.emit("deviceConnected")):c.attached&&b.attached||(a.streamingCount--,a.emit("deviceStopped",b),0==a.streamingCount&&a.emit("streamingStopped",b),a.emit("deviceDisconnected")))});this.on("newListener",function(a,d){"deviceConnected"!=a&&"deviceDisconnected"!=a||console.warn(a+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})};r.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var a=
this.connection.protocol.serviceVersion,c=this.connection.protocol.version,e=this.connectionType.defaultProtocolVersion;return e>c?(console.warn("Your Protocol Version is v"+c+", this app was designed for v"+e),p.warnOutOfDate({sV:a,pV:c}),!0):!1};r._pluginFactories={};r.plugin=function(a,c){this._pluginFactories[a]&&console.warn('Plugin "'+a+'" already registered');return this._pluginFactories[a]=c};r.plugins=function(){return q.keys(this._pluginFactories)};r.prototype.use=function(a,c){var f;var b=
"function"==typeof a?a:r._pluginFactories[a];if(!b)throw"Leap Plugin "+a+" not found.";c||(c={});if(this.plugins[a])return q.extend(this.plugins[a],c),this;this.plugins[a]=c;c=b.call(this,c);for(f in c)if(b=c[f],"function"===typeof b){var d=a,h=f;if(-1!==["beforeFrameCreated","afterFrameCreated"].indexOf(h))this.on(h,b);else this.pipeline||(this.pipeline=new B(this)),this._pluginPipelineSteps[d]||(this._pluginPipelineSteps[d]=[]),this._pluginPipelineSteps[d].push(this.pipeline.addWrappedStep(h,b))}else{d=
a;h=f;this._pluginExtendedMethods[d]||(this._pluginExtendedMethods[d]=[]);switch(h){case "frame":h=e;break;case "hand":h=l;break;case "pointable":h=n;q.extend(v.prototype,b);q.extend(v.Invalid,b);break;case "finger":h=v;break;default:throw d+' specifies invalid object type "'+h+'" for prototypical extension';}q.extend(h.prototype,b);q.extend(h.Invalid,b);this._pluginExtendedMethods[d].push([h,b])}return this};r.prototype.stopUsing=function(a){var c=this._pluginPipelineSteps[a],e=this._pluginExtendedMethods[a],
b;if(this.plugins[a]){if(c)for(b=0;b<c.length;b++)this.pipeline.removeStep(c[b]);if(e)for(b=0;b<e.length;b++){c=e[b][0];var d=e[b][1];for(var h in d)delete c.prototype[h],delete c.Invalid[h]}delete this.plugins[a];return this}};r.prototype.useRegisteredPlugins=function(){for(var a in r._pluginFactories)this.use(a)};q.extend(r.prototype,k.prototype)},{"./circular_buffer":2,"./connection/browser":4,"./connection/node":20,"./dialog":6,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./pipeline":13,
"./pointable":14,__browserify_process:22,events:21,underscore:24}],6:[function(a,c,k){var m=a("__browserify_process"),e=c.exports=function(a,c){this.options=c||{};this.message=a;this.createElement()};e.prototype.createElement=function(){this.element=document.createElement("div");this.element.className="leapjs-dialog";this.element.style.position="fixed";this.element.style.top="8px";this.element.style.left=0;this.element.style.right=0;this.element.style.textAlign="center";this.element.style.zIndex=
1E3;var a=document.createElement("div");this.element.appendChild(a);a.style.className="leapjs-dialog";a.style.display="inline-block";a.style.margin="auto";a.style.padding="8px";a.style.color="#222";a.style.background="#eee";a.style.borderRadius="4px";a.style.border="1px solid #999";a.style.textAlign="left";a.style.cursor="pointer";a.style.whiteSpace="nowrap";a.style.transition="box-shadow 1s linear";a.innerHTML=this.message;this.options.onclick&&a.addEventListener("click",this.options.onclick);this.options.onmouseover&&
a.addEventListener("mouseover",this.options.onmouseover);this.options.onmouseout&&a.addEventListener("mouseout",this.options.onmouseout);this.options.onmousemove&&a.addEventListener("mousemove",this.options.onmousemove)};e.prototype.show=function(){document.body.appendChild(this.element);return this};e.prototype.hide=function(){document.body.removeChild(this.element);return this};e.warnOutOfDate=function(a){a||(a={});var c="http://developer.leapmotion.com?";a.returnTo=window.location.href;for(var l in a)c+=
l+"="+encodeURIComponent(a[l])+"&";var m=new e("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(a){"leapjs-decline-upgrade"!=a.target.id&&(a=window.open(c,
"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1"),window.focus&&a.focus());m.hide();return!0},onmousemove:function(a){a.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow=
"none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444";document.getElementById("leapjs-decline-upgrade").style.boxShadow="none";document.getElementById("leapjs-accept-upgrade").style.color=
"#444";document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}});return m.show()};e.hasWarnedBones=!1;e.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof m&&m.versions&&m.versions.node||this.warnOutOfDate({reason:"bones"}))}},{__browserify_process:22}],7:[function(a,c,k){var m=a("./pointable"),e=a("./bone"),l=a("./dialog");a=a("underscore");c=c.exports=function(a){m.call(this,a);this.dipPosition=
a.dipPosition;this.pipPosition=a.pipPosition;this.mcpPosition=a.mcpPosition;this.carpPosition=a.carpPosition;this.extended=a.extended;this.type=a.type;this.finger=!0;this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition];a.bases?this.addBones(a):l.warnBones()};a.extend(c.prototype,m.prototype);c.prototype.addBones=function(a){this.metacarpal=new e(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:a.bases[0]});
this.proximal=new e(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:a.bases[1]});this.medial=new e(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:a.bases[2]});this.distal=new e(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:a.btipPosition,basis:a.bases[3]});this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]};c.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+
"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};c.Invalid={valid:!1}},{"./bone":1,"./dialog":6,"./pointable":14,underscore:24}],8:[function(a,c,k){var m=a("./hand"),e=a("./pointable"),l=a("./gesture").createGesture;k=a("gl-matrix");var n=k.mat3,v=k.vec3,u=a("./interaction_box"),B=a("./finger"),w=a("underscore");a=c.exports=function(a){this.valid=!0;this.id=a.id;this.timestamp=a.timestamp;this.hands=[];this.handsMap={};this.pointables=[];this.tools=[];this.fingers=[];a.interactionBox&&
(this.interactionBox=new u(a.interactionBox));this.gestures=[];this.pointablesMap={};this._translation=a.t;this._rotation=w.flatten(a.r);this._scaleFactor=a.s;this.data=a;this.type="frame";this.currentFrameRate=a.currentFrameRate;if(a.gestures)for(var c=0,e=a.gestures.length;c!=e;c++)this.gestures.push(l(a.gestures[c]));this.postprocessData(a)};a.prototype.postprocessData=function(a){a||(a=this.data);for(var c=0,l=a.hands.length;c!=l;c++){var k=new m(a.hands[c]);k.frame=this;this.hands.push(k);this.handsMap[k.id]=
k}a.pointables=w.sortBy(a.pointables,function(a){return a.id});c=0;for(l=a.pointables.length;c!=l;c++)k=a.pointables[c],k=k.dipPosition?new B(k):new e(k),k.frame=this,this.addPointable(k)};a.prototype.addPointable=function(a){this.pointables.push(a);this.pointablesMap[a.id]=a;(a.tool?this.tools:this.fingers).push(a);if(void 0!==a.handId&&this.handsMap.hasOwnProperty(a.handId)){var c=this.handsMap[a.handId];c.pointables.push(a);(a.tool?c.tools:c.fingers).push(a);switch(a.type){case 0:c.thumb=a;break;
case 1:c.indexFinger=a;break;case 2:c.middleFinger=a;break;case 3:c.ringFinger=a;break;case 4:c.pinky=a}}};a.prototype.tool=function(a){a=this.pointable(a);return a.tool?a:e.Invalid};a.prototype.pointable=function(a){return this.pointablesMap[a]||e.Invalid};a.prototype.finger=function(a){a=this.pointable(a);return a.tool?e.Invalid:a};a.prototype.hand=function(a){return this.handsMap[a]||m.Invalid};a.prototype.rotationAngle=function(a,c){if(!this.valid||!a.valid)return 0;var e=this.rotationMatrix(a);
e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==c&&(a=this.rotationAxis(a),e*=v.dot(a,v.normalize(v.create(),c)));return e};a.prototype.rotationAxis=function(a){return this.valid&&a.valid?v.normalize(v.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):v.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return n.create();var c=n.transpose(n.create(),this._rotation);return n.multiply(n.create(),a._rotation,
c)};a.prototype.scaleFactor=function(a){return this.valid&&a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){return this.valid&&a.valid?v.subtract(v.create(),this._translation,a._translation):v.create()};a.prototype.toString=function(){var a="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";this.gestures&&(a+=" | Gesture count:("+this.gestures.length+")");return a+" ]"};
a.prototype.dump=function(){var a="Frame Info:<br/>"+this.toString();a+="<br/><br/>Hands:<br/>";for(var c=0,e=this.hands.length;c!=e;c++)a+="  "+this.hands[c].toString()+"<br/>";a+="<br/><br/>Pointables:<br/>";c=0;for(e=this.pointables.length;c!=e;c++)a+="  "+this.pointables[c].toString()+"<br/>";if(this.gestures)for(a+="<br/><br/>Gestures:<br/>",c=0,e=this.gestures.length;c!=e;c++)a+="  "+this.gestures[c].toString()+"<br/>";return a=a+"<br/><br/>Raw JSON:<br/>"+JSON.stringify(this.data)};a.Invalid=
{valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return e.Invalid},finger:function(){return e.Invalid},hand:function(){return m.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return n.create()},rotationAxis:function(){return v.create()},scaleFactor:function(){return 1},translation:function(){return v.create()}}},{"./finger":7,"./gesture":9,"./hand":10,"./interaction_box":12,
"./pointable":14,"gl-matrix":23,underscore:24}],9:[function(a,c,k){var m=a("gl-matrix").vec3;c=a("events").EventEmitter;var e=a("underscore");k.createGesture=function(a){switch(a.type){case "circle":var c=new n(a);break;case "swipe":c=new v(a);break;case "screenTap":c=new u(a);break;case "keyTap":c=new B(a);break;default:throw"unknown gesture type";}c.id=a.id;c.handIds=a.handIds.slice();c.pointableIds=a.pointableIds.slice();c.duration=a.duration;c.state=a.state;c.type=a.type;return c};k.gestureListener=
function(a,c){var m={},k={};a.on("gesture",function(a,f){if(a.type==c){if(("start"==a.state||"stop"==a.state)&&void 0===k[a.id]){var b=new l(a,f);k[a.id]=b;e.each(m,function(a,c){b.on(c,a)})}k[a.id].update(a,f);"stop"==a.state&&delete k[a.id]}});var n={start:function(a){m.start=a;return n},stop:function(a){m.stop=a;return n},complete:function(a){m.stop=a;return n},update:function(a){m.update=a;return n}};return n};var l=k.Gesture=function(a,c){this.gestures=[a];this.frames=[c]};l.prototype.update=
function(a,c){this.lastGesture=a;this.lastFrame=c;this.gestures.push(a);this.frames.push(c);this.emit(a.state,this)};l.prototype.translation=function(){return m.subtract(m.create(),this.lastGesture.startPosition,this.lastGesture.position)};e.extend(l.prototype,c.prototype);var n=function(a){this.center=a.center;this.normal=a.normal;this.progress=a.progress;this.radius=a.radius};n.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var v=function(a){this.startPosition=a.startPosition;
this.position=a.position;this.direction=a.direction;this.speed=a.speed};v.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var u=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};u.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var B=function(a){this.position=a.position;this.direction=a.direction;this.progress=a.progress};B.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+
"]"}},{events:21,"gl-matrix":23,underscore:24}],10:[function(a,c,k){var m=a("./pointable"),e=a("./bone");k=a("gl-matrix");var l=k.mat3,n=k.vec3,v=a("underscore");a=c.exports=function(a){this.id=a.id;this.palmPosition=a.palmPosition;this.direction=a.direction;this.palmVelocity=a.palmVelocity;this.palmNormal=a.palmNormal;this.sphereCenter=a.sphereCenter;this.sphereRadius=a.sphereRadius;this.valid=!0;this.pointables=[];this.fingers=[];this.arm=a.armBasis?new e(this,{type:4,width:a.armWidth,prevJoint:a.elbow,
nextJoint:a.wrist,basis:a.armBasis}):null;this.tools=[];this._translation=a.t;this._rotation=v.flatten(a.r);this._scaleFactor=a.s;this.timeVisible=a.timeVisible;this.stabilizedPalmPosition=a.stabilizedPalmPosition;this.type=a.type;this.grabStrength=a.grabStrength;this.pinchStrength=a.pinchStrength;this.confidence=a.confidence};a.prototype.finger=function(a){return(a=this.frame.finger(a))&&a.handId==this.id?a:m.Invalid};a.prototype.rotationAngle=function(a,c){if(!this.valid||!a.valid||!a.hand(this.id).valid)return 0;
var e=this.rotationMatrix(a);e=Math.acos(.5*(e[0]+e[4]+e[8]-1));e=isNaN(e)?0:e;void 0!==c&&(a=this.rotationAxis(a),e*=n.dot(a,n.normalize(n.create(),c)));return e};a.prototype.rotationAxis=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?n.normalize(n.create(),[this._rotation[7]-a._rotation[5],this._rotation[2]-a._rotation[6],this._rotation[3]-a._rotation[1]]):n.create()};a.prototype.rotationMatrix=function(a){if(!this.valid||!a.valid)return l.create();a=a.hand(this.id);
if(!a.valid)return l.create();var c=l.transpose(l.create(),this._rotation);return l.multiply(l.create(),a._rotation,c)};a.prototype.scaleFactor=function(a){if(!this.valid||!a.valid)return 1;a=a.hand(this.id);return a.valid?Math.exp(this._scaleFactor-a._scaleFactor):1};a.prototype.translation=function(a){if(!this.valid||!a.valid)return n.create();a=a.hand(this.id);return a.valid?[this._translation[0]-a._translation[0],this._translation[1]-a._translation[1],this._translation[2]-a._translation[2]]:n.create()};
a.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "};a.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])};a.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])};a.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])};a.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return m.Invalid},
finger:function(){return m.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return l.create()},rotationAxis:function(){return n.create()},scaleFactor:function(){return 1},translation:function(){return n.create()}}},{"./bone":1,"./pointable":14,"gl-matrix":23,underscore:24}],11:[function(a,c,k){c.exports={Controller:a("./controller"),Frame:a("./frame"),Gesture:a("./gesture"),Hand:a("./hand"),Pointable:a("./pointable"),
Finger:a("./finger"),InteractionBox:a("./interaction_box"),CircularBuffer:a("./circular_buffer"),UI:a("./ui"),JSONProtocol:a("./protocol").JSONProtocol,glMatrix:a("gl-matrix"),mat3:a("gl-matrix").mat3,vec3:a("gl-matrix").vec3,loopController:void 0,version:a("./version.js"),_:a("underscore"),EventEmitter:a("events").EventEmitter,loop:function(a,c){a&&void 0===c&&"[object Function]"==={}.toString.call(a)&&(c=a,a={});this.loopController?a&&this.loopController.setupFrameEvents(a):this.loopController=
new this.Controller(a);this.loopController.loop(c);return this.loopController},plugin:function(a,c){this.Controller.plugin(a,c)}}},{"./circular_buffer":2,"./controller":5,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"./protocol":15,"./ui":16,"./version.js":19,events:21,"gl-matrix":23,underscore:24}],12:[function(a,c,k){var m=a("gl-matrix").vec3;a=c.exports=function(a){this.valid=!0;this.center=a.center;this.size=a.size;this.width=a.size[0];this.height=
a.size[1];this.depth=a.size[2]};a.prototype.denormalizePoint=function(a){return m.fromValues((a[0]-.5)*this.size[0]+this.center[0],(a[1]-.5)*this.size[1]+this.center[1],(a[2]-.5)*this.size[2]+this.center[2])};a.prototype.normalizePoint=function(a,c){a=m.fromValues((a[0]-this.center[0])/this.size[0]+.5,(a[1]-this.center[1])/this.size[1]+.5,(a[2]-this.center[2])/this.size[2]+.5);c&&(a[0]=Math.min(Math.max(a[0],0),1),a[1]=Math.min(Math.max(a[1],0),1),a[2]=Math.min(Math.max(a[2],0),1));return a};a.prototype.toString=
function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"};a.Invalid={valid:!1}},{"gl-matrix":23}],13:[function(a,c,k){a=c.exports=function(a){this.steps=[];this.controller=a};a.prototype.addStep=function(a){this.steps.push(a)};a.prototype.run=function(a){for(var c=this.steps.length,l=0;l!=c&&a;l++)a=this.steps[l](a);return a};a.prototype.removeStep=function(a){a=this.steps.indexOf(a);if(-1===a)throw"Step not found in pipeline";this.steps.splice(a,
1)};a.prototype.addWrappedStep=function(a,c){var e=this.controller,m=function(l){var m;var k="frame"==a?[l]:l[a+"s"]||[];var n=0;for(m=k.length;n<m;n++)c.call(e,k[n]);return l};this.addStep(m);return m}},{}],14:[function(a,c,k){a("gl-matrix");a=c.exports=function(a){this.valid=!0;this.id=a.id;this.handId=a.handId;this.length=a.length;this.tool=a.tool;this.width=a.width;this.direction=a.direction;this.stabilizedTipPosition=a.stabilizedTipPosition;this.tipPosition=a.tipPosition;this.tipVelocity=a.tipVelocity;
this.touchZone=a.touchZone;this.touchDistance=a.touchDistance;this.timeVisible=a.timeVisible};a.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};a.prototype.hand=function(){return this.frame.hand(this.handId)};a.Invalid={valid:!1}},{"gl-matrix":23}],15:[function(a,c,k){var m=a("./frame");a("./hand");a("./pointable");a("./finger");var e=a("underscore"),l=a("events").EventEmitter,n=function(a){this.type=a.type;
this.state=a.state};k.chooseProtocol=function(a){switch(a.version){case 1:case 2:case 3:case 4:case 5:case 6:var c=v(a);c.sendBackground=function(a,e){a.send(c.encode({background:e}))};c.sendFocused=function(a,e){a.send(c.encode({focused:e}))};c.sendOptimizeHMD=function(a,e){a.send(c.encode({optimizeHMD:e}))};break;default:throw"unrecognized version";}return c};var v=k.JSONProtocol=function(a){var c=function(a){if(a.event)return new n(a.event);c.emit("beforeFrameCreated",a);var e=new m(a);c.emit("afterFrameCreated",
e,a);return e};c.encode=function(a){return JSON.stringify(a)};c.version=a.version;c.serviceVersion=a.serviceVersion;c.versionLong="Version "+a.version;c.type="protocol";e.extend(c,l.prototype);return c}},{"./finger":7,"./frame":8,"./hand":10,"./pointable":14,events:21,underscore:24}],16:[function(a,c,k){k.UI={Region:a("./ui/region"),Cursor:a("./ui/cursor")}},{"./ui/cursor":17,"./ui/region":18}],17:[function(a,c,k){c.exports=function(){return function(a){var c=a.pointables.sort(function(a,c){return a.z-
c.z})[0];c&&c.valid&&(a.cursorPosition=c.tipPosition);return a}}},{}],18:[function(a,c,k){k=a("events").EventEmitter;a=a("underscore");var m=c.exports=function(a,c){this.start=new Vector(a);this.end=new Vector(c);this.enteredFrame=null};m.prototype.hasPointables=function(a){for(var c=0;c!=a.pointables.length;c++){var e=a.pointables[c].tipPosition;if(e.x>=this.start.x&&e.x<=this.end.x&&e.y>=this.start.y&&e.y<=this.end.y&&e.z>=this.start.z&&e.z<=this.end.z)return!0}return!1};m.prototype.listener=function(a){var c=
this;a&&a.nearThreshold&&this.setupNearRegion(a.nearThreshold);return function(a){return c.updatePosition(a)}};m.prototype.clipper=function(){var a=this;return function(c){a.updatePosition(c);return a.enteredFrame?c:null}};m.prototype.setupNearRegion=function(a){a=this.nearRegion=new m([this.start.x-a,this.start.y-a,this.start.z-a],[this.end.x+a,this.end.y+a,this.end.z+a]);var c=this;a.on("enter",function(a){c.emit("near",a)});a.on("exit",function(a){c.emit("far",a)});c.on("exit",function(a){c.emit("near",
a)})};m.prototype.updatePosition=function(a){this.nearRegion&&this.nearRegion.updatePosition(a);this.hasPointables(a)&&null==this.enteredFrame?(this.enteredFrame=a,this.emit("enter",this.enteredFrame)):this.hasPointables(a)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame));return a};m.prototype.normalize=function(a){return new Vector([(a.x-this.start.x)/(this.end.x-this.start.x),(a.y-this.start.y)/(this.end.y-this.start.y),(a.z-this.start.z)/(this.end.z-this.start.z)])};
m.prototype.mapToXY=function(a,c,k){a=this.normalize(a);var e=a.x,l=a.y;1<e?e=1:-1>e&&(e=-1);1<l?l=1:-1>l&&(l=-1);return[(e+1)/2*c,(1-l)/2*k,a.z]};a.extend(m.prototype,k.prototype)},{events:21,underscore:24}],19:[function(a,c,k){c.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],20:[function(a,c,k){},{}],21:[function(a,c,k){a=a("__browserify_process");a.EventEmitter||(a.EventEmitter=function(){});k=k.EventEmitter=a.EventEmitter;var m="function"===typeof Array.isArray?Array.isArray:function(a){return"[object Array]"===
Object.prototype.toString.call(a)};k.prototype.setMaxListeners=function(a){this._events||(this._events={});this._events.maxListeners=a};k.prototype.emit=function(a){if("error"===a&&(!this._events||!this._events.error||m(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}if(!this._events)return!1;var c=this._events[a];if(!c)return!1;if("function"==typeof c){switch(arguments.length){case 1:c.call(this);
break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:var e=Array.prototype.slice.call(arguments,1);c.apply(this,e)}return!0}if(m(c)){e=Array.prototype.slice.call(arguments,1);c=c.slice();for(var k=0,u=c.length;k<u;k++)c[k].apply(this,e);return!0}return!1};k.prototype.addListener=function(a,c){if("function"!==typeof c)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",a,c);if(this._events[a])if(m(this._events[a])){if(!this._events[a].warned){var e;
(e=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&0<e&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}this._events[a].push(c)}else this._events[a]=[this._events[a],c];else this._events[a]=c;return this};k.prototype.on=k.prototype.addListener;k.prototype.once=function(a,c){var e=this;e.on(a,
function u(){e.removeListener(a,u);c.apply(this,arguments)});return this};k.prototype.removeListener=function(a,c){if("function"!==typeof c)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var e=this._events[a];if(m(e)){a:if(e.indexOf)c=e.indexOf(c);else{for(var l=0;l<e.length;l++)if(c===e[l]){c=l;break a}c=-1}if(0>c)return this;e.splice(c,1);0==e.length&&delete this._events[a]}else this._events[a]===c&&delete this._events[a];return this};
k.prototype.removeAllListeners=function(a){if(0===arguments.length)return this._events={},this;a&&this._events&&this._events[a]&&(this._events[a]=null);return this};k.prototype.listeners=function(a){this._events||(this._events={});this._events[a]||(this._events[a]=[]);m(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]};k.listenerCount=function(a,c){return a._events&&a._events[c]?"function"===typeof a._events[c]?1:a._events[c].length:0}},{__browserify_process:22}],22:[function(a,
c,k){a=c.exports={};a.nextTick=function(){if("undefined"!==typeof window&&window.setImmediate)return function(a){return window.setImmediate(a)};if("undefined"!==typeof window&&window.postMessage&&window.addEventListener){var a=[];window.addEventListener("message",function(c){var e=c.source;e!==window&&null!==e||"process-tick"!==c.data||(c.stopPropagation(),0<a.length&&a.shift()())},!0);return function(c){a.push(c);window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}();a.title=
"browser";a.browser=!0;a.env={};a.argv=[];a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");}},{}],23:[function(a,c,k){(function(a){if("undefined"===typeof k)if("function"==typeof define&&"object"==typeof define.amd&&define.amd){var c={};define(function(){return c})}else c="undefined"!==typeof window?window:a;else c=k;(function(a){if(!c)var c=1E-6;if(!e)var e="undefined"!==typeof Float32Array?
Float32Array:Array;if(!k)var k=Math.random;var l={setMatrixArrayType:function(a){e=a}};"undefined"!==typeof a&&(a.glMatrix=l);var m=Math.PI/180;l.toRadian=function(a){return a*m};var p={create:function(){var a=new e(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new e(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,d){var b=new e(2);b[0]=a;b[1]=d;return b},copy:function(a,d){a[0]=d[0];a[1]=d[1];return a},set:function(a,d,c){a[0]=d;a[1]=c;return a},add:function(a,d,c){a[0]=d[0]+c[0];a[1]=
d[1]+c[1];return a},subtract:function(a,d,c){a[0]=d[0]-c[0];a[1]=d[1]-c[1];return a}};p.sub=p.subtract;p.multiply=function(a,d,c){a[0]=d[0]*c[0];a[1]=d[1]*c[1];return a};p.mul=p.multiply;p.divide=function(a,d,c){a[0]=d[0]/c[0];a[1]=d[1]/c[1];return a};p.div=p.divide;p.min=function(a,d,c){a[0]=Math.min(d[0],c[0]);a[1]=Math.min(d[1],c[1]);return a};p.max=function(a,d,c){a[0]=Math.max(d[0],c[0]);a[1]=Math.max(d[1],c[1]);return a};p.scale=function(a,d,c){a[0]=d[0]*c;a[1]=d[1]*c;return a};p.scaleAndAdd=
function(a,d,c,e){a[0]=d[0]+c[0]*e;a[1]=d[1]+c[1]*e;return a};p.distance=function(a,d){var b=d[0]-a[0];a=d[1]-a[1];return Math.sqrt(b*b+a*a)};p.dist=p.distance;p.squaredDistance=function(a,d){var b=d[0]-a[0];a=d[1]-a[1];return b*b+a*a};p.sqrDist=p.squaredDistance;p.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};p.len=p.length;p.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};p.sqrLen=p.squaredLength;p.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];return a};p.normalize=function(a,
d){var b=d[0],c=d[1];b=b*b+c*c;0<b&&(b=1/Math.sqrt(b),a[0]=d[0]*b,a[1]=d[1]*b);return a};p.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]};p.cross=function(a,d,c){d=d[0]*c[1]-d[1]*c[0];a[0]=a[1]=0;a[2]=d;return a};p.lerp=function(a,d,c,e){var b=d[0];d=d[1];a[0]=b+e*(c[0]-b);a[1]=d+e*(c[1]-d);return a};p.random=function(a,d){d=d||1;var b=2*k()*Math.PI;a[0]=Math.cos(b)*d;a[1]=Math.sin(b)*d;return a};p.transformMat2=function(a,d,c){var b=d[0];d=d[1];a[0]=c[0]*b+c[2]*d;a[1]=c[1]*b+c[3]*d;return a};p.transformMat2d=
function(a,d,c){var b=d[0];d=d[1];a[0]=c[0]*b+c[2]*d+c[4];a[1]=c[1]*b+c[3]*d+c[5];return a};p.transformMat3=function(a,d,c){var b=d[0];d=d[1];a[0]=c[0]*b+c[3]*d+c[6];a[1]=c[1]*b+c[4]*d+c[7];return a};p.transformMat4=function(a,d,c){var b=d[0];d=d[1];a[0]=c[0]*b+c[4]*d+c[12];a[1]=c[1]*b+c[5]*d+c[13];return a};p.forEach=function(){var a=p.create();return function(b,c,e,f,k,l){c||(c=2);e||(e=0);for(f=f?Math.min(f*c+e,b.length):b.length;e<f;e+=c)a[0]=b[e],a[1]=b[e+1],k(a,a,l),b[e]=a[0],b[e+1]=a[1];return b}}();
p.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!==typeof a&&(a.vec2=p);var q={create:function(){var a=new e(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new e(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,d,c){var b=new e(3);b[0]=a;b[1]=d;b[2]=c;return b},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];return a},set:function(a,d,c,e){a[0]=d;a[1]=c;a[2]=e;return a},add:function(a,d,c){a[0]=d[0]+c[0];a[1]=d[1]+c[1];a[2]=d[2]+c[2];return a},subtract:function(a,
d,c){a[0]=d[0]-c[0];a[1]=d[1]-c[1];a[2]=d[2]-c[2];return a}};q.sub=q.subtract;q.multiply=function(a,d,c){a[0]=d[0]*c[0];a[1]=d[1]*c[1];a[2]=d[2]*c[2];return a};q.mul=q.multiply;q.divide=function(a,d,c){a[0]=d[0]/c[0];a[1]=d[1]/c[1];a[2]=d[2]/c[2];return a};q.div=q.divide;q.min=function(a,d,c){a[0]=Math.min(d[0],c[0]);a[1]=Math.min(d[1],c[1]);a[2]=Math.min(d[2],c[2]);return a};q.max=function(a,d,c){a[0]=Math.max(d[0],c[0]);a[1]=Math.max(d[1],c[1]);a[2]=Math.max(d[2],c[2]);return a};q.scale=function(a,
d,c){a[0]=d[0]*c;a[1]=d[1]*c;a[2]=d[2]*c;return a};q.scaleAndAdd=function(a,d,c,e){a[0]=d[0]+c[0]*e;a[1]=d[1]+c[1]*e;a[2]=d[2]+c[2]*e;return a};q.distance=function(a,d){var b=d[0]-a[0],c=d[1]-a[1];a=d[2]-a[2];return Math.sqrt(b*b+c*c+a*a)};q.dist=q.distance;q.squaredDistance=function(a,d){var b=d[0]-a[0],c=d[1]-a[1];a=d[2]-a[2];return b*b+c*c+a*a};q.sqrDist=q.squaredDistance;q.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};q.len=q.length;q.squaredLength=function(a){var b=
a[0],c=a[1];a=a[2];return b*b+c*c+a*a};q.sqrLen=q.squaredLength;q.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];a[2]=-d[2];return a};q.normalize=function(a,d){var b=d[0],c=d[1],e=d[2];b=b*b+c*c+e*e;0<b&&(b=1/Math.sqrt(b),a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b);return a};q.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]};q.cross=function(a,d,c){var b=d[0],h=d[1];d=d[2];var e=c[0],f=c[1];c=c[2];a[0]=h*c-d*f;a[1]=d*e-b*c;a[2]=b*f-h*e;return a};q.lerp=function(a,d,c,e){var b=d[0],h=d[1];d=d[2];a[0]=
b+e*(c[0]-b);a[1]=h+e*(c[1]-h);a[2]=d+e*(c[2]-d);return a};q.random=function(a,d){d=d||1;var b=2*k()*Math.PI,c=2*k()-1,e=Math.sqrt(1-c*c)*d;a[0]=Math.cos(b)*e;a[1]=Math.sin(b)*e;a[2]=c*d;return a};q.transformMat4=function(a,d,c){var b=d[0],h=d[1];d=d[2];a[0]=c[0]*b+c[4]*h+c[8]*d+c[12];a[1]=c[1]*b+c[5]*h+c[9]*d+c[13];a[2]=c[2]*b+c[6]*h+c[10]*d+c[14];return a};q.transformMat3=function(a,d,c){var b=d[0],h=d[1];d=d[2];a[0]=b*c[0]+h*c[3]+d*c[6];a[1]=b*c[1]+h*c[4]+d*c[7];a[2]=b*c[2]+h*c[5]+d*c[8];return a};
q.transformQuat=function(a,d,c){var b=d[0],h=d[1],e=d[2];d=c[0];var f=c[1],g=c[2];c=c[3];var k=c*b+f*e-g*h,l=c*h+g*b-d*e,m=c*e+d*h-f*b;b=-d*b-f*h-g*e;a[0]=k*c+b*-d+l*-g-m*-f;a[1]=l*c+b*-f+m*-d-k*-g;a[2]=m*c+b*-g+k*-f-l*-d;return a};q.rotateX=function(a,d,c,e){var b=[],h=[];b[0]=d[0]-c[0];b[1]=d[1]-c[1];b[2]=d[2]-c[2];h[0]=b[0];h[1]=b[1]*Math.cos(e)-b[2]*Math.sin(e);h[2]=b[1]*Math.sin(e)+b[2]*Math.cos(e);a[0]=h[0]+c[0];a[1]=h[1]+c[1];a[2]=h[2]+c[2];return a};q.rotateY=function(a,d,c,e){var b=[],h=
[];b[0]=d[0]-c[0];b[1]=d[1]-c[1];b[2]=d[2]-c[2];h[0]=b[2]*Math.sin(e)+b[0]*Math.cos(e);h[1]=b[1];h[2]=b[2]*Math.cos(e)-b[0]*Math.sin(e);a[0]=h[0]+c[0];a[1]=h[1]+c[1];a[2]=h[2]+c[2];return a};q.rotateZ=function(a,d,c,e){var b=[],h=[];b[0]=d[0]-c[0];b[1]=d[1]-c[1];b[2]=d[2]-c[2];h[0]=b[0]*Math.cos(e)-b[1]*Math.sin(e);h[1]=b[0]*Math.sin(e)+b[1]*Math.cos(e);h[2]=b[2];a[0]=h[0]+c[0];a[1]=h[1]+c[1];a[2]=h[2]+c[2];return a};q.forEach=function(){var a=q.create();return function(b,c,e,f,k,l){c||(c=3);e||(e=
0);for(f=f?Math.min(f*c+e,b.length):b.length;e<f;e+=c)a[0]=b[e],a[1]=b[e+1],a[2]=b[e+2],k(a,a,l),b[e]=a[0],b[e+1]=a[1],b[e+2]=a[2];return b}}();q.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==typeof a&&(a.vec3=q);var r={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new e(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,d,c,f){var b=new e(4);b[0]=a;b[1]=d;b[2]=c;b[3]=f;return b},copy:function(a,d){a[0]=
d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];return a},set:function(a,d,c,e,f){a[0]=d;a[1]=c;a[2]=e;a[3]=f;return a},add:function(a,d,c){a[0]=d[0]+c[0];a[1]=d[1]+c[1];a[2]=d[2]+c[2];a[3]=d[3]+c[3];return a},subtract:function(a,d,c){a[0]=d[0]-c[0];a[1]=d[1]-c[1];a[2]=d[2]-c[2];a[3]=d[3]-c[3];return a}};r.sub=r.subtract;r.multiply=function(a,d,c){a[0]=d[0]*c[0];a[1]=d[1]*c[1];a[2]=d[2]*c[2];a[3]=d[3]*c[3];return a};r.mul=r.multiply;r.divide=function(a,d,c){a[0]=d[0]/c[0];a[1]=d[1]/c[1];a[2]=d[2]/c[2];a[3]=d[3]/
c[3];return a};r.div=r.divide;r.min=function(a,d,c){a[0]=Math.min(d[0],c[0]);a[1]=Math.min(d[1],c[1]);a[2]=Math.min(d[2],c[2]);a[3]=Math.min(d[3],c[3]);return a};r.max=function(a,d,c){a[0]=Math.max(d[0],c[0]);a[1]=Math.max(d[1],c[1]);a[2]=Math.max(d[2],c[2]);a[3]=Math.max(d[3],c[3]);return a};r.scale=function(a,d,c){a[0]=d[0]*c;a[1]=d[1]*c;a[2]=d[2]*c;a[3]=d[3]*c;return a};r.scaleAndAdd=function(a,d,c,e){a[0]=d[0]+c[0]*e;a[1]=d[1]+c[1]*e;a[2]=d[2]+c[2]*e;a[3]=d[3]+c[3]*e;return a};r.distance=function(a,
d){var b=d[0]-a[0],c=d[1]-a[1],e=d[2]-a[2];a=d[3]-a[3];return Math.sqrt(b*b+c*c+e*e+a*a)};r.dist=r.distance;r.squaredDistance=function(a,d){var b=d[0]-a[0],c=d[1]-a[1],e=d[2]-a[2];a=d[3]-a[3];return b*b+c*c+e*e+a*a};r.sqrDist=r.squaredDistance;r.length=function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return Math.sqrt(b*b+c*c+e*e+a*a)};r.len=r.length;r.squaredLength=function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return b*b+c*c+e*e+a*a};r.sqrLen=r.squaredLength;r.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];
a[2]=-d[2];a[3]=-d[3];return a};r.normalize=function(a,d){var b=d[0],c=d[1],e=d[2],f=d[3];b=b*b+c*c+e*e+f*f;0<b&&(b=1/Math.sqrt(b),a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b,a[3]=d[3]*b);return a};r.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]+a[3]*d[3]};r.lerp=function(a,d,c,e){var b=d[0],h=d[1],f=d[2];d=d[3];a[0]=b+e*(c[0]-b);a[1]=h+e*(c[1]-h);a[2]=f+e*(c[2]-f);a[3]=d+e*(c[3]-d);return a};r.random=function(a,d){d=d||1;a[0]=k();a[1]=k();a[2]=k();a[3]=k();r.normalize(a,a);r.scale(a,a,d);return a};
r.transformMat4=function(a,d,c){var b=d[0],h=d[1],e=d[2];d=d[3];a[0]=c[0]*b+c[4]*h+c[8]*e+c[12]*d;a[1]=c[1]*b+c[5]*h+c[9]*e+c[13]*d;a[2]=c[2]*b+c[6]*h+c[10]*e+c[14]*d;a[3]=c[3]*b+c[7]*h+c[11]*e+c[15]*d;return a};r.transformQuat=function(a,d,c){var b=d[0],h=d[1],e=d[2];d=c[0];var f=c[1],g=c[2];c=c[3];var k=c*b+f*e-g*h,l=c*h+g*b-d*e,m=c*e+d*h-f*b;b=-d*b-f*h-g*e;a[0]=k*c+b*-d+l*-g-m*-f;a[1]=l*c+b*-f+m*-d-k*-g;a[2]=m*c+b*-g+k*-f-l*-d;return a};r.forEach=function(){var a=r.create();return function(b,c,
e,f,k,l){c||(c=4);e||(e=0);for(f=f?Math.min(f*c+e,b.length):b.length;e<f;e+=c)a[0]=b[e],a[1]=b[e+1],a[2]=b[e+2],a[3]=b[e+3],k(a,a,l),b[e]=a[0],b[e+1]=a[1],b[e+2]=a[2],b[e+3]=a[3];return b}}();r.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=r);l={create:function(){var a=new e(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var b=new e(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];
a[3]=d[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,d){if(a===d){var b=d[1];a[1]=d[2];a[2]=b}else a[0]=d[0],a[1]=d[2],a[2]=d[1],a[3]=d[3];return a},invert:function(a,d){var b=d[0],c=d[1],e=d[2];d=d[3];var f=b*d-e*c;if(!f)return null;f=1/f;a[0]=d*f;a[1]=-c*f;a[2]=-e*f;a[3]=b*f;return a},adjoint:function(a,d){var b=d[0];a[0]=d[3];a[1]=-d[1];a[2]=-d[2];a[3]=b;return a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,d,c){var b=d[0],
h=d[1],e=d[2];d=d[3];var f=c[0],g=c[1],k=c[2];c=c[3];a[0]=b*f+e*g;a[1]=h*f+d*g;a[2]=b*k+e*c;a[3]=h*k+d*c;return a}};l.mul=l.multiply;l.rotate=function(a,d,c){var b=d[0],h=d[1],e=d[2];d=d[3];var f=Math.sin(c);c=Math.cos(c);a[0]=b*c+e*f;a[1]=h*c+d*f;a[2]=b*-f+e*c;a[3]=h*-f+d*c;return a};l.scale=function(a,d,c){var b=d[1],h=d[2],e=d[3],f=c[0];c=c[1];a[0]=d[0]*f;a[1]=b*f;a[2]=h*c;a[3]=e*c;return a};l.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};l.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};l.LDU=function(a,d,c,e){a[2]=e[2]/e[0];c[0]=e[0];c[1]=e[1];c[3]=e[3]-a[2]*c[1];return[a,d,c]};"undefined"!==typeof a&&(a.mat2=l);l={create:function(){var a=new e(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var b=new e(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=
0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,d){var b=d[0],c=d[1],e=d[2],f=d[3],k=d[4];d=d[5];var g=b*f-c*e;if(!g)return null;g=1/g;a[0]=f*g;a[1]=-c*g;a[2]=-e*g;a[3]=b*g;a[4]=(e*d-f*k)*g;a[5]=(c*k-b*d)*g;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,d,c){var b=d[0],h=d[1],e=d[2],f=d[3],g=d[4];d=d[5];var k=c[0],l=c[1],m=c[2],n=c[3],p=c[4];c=c[5];a[0]=b*k+e*l;a[1]=h*k+f*l;a[2]=b*m+e*n;a[3]=h*m+f*n;a[4]=b*p+e*c+g;a[5]=h*p+f*c+d;return a}};l.mul=l.multiply;l.rotate=
function(a,d,c){var b=d[0],h=d[1],e=d[2],f=d[3],g=d[4];d=d[5];var k=Math.sin(c);c=Math.cos(c);a[0]=b*c+e*k;a[1]=h*c+f*k;a[2]=b*-k+e*c;a[3]=h*-k+f*c;a[4]=g;a[5]=d;return a};l.scale=function(a,d,c){var b=d[1],h=d[2],e=d[3],f=d[4],g=d[5],k=c[0];c=c[1];a[0]=d[0]*k;a[1]=b*k;a[2]=h*c;a[3]=e*c;a[4]=f;a[5]=g;return a};l.translate=function(a,d,c){var b=d[0],h=d[1],e=d[2],f=d[3],g=d[4];d=d[5];var k=c[0];c=c[1];a[0]=b;a[1]=h;a[2]=e;a[3]=f;a[4]=b*k+e*c+g;a[5]=h*k+f*c+d;return a};l.str=function(a){return"mat2d("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};l.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!==typeof a&&(a.mat2d=l);var t={create:function(){var a=new e(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[4];a[4]=d[5];a[5]=d[6];a[6]=d[8];a[7]=d[9];a[8]=d[10];return a},clone:function(a){var b=new e(9);
b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];a[6]=d[6];a[7]=d[7];a[8]=d[8];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,d){if(a===d){var b=d[1],c=d[2],e=d[5];a[1]=d[3];a[2]=d[6];a[3]=b;a[5]=d[7];a[6]=c;a[7]=e}else a[0]=d[0],a[1]=d[3],a[2]=d[6],a[3]=d[1],a[4]=d[4],a[5]=d[7],a[6]=d[2],a[7]=
d[5],a[8]=d[8];return a},invert:function(a,d){var b=d[0],c=d[1],e=d[2],f=d[3],k=d[4],g=d[5],l=d[6],m=d[7];d=d[8];var n=d*k-g*m,p=-d*f+g*l,q=m*f-k*l,r=b*n+c*p+e*q;if(!r)return null;r=1/r;a[0]=n*r;a[1]=(-d*c+e*m)*r;a[2]=(g*c-e*k)*r;a[3]=p*r;a[4]=(d*b-e*l)*r;a[5]=(-g*b+e*f)*r;a[6]=q*r;a[7]=(-m*b+c*l)*r;a[8]=(k*b-c*f)*r;return a},adjoint:function(a,d){var b=d[0],c=d[1],e=d[2],f=d[3],k=d[4],g=d[5],l=d[6],m=d[7];d=d[8];a[0]=k*d-g*m;a[1]=e*m-c*d;a[2]=c*g-e*k;a[3]=g*l-f*d;a[4]=b*d-e*l;a[5]=e*f-b*g;a[6]=f*
m-k*l;a[7]=c*l-b*m;a[8]=b*k-c*f;return a},determinant:function(a){var b=a[3],c=a[4],e=a[5],f=a[6],k=a[7],l=a[8];return a[0]*(l*c-e*k)+a[1]*(-l*b+e*f)+a[2]*(k*b-c*f)},multiply:function(a,d,c){var b=d[0],e=d[1],h=d[2],f=d[3],g=d[4],k=d[5],l=d[6],m=d[7];d=d[8];var n=c[0],p=c[1],q=c[2],r=c[3],t=c[4],v=c[5],u=c[6],w=c[7];c=c[8];a[0]=n*b+p*f+q*l;a[1]=n*e+p*g+q*m;a[2]=n*h+p*k+q*d;a[3]=r*b+t*f+v*l;a[4]=r*e+t*g+v*m;a[5]=r*h+t*k+v*d;a[6]=u*b+w*f+c*l;a[7]=u*e+w*g+c*m;a[8]=u*h+w*k+c*d;return a}};t.mul=t.multiply;
t.translate=function(a,d,c){var b=d[0],e=d[1],h=d[2],f=d[3],g=d[4],k=d[5],l=d[6],m=d[7];d=d[8];var n=c[0];c=c[1];a[0]=b;a[1]=e;a[2]=h;a[3]=f;a[4]=g;a[5]=k;a[6]=n*b+c*f+l;a[7]=n*e+c*g+m;a[8]=n*h+c*k+d;return a};t.rotate=function(a,d,c){var b=d[0],e=d[1],h=d[2],f=d[3],g=d[4],k=d[5],l=d[6],m=d[7];d=d[8];var n=Math.sin(c);c=Math.cos(c);a[0]=c*b+n*f;a[1]=c*e+n*g;a[2]=c*h+n*k;a[3]=c*f-n*b;a[4]=c*g-n*e;a[5]=c*k-n*h;a[6]=l;a[7]=m;a[8]=d;return a};t.scale=function(a,d,c){var b=c[0];c=c[1];a[0]=b*d[0];a[1]=
b*d[1];a[2]=b*d[2];a[3]=c*d[3];a[4]=c*d[4];a[5]=c*d[5];a[6]=d[6];a[7]=d[7];a[8]=d[8];return a};t.fromMat2d=function(a,d){a[0]=d[0];a[1]=d[1];a[2]=0;a[3]=d[2];a[4]=d[3];a[5]=0;a[6]=d[4];a[7]=d[5];a[8]=1;return a};t.fromQuat=function(a,d){var b=d[0],c=d[1],e=d[2];d=d[3];var f=b+b,k=c+c,g=e+e;b*=f;var l=c*f;c*=k;var m=e*f,n=e*k;e*=g;f*=d;k*=d;d*=g;a[0]=1-c-e;a[3]=l-d;a[6]=m+k;a[1]=l+d;a[4]=1-b-e;a[7]=n-f;a[2]=m-k;a[5]=n+f;a[8]=1-b-c;return a};t.normalFromMat4=function(a,d){var b=d[0],c=d[1],e=d[2],f=
d[3],k=d[4],g=d[5],l=d[6],m=d[7],n=d[8],p=d[9],q=d[10],r=d[11],t=d[12],v=d[13],u=d[14];d=d[15];var w=b*g-c*k,B=b*l-e*k,A=b*m-f*k,F=c*l-e*g,C=c*m-f*g,H=e*m-f*l,J=n*v-p*t,K=n*u-q*t;n=n*d-r*t;var M=p*u-q*v;p=p*d-r*v;q=q*d-r*u;r=w*q-B*p+A*M+F*n-C*K+H*J;if(!r)return null;r=1/r;a[0]=(g*q-l*p+m*M)*r;a[1]=(l*n-k*q-m*K)*r;a[2]=(k*p-g*n+m*J)*r;a[3]=(e*p-c*q-f*M)*r;a[4]=(b*q-e*n+f*K)*r;a[5]=(c*n-b*p-f*J)*r;a[6]=(v*H-u*C+d*F)*r;a[7]=(u*A-t*H-d*B)*r;a[8]=(t*C-v*A+d*w)*r;return a};t.str=function(a){return"mat3("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};t.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=t);var A={create:function(){var a=new e(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=
new e(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];a[6]=d[6];a[7]=d[7];a[8]=d[8];a[9]=d[9];a[10]=d[10];a[11]=d[11];a[12]=d[12];a[13]=d[13];a[14]=d[14];a[15]=d[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,d){if(a===d){var b=d[1],c=d[2],e=d[3],f=d[6],k=d[7],g=d[11];a[1]=d[4];a[2]=d[8];a[3]=d[12];a[4]=b;a[6]=d[9];a[7]=d[13];a[8]=c;a[9]=f;a[11]=d[14];a[12]=e;a[13]=k;a[14]=g}else a[0]=d[0],a[1]=d[4],a[2]=d[8],a[3]=d[12],a[4]=d[1],a[5]=d[5],a[6]=d[9],a[7]=d[13],a[8]=d[2],a[9]=d[6],a[10]=d[10],a[11]=d[14],a[12]=d[3],a[13]=d[7],a[14]=d[11],a[15]=d[15];return a},invert:function(a,d){var b=d[0],c=d[1],e=d[2],f=d[3],k=d[4],g=d[5],l=d[6],m=d[7],n=d[8],
p=d[9],q=d[10],r=d[11],t=d[12],v=d[13],u=d[14];d=d[15];var w=b*g-c*k,B=b*l-e*k,A=b*m-f*k,F=c*l-e*g,C=c*m-f*g,H=e*m-f*l,J=n*v-p*t,K=n*u-q*t,M=n*d-r*t,O=p*u-q*v,Q=p*d-r*v,I=q*d-r*u,N=w*I-B*Q+A*O+F*M-C*K+H*J;if(!N)return null;N=1/N;a[0]=(g*I-l*Q+m*O)*N;a[1]=(e*Q-c*I-f*O)*N;a[2]=(v*H-u*C+d*F)*N;a[3]=(q*C-p*H-r*F)*N;a[4]=(l*M-k*I-m*K)*N;a[5]=(b*I-e*M+f*K)*N;a[6]=(u*A-t*H-d*B)*N;a[7]=(n*H-q*A+r*B)*N;a[8]=(k*Q-g*M+m*J)*N;a[9]=(c*M-b*Q-f*J)*N;a[10]=(t*C-v*A+d*w)*N;a[11]=(p*A-n*C-r*w)*N;a[12]=(g*K-k*O-l*J)*
N;a[13]=(b*O-c*K+e*J)*N;a[14]=(v*B-t*F-u*w)*N;a[15]=(n*F-p*B+q*w)*N;return a},adjoint:function(a,d){var b=d[0],c=d[1],e=d[2],f=d[3],k=d[4],g=d[5],l=d[6],m=d[7],n=d[8],p=d[9],q=d[10],r=d[11],t=d[12],v=d[13],u=d[14];d=d[15];a[0]=g*(q*d-r*u)-p*(l*d-m*u)+v*(l*r-m*q);a[1]=-(c*(q*d-r*u)-p*(e*d-f*u)+v*(e*r-f*q));a[2]=c*(l*d-m*u)-g*(e*d-f*u)+v*(e*m-f*l);a[3]=-(c*(l*r-m*q)-g*(e*r-f*q)+p*(e*m-f*l));a[4]=-(k*(q*d-r*u)-n*(l*d-m*u)+t*(l*r-m*q));a[5]=b*(q*d-r*u)-n*(e*d-f*u)+t*(e*r-f*q);a[6]=-(b*(l*d-m*u)-k*(e*
d-f*u)+t*(e*m-f*l));a[7]=b*(l*r-m*q)-k*(e*r-f*q)+n*(e*m-f*l);a[8]=k*(p*d-r*v)-n*(g*d-m*v)+t*(g*r-m*p);a[9]=-(b*(p*d-r*v)-n*(c*d-f*v)+t*(c*r-f*p));a[10]=b*(g*d-m*v)-k*(c*d-f*v)+t*(c*m-f*g);a[11]=-(b*(g*r-m*p)-k*(c*r-f*p)+n*(c*m-f*g));a[12]=-(k*(p*u-q*v)-n*(g*u-l*v)+t*(g*q-l*p));a[13]=b*(p*u-q*v)-n*(c*u-e*v)+t*(c*q-e*p);a[14]=-(b*(g*u-l*v)-k*(c*u-e*v)+t*(c*l-e*g));a[15]=b*(g*q-l*p)-k*(c*q-e*p)+n*(c*l-e*g);return a},determinant:function(a){var b=a[0],c=a[1],e=a[2],f=a[3],k=a[4],l=a[5],g=a[6],m=a[7],
n=a[8],p=a[9],q=a[10],r=a[11],t=a[12],u=a[13],v=a[14];a=a[15];return(b*l-c*k)*(q*a-r*v)-(b*g-e*k)*(p*a-r*u)+(b*m-f*k)*(p*v-q*u)+(c*g-e*l)*(n*a-r*t)-(c*m-f*l)*(n*v-q*t)+(e*m-f*g)*(n*u-p*t)},multiply:function(a,d,c){var b=d[0],e=d[1],f=d[2],h=d[3],g=d[4],k=d[5],l=d[6],m=d[7],n=d[8],p=d[9],q=d[10],r=d[11],t=d[12],u=d[13],v=d[14];d=d[15];var w=c[0],B=c[1],A=c[2],C=c[3];a[0]=w*b+B*g+A*n+C*t;a[1]=w*e+B*k+A*p+C*u;a[2]=w*f+B*l+A*q+C*v;a[3]=w*h+B*m+A*r+C*d;w=c[4];B=c[5];A=c[6];C=c[7];a[4]=w*b+B*g+A*n+C*t;
a[5]=w*e+B*k+A*p+C*u;a[6]=w*f+B*l+A*q+C*v;a[7]=w*h+B*m+A*r+C*d;w=c[8];B=c[9];A=c[10];C=c[11];a[8]=w*b+B*g+A*n+C*t;a[9]=w*e+B*k+A*p+C*u;a[10]=w*f+B*l+A*q+C*v;a[11]=w*h+B*m+A*r+C*d;w=c[12];B=c[13];A=c[14];C=c[15];a[12]=w*b+B*g+A*n+C*t;a[13]=w*e+B*k+A*p+C*u;a[14]=w*f+B*l+A*q+C*v;a[15]=w*h+B*m+A*r+C*d;return a}};A.mul=A.multiply;A.translate=function(a,d,c){var b=c[0],e=c[1];c=c[2];if(d===a)a[12]=d[0]*b+d[4]*e+d[8]*c+d[12],a[13]=d[1]*b+d[5]*e+d[9]*c+d[13],a[14]=d[2]*b+d[6]*e+d[10]*c+d[14],a[15]=d[3]*b+
d[7]*e+d[11]*c+d[15];else{var f=d[0];var h=d[1];var g=d[2];var k=d[3];var l=d[4];var m=d[5];var n=d[6];var p=d[7];var q=d[8];var r=d[9];var t=d[10];var u=d[11];a[0]=f;a[1]=h;a[2]=g;a[3]=k;a[4]=l;a[5]=m;a[6]=n;a[7]=p;a[8]=q;a[9]=r;a[10]=t;a[11]=u;a[12]=f*b+l*e+q*c+d[12];a[13]=h*b+m*e+r*c+d[13];a[14]=g*b+n*e+t*c+d[14];a[15]=k*b+p*e+u*c+d[15]}return a};A.scale=function(a,d,c){var b=c[0],e=c[1];c=c[2];a[0]=d[0]*b;a[1]=d[1]*b;a[2]=d[2]*b;a[3]=d[3]*b;a[4]=d[4]*e;a[5]=d[5]*e;a[6]=d[6]*e;a[7]=d[7]*e;a[8]=
d[8]*c;a[9]=d[9]*c;a[10]=d[10]*c;a[11]=d[11]*c;a[12]=d[12];a[13]=d[13];a[14]=d[14];a[15]=d[15];return a};A.rotate=function(a,d,e,f){var b=f[0],h=f[1];f=f[2];var k=Math.sqrt(b*b+h*h+f*f);if(Math.abs(k)<c)return null;k=1/k;b*=k;h*=k;f*=k;var g=Math.sin(e);var l=Math.cos(e);var m=1-l;e=d[0];k=d[1];var n=d[2];var p=d[3];var q=d[4];var r=d[5];var E=d[6];var t=d[7];var u=d[8];var v=d[9];var w=d[10];var B=d[11];var A=b*b*m+l;var C=h*b*m+f*g;var H=f*b*m-h*g;var J=b*h*m-f*g;var K=h*h*m+l;var M=f*h*m+b*g;var O=
b*f*m+h*g;b=h*f*m-b*g;h=f*f*m+l;a[0]=e*A+q*C+u*H;a[1]=k*A+r*C+v*H;a[2]=n*A+E*C+w*H;a[3]=p*A+t*C+B*H;a[4]=e*J+q*K+u*M;a[5]=k*J+r*K+v*M;a[6]=n*J+E*K+w*M;a[7]=p*J+t*K+B*M;a[8]=e*O+q*b+u*h;a[9]=k*O+r*b+v*h;a[10]=n*O+E*b+w*h;a[11]=p*O+t*b+B*h;d!==a&&(a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);return a};A.rotateX=function(a,d,c){var b=Math.sin(c);c=Math.cos(c);var e=d[4],f=d[5],h=d[6],g=d[7],k=d[8],l=d[9],m=d[10],n=d[11];d!==a&&(a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[12]=d[12],a[13]=d[13],a[14]=
d[14],a[15]=d[15]);a[4]=e*c+k*b;a[5]=f*c+l*b;a[6]=h*c+m*b;a[7]=g*c+n*b;a[8]=k*c-e*b;a[9]=l*c-f*b;a[10]=m*c-h*b;a[11]=n*c-g*b;return a};A.rotateY=function(a,d,c){var b=Math.sin(c);c=Math.cos(c);var e=d[0],f=d[1],h=d[2],g=d[3],k=d[8],l=d[9],m=d[10],n=d[11];d!==a&&(a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);a[0]=e*c-k*b;a[1]=f*c-l*b;a[2]=h*c-m*b;a[3]=g*c-n*b;a[8]=e*b+k*c;a[9]=f*b+l*c;a[10]=h*b+m*c;a[11]=g*b+n*c;return a};A.rotateZ=function(a,d,c){var b=Math.sin(c);
c=Math.cos(c);var e=d[0],f=d[1],h=d[2],g=d[3],k=d[4],l=d[5],m=d[6],n=d[7];d!==a&&(a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);a[0]=e*c+k*b;a[1]=f*c+l*b;a[2]=h*c+m*b;a[3]=g*c+n*b;a[4]=k*c-e*b;a[5]=l*c-f*b;a[6]=m*c-h*b;a[7]=n*c-g*b;return a};A.fromRotationTranslation=function(a,d,c){var b=d[0],e=d[1],f=d[2],h=d[3],g=b+b,k=e+e,l=f+f;d=b*g;var m=b*k;b*=l;var n=e*k;e*=l;f*=l;g*=h;k*=h;h*=l;a[0]=1-(n+f);a[1]=m+h;a[2]=b-k;a[3]=0;a[4]=m-h;a[5]=1-(d+f);a[6]=
e+g;a[7]=0;a[8]=b+k;a[9]=e-g;a[10]=1-(d+n);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};A.fromQuat=function(a,d){var b=d[0],c=d[1],e=d[2];d=d[3];var f=b+b,k=c+c,g=e+e;b*=f;var l=c*f;c*=k;var m=e*f,n=e*k;e*=g;f*=d;k*=d;d*=g;a[0]=1-c-e;a[1]=l+d;a[2]=m-k;a[3]=0;a[4]=l-d;a[5]=1-b-e;a[6]=n+f;a[7]=0;a[8]=m+k;a[9]=n-f;a[10]=1-b-c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};A.frustum=function(a,d,c,e,f,k,l){var b=1/(c-d),h=1/(f-e),m=1/(k-l);a[0]=2*k*b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=
2*k*h;a[6]=0;a[7]=0;a[8]=(c+d)*b;a[9]=(f+e)*h;a[10]=(l+k)*m;a[11]=-1;a[12]=0;a[13]=0;a[14]=l*k*2*m;a[15]=0;return a};A.perspective=function(a,d,c,e,f){d=1/Math.tan(d/2);var b=1/(e-f);a[0]=d/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(f+e)*b;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*f*e*b;a[15]=0;return a};A.ortho=function(a,d,c,e,f,k,l){var b=1/(d-c),h=1/(e-f),m=1/(k-l);a[0]=-2*b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*h;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*m;a[11]=0;a[12]=(d+c)*b;a[13]=
(f+e)*h;a[14]=(l+k)*m;a[15]=1;return a};A.lookAt=function(a,d,e,f){var b=d[0],h=d[1];d=d[2];var k=f[0];var g=f[1];var l=f[2];var m=e[0];f=e[1];var n=e[2];if(Math.abs(b-m)<c&&Math.abs(h-f)<c&&Math.abs(d-n)<c)return A.identity(a);e=b-m;f=h-f;m=d-n;var p=1/Math.sqrt(e*e+f*f+m*m);e*=p;f*=p;m*=p;n=g*m-l*f;l=l*e-k*m;k=k*f-g*e;(p=Math.sqrt(n*n+l*l+k*k))?(p=1/p,n*=p,l*=p,k*=p):k=l=n=0;g=f*k-m*l;var q=m*n-e*k;var r=e*l-f*n;(p=Math.sqrt(g*g+q*q+r*r))?(p=1/p,g*=p,q*=p,r*=p):r=q=g=0;a[0]=n;a[1]=g;a[2]=e;a[3]=
0;a[4]=l;a[5]=q;a[6]=f;a[7]=0;a[8]=k;a[9]=r;a[10]=m;a[11]=0;a[12]=-(n*b+l*h+k*d);a[13]=-(g*b+q*h+r*d);a[14]=-(e*b+f*h+m*d);a[15]=1;return a};A.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};A.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],
2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=A);var f={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};f.rotationTo=function(){var a=q.create(),d=q.fromValues(1,0,0),c=q.fromValues(0,1,0);return function(b,e,h){var k=q.dot(e,h);if(-.999999>k)return q.cross(a,d,e),1E-6>q.length(a)&&q.cross(a,c,e),q.normalize(a,a),f.setAxisAngle(b,
a,Math.PI),b;if(.999999<k)return b[0]=0,b[1]=0,b[2]=0,b[3]=1,b;q.cross(a,e,h);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=1+k;return f.normalize(b,b)}}();f.setAxes=function(){var a=t.create();return function(b,c,e,k){a[0]=e[0];a[3]=e[1];a[6]=e[2];a[1]=k[0];a[4]=k[1];a[7]=k[2];a[2]=-c[0];a[5]=-c[1];a[8]=-c[2];return f.normalize(b,f.fromMat3(b,a))}}();f.clone=r.clone;f.fromValues=r.fromValues;f.copy=r.copy;f.set=r.set;f.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};f.setAxisAngle=function(a,d,c){c*=
.5;var b=Math.sin(c);a[0]=b*d[0];a[1]=b*d[1];a[2]=b*d[2];a[3]=Math.cos(c);return a};f.add=r.add;f.multiply=function(a,d,c){var b=d[0],e=d[1],f=d[2];d=d[3];var h=c[0],g=c[1],k=c[2];c=c[3];a[0]=b*c+d*h+e*k-f*g;a[1]=e*c+d*g+f*h-b*k;a[2]=f*c+d*k+b*g-e*h;a[3]=d*c-b*h-e*g-f*k;return a};f.mul=f.multiply;f.scale=r.scale;f.rotateX=function(a,d,c){c*=.5;var b=d[0],e=d[1],f=d[2];d=d[3];var h=Math.sin(c);c=Math.cos(c);a[0]=b*c+d*h;a[1]=e*c+f*h;a[2]=f*c-e*h;a[3]=d*c-b*h;return a};f.rotateY=function(a,d,c){c*=
.5;var b=d[0],e=d[1],f=d[2];d=d[3];var h=Math.sin(c);c=Math.cos(c);a[0]=b*c-f*h;a[1]=e*c+d*h;a[2]=f*c+b*h;a[3]=d*c-e*h;return a};f.rotateZ=function(a,c,e){e*=.5;var b=c[0],d=c[1],f=c[2];c=c[3];var h=Math.sin(e);e=Math.cos(e);a[0]=b*e+d*h;a[1]=d*e-b*h;a[2]=f*e+c*h;a[3]=c*e-f*h;return a};f.calculateW=function(a,c){var b=c[0],d=c[1];c=c[2];a[0]=b;a[1]=d;a[2]=c;a[3]=-Math.sqrt(Math.abs(1-b*b-d*d-c*c));return a};f.dot=r.dot;f.lerp=r.lerp;f.slerp=function(a,c,e,f){var b=c[0],d=c[1],h=c[2];c=c[3];var g=
e[0],k=e[1],l=e[2];e=e[3];var m=b*g+d*k+h*l+c*e;0>m&&(m=-m,g=-g,k=-k,l=-l,e=-e);if(1E-6<1-m){var n=Math.acos(m);var p=Math.sin(n);m=Math.sin((1-f)*n)/p;f=Math.sin(f*n)/p}else m=1-f;a[0]=m*b+f*g;a[1]=m*d+f*k;a[2]=m*h+f*l;a[3]=m*c+f*e;return a};f.invert=function(a,c){var b=c[0],d=c[1],e=c[2];c=c[3];var f=b*b+d*d+e*e+c*c;f=f?1/f:0;a[0]=-b*f;a[1]=-d*f;a[2]=-e*f;a[3]=c*f;return a};f.conjugate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];a[3]=c[3];return a};f.length=r.length;f.len=f.length;f.squaredLength=
r.squaredLength;f.sqrLen=f.squaredLength;f.normalize=r.normalize;f.fromMat3=function(a,c){var b=c[0]+c[4]+c[8];if(0<b)b=Math.sqrt(b+1),a[3]=.5*b,b=.5/b,a[0]=(c[7]-c[5])*b,a[1]=(c[2]-c[6])*b,a[2]=(c[3]-c[1])*b;else{var d=0;c[4]>c[0]&&(d=1);c[8]>c[3*d+d]&&(d=2);var e=(d+1)%3,f=(d+2)%3;b=Math.sqrt(c[3*d+d]-c[3*e+e]-c[3*f+f]+1);a[d]=.5*b;b=.5/b;a[3]=(c[3*f+e]-c[3*e+f])*b;a[e]=(c[3*e+d]+c[3*d+e])*b;a[f]=(c[3*f+d]+c[3*d+f])*b}return a};f.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+
")"};"undefined"!==typeof a&&(a.quat=f)})(c)})(this)},{}],24:[function(a,c,k){(function(){var a=this,e=a._,l={},n=Array.prototype,v=Object.prototype,u=n.push,B=n.slice,w=n.concat,p=v.toString,q=v.hasOwnProperty,r=n.forEach,t=n.map,A=n.reduce,f=n.reduceRight,b=n.filter,d=n.every,h=n.some,E=n.indexOf,D=n.lastIndexOf;v=Array.isArray;var L=Object.keys,S=Function.prototype.bind,g=function(a){if(a instanceof g)return a;if(!(this instanceof g))return new g(a);this._wrapped=a};"undefined"!==typeof k?("undefined"!==
typeof c&&c.exports&&(k=c.exports=g),k._=g):a._=g;g.VERSION="1.4.4";var G=g.each=g.forEach=function(a,b,c){if(null!=a)if(r&&a.forEach===r)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;d<e&&b.call(c,a[d],d,a)!==l;d++);else for(d in a)if(g.has(a,d)&&b.call(c,a[d],d,a)===l)break};g.map=g.collect=function(a,b,c){var d=[];if(null==a)return d;if(t&&a.map===t)return a.map(b,c);G(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)});return d};g.reduce=g.foldl=g.inject=function(a,b,c,d){var e=
2<arguments.length;null==a&&(a=[]);if(A&&a.reduce===A)return d&&(b=g.bind(b,d)),e?a.reduce(b,c):a.reduce(b);G(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};g.reduceRight=g.foldr=function(a,b,c,d){var e=2<arguments.length;null==a&&(a=[]);if(f&&a.reduceRight===f)return d&&(b=g.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var h=a.length;if(h!==+h){var k=g.keys(a);h=k.length}G(a,function(f,g,l){g=k?k[--h]:--h;
e?c=b.call(d,c,a[g],g,l):(c=a[g],e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};g.find=g.detect=function(a,b,c){var d;W(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0});return d};g.filter=g.select=function(a,c,d){var e=[];if(null==a)return e;if(b&&a.filter===b)return a.filter(c,d);G(a,function(a,b,f){c.call(d,a,b,f)&&(e[e.length]=a)});return e};g.reject=function(a,b,c){return g.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)};g.every=g.all=function(a,
b,c){b||(b=g.identity);var e=!0;if(null==a)return e;if(d&&a.every===d)return a.every(b,c);G(a,function(a,d,f){if(!(e=e&&b.call(c,a,d,f)))return l});return!!e};var W=g.some=g.any=function(a,b,c){b||(b=g.identity);var d=!1;if(null==a)return d;if(h&&a.some===h)return a.some(b,c);G(a,function(a,e,f){if(d||(d=b.call(c,a,e,f)))return l});return!!d};g.contains=g.include=function(a,b){return null==a?!1:E&&a.indexOf===E?-1!==a.indexOf(b):W(a,function(a){return a===b})};g.invoke=function(a,b){var c=B.call(arguments,
2),d=g.isFunction(b);return g.map(a,function(a){return(d?b:a[b]).apply(a,c)})};g.pluck=function(a,b){return g.map(a,function(a){return a[b]})};g.where=function(a,b,c){return g.isEmpty(b)?c?null:[]:g[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})};g.findWhere=function(a,b){return g.where(a,b,!0)};g.max=function(a,b,c){if(!b&&g.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&g.isEmpty(a))return-Infinity;var d={computed:-Infinity,value:-Infinity};
G(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e>=d.computed&&(d={value:a,computed:e})});return d.value};g.min=function(a,b,c){if(!b&&g.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&g.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};G(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e<d.computed&&(d={value:a,computed:e})});return d.value};g.shuffle=function(a){var b,c=0,d=[];G(a,function(a){b=g.random(c++);d[c-1]=d[b];d[b]=a});return d};var T=function(a){return g.isFunction(a)?
a:function(b){return b[a]}};g.sortBy=function(a,b,c){var d=T(b);return g.pluck(g.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var X=function(a,b,c,d){var e={},f=T(b||g.identity);G(a,function(b,g){g=f.call(c,b,g,a);d(e,g,b)});return e};g.groupBy=function(a,b,c){return X(a,b,c,function(a,b,c){(g.has(a,b)?a[b]:a[b]=[]).push(c)})};
g.countBy=function(a,b,c){return X(a,b,c,function(a,b){g.has(a,b)||(a[b]=0);a[b]++})};g.sortedIndex=function(a,b,c,d){c=null==c?g.identity:T(c);b=c.call(d,b);for(var e=0,f=a.length;e<f;){var h=e+f>>>1;c.call(d,a[h])<b?e=h+1:f=h}return e};g.toArray=function(a){return a?g.isArray(a)?B.call(a):a.length===+a.length?g.map(a,g.identity):g.values(a):[]};g.size=function(a){return null==a?0:a.length===+a.length?a.length:g.keys(a).length};g.first=g.head=g.take=function(a,b,c){if(null!=a)return null==b||c?a[0]:
B.call(a,0,b)};g.initial=function(a,b,c){return B.call(a,0,a.length-(null==b||c?1:b))};g.last=function(a,b,c){if(null!=a)return null==b||c?a[a.length-1]:B.call(a,Math.max(a.length-b,0))};g.rest=g.tail=g.drop=function(a,b,c){return B.call(a,null==b||c?1:b)};g.compact=function(a){return g.filter(a,g.identity)};var Y=function(a,b,c){G(a,function(a){g.isArray(a)?b?u.apply(c,a):Y(a,b,c):c.push(a)});return c};g.flatten=function(a,b){return Y(a,b,[])};g.without=function(a){return g.difference(a,B.call(arguments,
1))};g.uniq=g.unique=function(a,b,c,d){g.isFunction(b)&&(d=c,c=b,b=!1);c=c?g.map(a,c,d):a;var e=[],f=[];G(c,function(c,d){(b?d&&f[f.length-1]===c:g.contains(f,c))||(f.push(c),e.push(a[d]))});return e};g.union=function(){return g.uniq(w.apply(n,arguments))};g.intersection=function(a){var b=B.call(arguments,1);return g.filter(g.uniq(a),function(a){return g.every(b,function(b){return 0<=g.indexOf(b,a)})})};g.difference=function(a){var b=w.apply(n,B.call(arguments,1));return g.filter(a,function(a){return!g.contains(b,
a)})};g.zip=function(){for(var a=B.call(arguments),b=g.max(g.pluck(a,"length")),c=Array(b),d=0;d<b;d++)c[d]=g.pluck(a,""+d);return c};g.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};g.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,e+c):c;else return d=g.sortedIndex(a,b),a[d]===b?d:-1;if(E&&a.indexOf===E)return a.indexOf(b,c);for(;d<e;d++)if(a[d]===b)return d;return-1};
g.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(D&&a.lastIndexOf===D)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=d?c:a.length;c--;)if(a[c]===b)return c;return-1};g.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=c;return f};g.bind=function(a,b){if(a.bind===S&&S)return S.apply(a,B.call(arguments,1));var c=B.call(arguments,2);return function(){return a.apply(b,c.concat(B.call(arguments)))}};
g.partial=function(a){var b=B.call(arguments,1);return function(){return a.apply(this,b.concat(B.call(arguments)))}};g.bindAll=function(a){var b=B.call(arguments,1);0===b.length&&(b=g.functions(a));G(b,function(b){a[b]=g.bind(a[b],a)});return a};g.memoize=function(a,b){var c={};b||(b=g.identity);return function(){var d=b.apply(this,arguments);return g.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};g.delay=function(a,b){var c=B.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};
g.defer=function(a){return g.delay.apply(g,[a,1].concat(B.call(arguments,1)))};g.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date;e=null;f=a.apply(c,d)};return function(){var k=new Date,l=b-(k-g);c=this;d=arguments;0>=l?(clearTimeout(e),e=null,g=k,f=a.apply(c,d)):e||(e=setTimeout(h,l));return f}};g.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=c&&!d;clearTimeout(d);d=setTimeout(function(){d=null;c||(e=a.apply(f,g))},b);h&&(e=a.apply(f,g));return e}};g.once=
function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};g.wrap=function(a,b){return function(){var c=[a];u.apply(c,arguments);return b.apply(this,c)}};g.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};g.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};g.keys=L||function(a){if(a!==Object(a))throw new TypeError("Invalid object");
var b=[],c;for(c in a)g.has(a,c)&&(b[b.length]=c);return b};g.values=function(a){var b=[],c;for(c in a)g.has(a,c)&&b.push(a[c]);return b};g.pairs=function(a){var b=[],c;for(c in a)g.has(a,c)&&b.push([c,a[c]]);return b};g.invert=function(a){var b={},c;for(c in a)g.has(a,c)&&(b[a[c]]=c);return b};g.functions=g.methods=function(a){var b=[],c;for(c in a)g.isFunction(a[c])&&b.push(c);return b.sort()};g.extend=function(a){G(B.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};g.pick=
function(a){var b={},c=w.apply(n,B.call(arguments,1));G(c,function(c){c in a&&(b[c]=a[c])});return b};g.omit=function(a){var b={},c=w.apply(n,B.call(arguments,1)),d;for(d in a)g.contains(c,d)||(b[d]=a[d]);return b};g.defaults=function(a){G(B.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])});return a};g.clone=function(a){return g.isObject(a)?g.isArray(a)?a.slice():g.extend({},a):a};g.tap=function(a,b){b(a);return a};var U=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;
if(null==a||null==b)return a===b;a instanceof g&&(a=a._wrapped);b instanceof g&&(b=b._wrapped);var e=p.call(a);if(e!=p.call(b))return!1;switch(e){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==
a)return d[f]==b;c.push(a);d.push(b);f=0;var h=!0;if("[object Array]"==e){if(f=a.length,h=f==b.length)for(;f--&&(h=U(a[f],b[f],c,d)););}else{e=a.constructor;var k=b.constructor;if(e!==k&&!(g.isFunction(e)&&e instanceof e&&g.isFunction(k)&&k instanceof k))return!1;for(var l in a)if(g.has(a,l)&&(f++,!(h=g.has(b,l)&&U(a[l],b[l],c,d))))break;if(h){for(l in b)if(g.has(b,l)&&!f--)break;h=!f}}c.pop();d.pop();return h};g.isEqual=function(a,b){return U(a,b,[],[])};g.isEmpty=function(a){if(null==a)return!0;
if(g.isArray(a)||g.isString(a))return 0===a.length;for(var b in a)if(g.has(a,b))return!1;return!0};g.isElement=function(a){return!(!a||1!==a.nodeType)};g.isArray=v||function(a){return"[object Array]"==p.call(a)};g.isObject=function(a){return a===Object(a)};G("Arguments Function String Number Date RegExp".split(" "),function(a){g["is"+a]=function(b){return p.call(b)=="[object "+a+"]"}});g.isArguments(arguments)||(g.isArguments=function(a){return!(!a||!g.has(a,"callee"))});"function"!==typeof/./&&(g.isFunction=
function(a){return"function"===typeof a});g.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};g.isNaN=function(a){return g.isNumber(a)&&a!=+a};g.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==p.call(a)};g.isNull=function(a){return null===a};g.isUndefined=function(a){return void 0===a};g.has=function(a,b){return q.call(a,b)};g.noConflict=function(){a._=e;return this};g.identity=function(a){return a};g.times=function(a,b,c){for(var d=Array(a),e=0;e<a;e++)d[e]=b.call(c,
e);return d};g.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=g.invert(P.escape);var Z={escape:new RegExp("["+g.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+g.keys(P.unescape).join("|")+")","g")};g.each(["escape","unescape"],function(a){g[a]=function(b){return null==b?"":(""+b).replace(Z[a],function(b){return P[a][b]})}});g.result=function(a,b){if(null==
a)return null;b=a[b];return g.isFunction(b)?b.call(a):b};g.mixin=function(a){G(g.functions(a),function(b){var c=g[b]=a[b];g.prototype[b]=function(){var a=[this._wrapped];u.apply(a,arguments);return F.call(this,c.apply(g,a))}})};var aa=0;g.uniqueId=function(a){var b=++aa+"";return a?a+b:b};g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,ba={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;
g.template=function(a,b,c){c=g.defaults({},c,g.templateSettings);var d=new RegExp([(c.escape||V).source,(c.interpolate||V).source,(c.evaluate||V).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){f+=a.slice(e,h).replace(R,function(a){return"\\"+ba[a]});c&&(f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");d&&(f+="'+\n((__t=("+d+"))==null?'':__t)+\n'");g&&(f+="';\n"+g+"\n__p+='");e=h+b.length;return b});f+="';\n";c.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+
f+"return __p;\n";try{var h=new Function(c.variable||"obj","_",f)}catch(I){throw I.source=f,I;}if(b)return h(b,g);b=function(a){return h.call(this,a,g)};b.source="function("+(c.variable||"obj")+"){\n"+f+"}";return b};g.chain=function(a){return g(a).chain()};var F=function(a){return this._chain?g(a).chain():a};g.mixin(g);G("pop push reverse shift sort splice unshift".split(" "),function(a){var b=n[a];g.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);"shift"!=a&&"splice"!=a||0!==c.length||
delete c[0];return F.call(this,c)}});G(["concat","join","slice"],function(a){var b=n[a];g.prototype[a]=function(){return F.call(this,b.apply(this._wrapped,arguments))}});g.extend(g.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this)},{}],25:[function(a,c,k){"undefined"!==typeof window&&"function"!==typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(a){setTimeout(a,1E3/60)});Leap=a("../lib/index")},{"../lib/index":11}]},{},[25]);
}).call(this);//# sourceMappingURL=CindyLeap.js.map

